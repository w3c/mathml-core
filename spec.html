<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>MathML Core</title>
    <link class="removeOnSave" href="https://test.csswg.org/harness/stylesheets/annotate.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
    <script src="https://www.w3.org/Tools/respec/respec-w3c" class="remove">
    </script>
    <script src="tables/sorttable.js"></script>
    <script class="remove" src="wpt/data-tests.js"></script>
    <script class="remove" src="wpt/fetch-browser-results.js"></script>
    <script class="remove" src="spec-implementation-report.js"></script>
    <script class="remove">
      var respecConfig = {
          specStatus: "CR",
	  crEnd: "2022-12-31",
	  //          previousPublishDate: "2021-08-16",
	  previousPublishDate: "2022-05-04",
          previousMaturity: "WD",
          editors: [{
              name: "David Carlisle",
              url: "https://github.com/davidcarlisle",
              company: "NAG",
              w3cid: 4238
          }, {
              name: "FrÃ©dÃ©ric Wang",
              url: "https://frederic-wang.fr",
              company: "Igalia",
              w3cid: 112458
          }],
          formerEditors: [{
              name: "Patrick Ion",
              url: "http://www-personal.umich.edu/~pion/",
              company: "Mathematical Reviews, American Mathematical Society"
          }, {
              name: "Robert Miner (deceased)",
              company: "Design Science, Inc."
          }],
          group: "math",
          edDraftURI: "https://w3c.github.io/mathml-core/",
          shortName: "mathml-core",
	  github: "w3c/mathml-core",
          mdn: false,
          testSuiteURI: "https://github.com/web-platform-tests/wpt/tree/master/mathml/",
          implementationReportURI: "https://wpt.fyi/results/?label=master&label=experimental&aligned&q=math%20%20not%28path%3A%2Fjs%29",
        xref: ['html', 'infra', 'css-display-3', 'css-text-3', 'web-animations', 'css-fonts-4', 'dom', 'cssom-view', 'css-sizing-3', 'css-align-3', 'css-box-4', 'css-values-4', 'css-backgrounds-3', 'css-text-decor-4', 'svg', 'css-writing-modes-4', 'css-color-4', 'css-box-4'],
          localBiblio: {
              "MATHML4": {
                  title: "Mathematical Markup Language (MathML) Version 4.0",
                  authors: [
                      "David Carlisle et al."
                  ],
                  status: "ED",
                  href: "https://w3c.github.io/mathml/"
              },
              "HOUDINI": {
                  title: "CSS-TAG Houdini Editor Drafts",
                  href: "https://drafts.css-houdini.org/"
              },
              "TEXBOOK": {
                  title: "The TeXBook",
                  date: "1984",
                  authors: [
                      "Knuth, Donald E."
                  ],
                  publisher: "Addison-Wesley Professional",
                  id: "ISBN9780201134483"
              },
              "OPEN-TYPE-MATH-ILLUMINATED": {
                  title: "OpenType Math Illuminated",
                  date: "2009",
                  authors: [
                      "Ulrik Vieth"
                  ],
                  href: "https://www.tug.org/TUGboat/tb30-1/tb94vieth.pdf",
              },
              "OPEN-TYPE-MATH-IN-HARFBUZZ": {
                  title: "OpenType MATH in HarfBuzz",
                  authors: [
                      "FrÃ©dÃ©ric Wang"
                  ],
                  href: "https://frederic-wang.fr/opentype-math-in-harfbuzz.html"
              }
          },
          preProcess: [initReport],
          postProcess: [sorttable.init, loadWebPlaformTestsResults]
      };
    </script>
  </head>
  <body>
    <div id="implementation-report"></div>
    <section id="abstract">
      <p>
        This specification defines a core subset of Mathematical Markup
        Language, or MathML, that is suitable for browser implementation.
        MathML is a markup language for describing mathematical notation
        and capturing both its structure and content. The goal of MathML is to
        enable mathematics to be served, received, and processed on the World
        Wide Web, just as HTML has enabled this functionality for text.
      </p>
    </section>
    <section id="sotd">
    </section>
    
    <section class="informative">
      <h2>Introduction</h2>
      <p>
        The [[MATHML3]] specification has several shortcomings that make it
        hard to implement consistently across web rendering engines or to
        extend with user-defined constructions, e.g.:
      </p>
      <ul>
        <li>It is a huge and standalone specification.</li>
        <li>It does not contain any detailed rendering rules.</li>
        <li>It is not driven by browser-implementation.</li>
        <li>It lacks automated testing.</li>
      </ul>
      <p>
        This MathML Core specification intends to address these issues by
        being as accurate as possible on the visual rendering of mathematical
        formulas using additional rules from the TeXBookâ€™s Appendix G
        [[?TEXBOOK]] and from the Open Font Format [[OPEN-FONT-FORMAT]],
        [[OPEN-TYPE-MATH-ILLUMINATED]]. It also relies on modern browser
        implementations and web technologies [[HTML]] [[SVG]] [[CSS2]] [[DOM]],
        clarifying interactions
        with them when needed or introducing new low-level primitives to
        improve the web platform layering.
      </p>
      <p>
        Parts of MathML3 that do not fit well in this framework or are less
        fundamental have been omitted. Instead, they are described in a
        separate and larger [[MATHML4]] specification. The details of which
        math feature will be included in future versions of MathML Core or
        implemented as polyfills is still open. This question and other
        potential improvements are <a href="https://github.com/w3c/mathml/issues?q=is%3Aissue+is%3Aopen+label%3A%22MathML+Core%22">tracked on GitHub</a>.
      </p>
      <p>
        By increasing the level of implementation details, focusing on a
        workable subset, following a browser-driven design and relying on
        automated web platform tests, this specification is expected to
        greatly improve MathML interoperability. Moreover, effort on MathML
        layering will enable users to implement the rest of the MathML 4
        specification, or more generally to extend MathML Core, using
        modern web technologies such as
        <a>shadow trees</a>,
        <a>custom elements</a> or
        APIs from [[HOUDINI]].
      </p>
    </section>
    <section class="normative">
      <h2>MathML Fundamentals</h2>
      <section id="mathml-elements-and-attributes">
        <h3>Elements and attributes</h3>
        <p id="mathml-elements">
          The term <dfn>MathML element</dfn> refers to any element in the
          <a>MathML namespace</a>.
          The MathML elements defined in this specification are called the
          <dfn>MathML Core elements</dfn> and are listed below.
          Any MathML element that is not listed below is called an
          <dfn>Unknown MathML element</dfn>.
        </p>
        <ol>
          <li>[^annotation^]</li>
          <li>[^annotation-xml^]</li>
          <li>[^maction^]</li>
          <li>[^math^]</li>
          <li>[^merror^]</li>
          <li>[^mfrac^]</li>
          <li>[^mi^]</li>
          <li>[^mmultiscripts^]</li>
          <li>[^mn^]</li>
          <li>[^mo^]</li>
          <li>[^mover^]</li>
          <li>[^mpadded^]</li>
          <li>[^mphantom^]</li>
          <li>[^mprescripts^]</li>
          <li>[^mroot^]</li>
          <li>[^mrow^]</li>
          <li>[^ms^]</li>
          <li>[^mspace^]</li>
          <li>[^msqrt^]</li>
          <li>[^mstyle^]</li>
          <li>[^msub^]</li>
          <li>[^msubsup^]</li>
          <li>[^msup^]</li>
          <li>[^mtable^]</li>
          <li>[^mtd^]</li>
          <li>[^mtext^]</li>
          <li>[^mtr^]</li>
          <li>[^munder^]</li>
          <li>[^munderover^]</li>
          <li>[^semantics^]</li>
        </ol>
        <p>The <dfn>grouping elements</dfn> are
          [^maction^],
          [^math^],
          [^merror^],
          [^mphantom^],
          [^mprescripts^],
          [^mrow^],
          [^mstyle^],
          [^semantics^] and <a>unknown MathML elements</a>.</p>
        <p>The <dfn>scripted elements</dfn> are
          [^mmultiscripts^],
          [^mover^],
          [^msub^],
          [^msubsup^],
          [^msup^],
          [^munder^] and
          [^munderover^].
        </p>
        <p>The <dfn>radical elements</dfn> are
          [^mroot^] and [^msqrt^].
        </p>
        <p>
          The attributes defined in this specification have no namespace
          and are called <dfn>MathML attributes</dfn>:
        </p>
        <ul>
          <li><a href="#global-attributes">Global attributes</a></li>
          <li><a href="#legacy-maction-attributes">Legacy <code>maction</code> attributes</a></li>
          <li><a href="#mo-attributes"><code>mo</code> attributes</a></li>
          <li><a href="#mpadded-attributes"><code>mpadded</code> attributes</a></li>
          <li><a href="#mspace-attributes"><code>mspace</code> attributes</a></li>
          <li><a href="#munderover-attributes"><code>munderover</code> attributes</a></li>
          <li><a href="#mtd-attributes"><code>mtd</code> attributes</a></li>
          <li>[^annotation/encoding^]</li>
          <li>[^math/display^]</li>
          <li>[^mfrac/linethickness^]</li>
        </ul>
        <section id="the-top-level-math-element">
          <h4>The Top-Level <code>&lt;math&gt;</code> Element</h4>
          <p>MathML specifies a single top-level or root
            <dfn class="element">math</dfn> element, which encapsulates each
            instance of MathML markup within a document. All other MathML content
            must be contained in a <code>&lt;math&gt;</code> element.
          </p>
          <p>
            The <code>&lt;math&gt;</code>
            element accepts the attributes described
            in <a href="#global-attributes"></a> as well as the
            following attributes:
          </p>
          <ul>
            <li>[^math/display^]</li>
            <li>[^math/alttext^]</li>
          </ul>
          <p>
            The
            <dfn class="element-attr" data-dfn-for="math">display</dfn>
            attribute, if present,
            must be an
            <a>ASCII case-insensitive</a>
            match
            to <code>block</code> or <code>inline</code>.
            The user agent stylesheet
            described in <a href="#user-agent-stylesheet"></a>
            contains rules for this attribute that affect the
            default values for the [^math/display^]
            (<code>block math</code> or <code>inline math</code>)
            and <a><code>math-style</code></a>
            (<code>normal</code> or <code>compact</code>) properties.
            If the <code>display</code>
            attribute is absent or has an invalid value, the User Agent
            stylesheet treats it the same as <code>inline</code>.
          </p> 
	  <p>
           This specification does not define any observable behavior that is
           specific to the <dfn class="element-attr" data-dfn-for="math">alttext</dfn> attribute.
          </p>
          <div class="note">
	  The [^math/alttext^] attribute may be used as
	  alternative text by some legacy systems that do not
	  implement math layout.</div>
	   
          <p>
            If the <code>&lt;math&gt;</code> element does not have its computed
            [^math/display^] property equal to
            <code>block math</code> or <code>inline math</code>
            then it is laid out according to the CSS specification where
            the corresponding value is described.
            Otherwise the layout algorithm of the
            [^mrow^] element is used to produce a
            <a>math content box</a>. That <a>math content box</a> is used as the content for the layout of
            the element, as described by CSS for <code>display: block</code>
            (if the computed value is <code>block math</code>) or
            <code>display: inline</code>
            (if the computed value is <code>inline math</code>).
            Additionally, if the computed
            [^math/display^] property is equal to
            <code>block math</code> then that <a>math content box</a> is rendered
            horizontally centered within the content box.
          </p>
          <div class="note">
            T<sub>E</sub>X's display mode <code>$$...$$</code>
            and inline mode <code>$...$</code> correspond to
            <code>display="block"</code> and <code>display="inline"</code>
            respectively.
          </div>
          <div class="example" id="math-example">
            <p>In the following example, a [^math^] formula
              is rendered in display mode on a new line and taking full width,
              with the math content centered within the container:</p>
            <pre data-include="examples/example-math-display-block.html"
                 data-include-format="text"></pre>
            <img src="examples/example-math-display-block.png" alt="math example (display)">
            <p>As a comparison, the same formula would look as follows in
              inline mode. The formula is embedded in the paragraph of text
              without forced line breaking.
              The baselines specified by the layout algorithm of the
              [^mrow^] are used for vertical
              alignment. Note that
              the middle of sum and equal symbols or fractions are all aligned,
              but not with the alphabetical baseline of the surrounding
              text.</p>
            <img src="examples/example-math-display-inline.png" alt="math example (inline)">
          </div>
          <p>Because good mathematical rendering requires use of mathematical
            fonts, the
            <a>user agent stylesheet</a>
            should set the
            <a data-xref-type="css-property">font-family</a>
            to the
            <a data-xref-for="font-family" data-xref-type="css-value">math</a>
            value on the <code>&lt;math&gt;</code> element instead of inheriting
            it. Additionally, several CSS properties that can be set on
            a parent container such as
            <code>font-style</code>, <code>font-weight</code>,
            <code>direction</code> or <code>text-indent</code> etc
            are not expected to apply to the math formula and so the
            <a>user agent stylesheet</a>
            has rules to reset them by default.
          </p>
          <pre class="css" data-include="user-agent-stylesheet/math.css"></pre>
        </section>
        <section id="types-for-mathml-attribute-values">
          <h4>Types for MathML Attribute Values</h4>
          <p>In addition to CSS data types, some MathML attributes rely on the following MathML-specific types:</p>
          <dl>
            <dt><dfn>unsigned-integer</dfn></dt>
            <dd>An
              <a data-xref-type="css-type" href="https://www.w3.org/TR/css-values-4/#integer-value">&lt;integer&gt;</a> value as defined in
              [[CSS-VALUES-4]], whose first character is neither
              U+002D HYPHEN-MINUS character (-) nor
              U+002B PLUS SIGN (+).
            </dd>
            <dt><dfn>boolean</dfn></dt>
            <dd>A string that is an
              <a>ASCII case-insensitive</a>
              match to <code>true</code> or
              <code>false</code>.
            </dd>
          </dl>
        </section>
        <section>
          <h4>Global Attributes</h4>
          <p>
            The following attributes are common to and may be specified on all MathML
            elements:
          </p>
          <ul>
            <li><a><code>class</code></a></li>
            <li><a><code>data-*</code></a></li>
            <li><a><code>dir</code></a></li>
            <li><a><code>displaystyle</code></a></li>
            <li><a><code>id</code></a></li>
            <li><a><code>mathbackground</code></a></li>
            <li><a><code>mathcolor</code></a></li>
            <li><a><code>mathsize</code></a></li>
            <li><a><code>nonce</code></a></li>
            <li><a><code>scriptlevel</code></a></li>
            <li><a><code>style</code></a></li>
            <li><a><code>tabindex</code></a></li>
            <li><a href="#event-handler-content-attributes"><code>on*</code> event handler attributes</a></li>
            <li>additional attributes, as described in <a href="#other-valid-attributes"></a></li>
          </ul>
        </section>
        <section id="attributes-common-to-html-and-mathml-elements">
          <h4>Attributes common to HTML and MathML elements</h4>
          <p>
            The
            <dfn class="element-attr no-export">id</dfn>,
            <dfn class="element-attr no-export">class</dfn>,
            <dfn class="element-attr no-export">style</dfn>,
            <dfn class="no-export"><code>data-*</code></dfn>,
            <dfn class="element-attr no-export">nonce</dfn> and
            <dfn class="element-attr no-export">tabindex</dfn>
            attributes have the same syntax and semantics as defined for
            [^global/id^],
            [^global/class^],
	    [^html-global/style^],
            <a data-cite="HTML/../#embedding-custom-non-visible-data-with-the-data-*-attributes">data-*</a>,
            [^htmlsvg-global/nonce^] and
            [^htmlsvg-global/tabindex^]
            attributes on HTML elements.
          </p>
          <p>
            The
            <dfn class="element-attr">dir</dfn>
            attribute, if present,
            must be an
            <a>ASCII case-insensitive</a> match
            to <code>ltr</code> or <code>rtl</code>.
            In that case, the user agent is expected to treat the attribute as a
            <a data-cite="HTML/../#presentational-hints">presentational hint</a> setting the element's
            <a data-xref-type="css-property">direction</a>
            property to the corresponding value.
            More precisely, an
            <a>ASCII case-insensitive</a> match
            to <code>rtl</code> is mapped to <code>rtl</code> while
            an <a>ASCII case-insensitive</a> match to <code>ltr</code> is mapped to <code>ltr</code>.
          </p>
          <div class="note">
            The <a>dir</a>  attribute is used to set the directionality of math
            formulas, which is often <code>rtl</code> in Arabic speaking world.
            However, languages written from right to left often embed math
            written from left to right and so the
            <a>user agent stylesheet</a> resets
            the
            <a data-xref-type="css-property">direction</a>
            property accordingly on the [^math^]
            elements.
          </div>
          <div class="example" id="dir-example">
            <p>
              In the following example, the <a>dir</a> attribute
              is used to render "ðž¸Ž plus ðž¸‘ raised to the power of
              (Ù¢ over, ðž¸Ÿ plus Ù¡)" from right-to-left.
            </p>
            <pre data-include="examples/example-dir.html"
                 data-include-format="text"></pre>
            <img src="examples/example-dir.png" alt="dir example">
          </div>
          <p id="event-handler-content-attributes">
            All MathML elements support event handler content attributes,
            as described in  <a>event handler content attributes</a> in HTML.
          </p>
          <p>
            All event handler content attributes
            <a data-cite="HTML/../#event-handlers-on-elements,-document-objects,-and-window-objects">noted by HTML as being supported by all HTMLElements</a>
            are supported by all MathML elements as well, as defined in the <a href="#dom-and-javascript">MathMLElement IDL</a>.
          </p>
        </section>
        <section id="legacy-mathml-style-attributes">
          <h4>Legacy MathML Style Attributes</h4>
          <p>
            The
            <dfn class="element-attr">mathcolor</dfn>
            and
            <dfn class="element-attr">mathbackground</dfn>
            attributes, if present, must
            have a value that is a
            <a data-xref-type="css-type" href="https://www.w3.org/TR/css-color-4/#propdef-color">&lt;color&gt;</a>.
            In that case, the user agent is expected to treat these attributes as a
            <a data-cite="HTML/../#presentational-hints">presentational hint</a> setting the element's
            <a data-xref-type="css-property">color</a> and
            <a data-xref-type="css-property">background-color</a>
            properties to the corresponding values.
            The <code>mathcolor</code> attribute describes the foreground fill
            color of MathML text, bars etc
            while the <code>mathbackground</code>
            attribute describes the background color of an element.
          </p>
          <p>
            The
            <dfn class="element-attr">mathsize</dfn>
            attribute, if present, must
            have a value that is a valid <a data-xref-type="css-type" href="https://www.w3.org/TR/css-values-4/#typedef-length-percentage">&lt;length-percentage&gt;</a>.
            In that case, the user agent is expected to treat the attribute as a
            <a data-cite="HTML/../#presentational-hints">presentational hint</a> setting the element's
            <a data-xref-type="css-property">font-size</a>
            property to the corresponding value.
            The <code>mathsize</code> property indicates the desired height
            of glyphs in math formulas but also scales other parts (spacing, shifts,
            line thickness of bars etc) accordingly.
          </p>
          <div class="note">
	    The above attributes are implemented for compatibility with full MathML. Authors whose only target is MathML Core are encouraged to use CSS for styling.
          </div>
        </section>
        <section id="the-displaystyle-and-scriptlevel-attributes">
          <h4>The <code>displaystyle</code> and <code>scriptlevel</code> attributes</h4>
          <p>
            The
            <dfn class="element-attr">displaystyle</dfn>
            attribute, if present, must have a value that is a <a>boolean</a>.
            In that case, the user agent is expected to treat the attribute as a
            <a data-cite="HTML/../#presentational-hints">presentational hint</a> setting the element's
            <a><code>math-style</code></a>
            property to the corresponding value.
            More precisely, an
            <a>ASCII case-insensitive</a> match
            to <code>true</code> is mapped to <code>normal</code> while
            an <a>ASCII case-insensitive</a> match to <code>false</code> is mapped to <code>compact</code>.
            This attribute indicates whether formulas should try to minimize
            the logical height (value is <code>false</code>) or not
            (value is <code>true</code>) e.g. by changing the size of content or
            the layout of scripts.
          </p>
          <p>
            The
            <dfn class="element-attr">scriptlevel</dfn>
            attribute, if present, must have value
            <code>+&lt;U&gt;</code>, <code>-&lt;U&gt;</code> or <code>&lt;U&gt;</code>
            where <code>&lt;U&gt;</code> is an
            <a>unsigned-integer</a>.
            In that case
            the user agent is expected to treat the <code>scriptlevel</code>
            attribute as a
            <a data-cite="HTML/../#presentational-hints">presentational hint</a> setting the element's
            <a><code>math-depth</code></a>
            property to the corresponding value.
            More precisely,
            <code>+&lt;U&gt;</code>, <code>-&lt;U&gt;</code> and
            <code>&lt;U&gt;</code>
            are respectively mapped to
            <code>add(&lt;U&gt;)</code>
            <code>add(&lt;-U&gt;)</code>
            and <code>&lt;U&gt;</code>.
          </p>
          <p>
            <a><code>displaystyle</code></a> and <a><code>scriptlevel</code></a> values
            are automatically adjusted within MathML elements.
            To fully implement these attributes, additional CSS properties must be
            specified in the user agent stylesheet
            as described in <a href="#user-agent-stylesheet"></a>.
            In particular, for all MathML elements a default
            <code>font-size: math</code> is specified to ensure that
            <code>scriptlevel</code> changes are taken into account.
          </p>
          <div class="example" id="displaystyle-scriptlevel-example">
            <p>
              In this example, an [^munder^]
              element is used to attach a
              script "A" to a base "âˆ‘". By default, the summation
              symbol is rendered with the font-size inherited from its
              parent and the A as a scaled down subscript.
              If <a>displaystyle</a> is true, the summation symbol is drawn
              bigger and the "A" becomes an underscript.
              If <a>scriptlevel</a> is reset to 0 on the "A", then it will
              use the same font-size as the top-level <code>math</code> root.
            </p>
            <pre data-include="examples/example-displaystyle-scriptlevel.html"
                 data-include-format="text"></pre>
            <img src="examples/example-displaystyle-scriptlevel.png" alt="displaystyle-scriptlevel example">
          </div>
          <div class="note">
            T<sub>E</sub>X's <code>\displaystyle</code>, <code>\textstyle</code>,
            <code>\scriptstyle</code>, and <code>\scriptscriptstyle</code> correspond
            to <a><code>displaystyle</code></a> and <a><code>scriptlevel</code></a> as
            <code>true</code> and <code>0</code>,
            <code>false</code> and <code>0</code>,
            <code>false</code> and <code>1</code>,
            and <code>false</code> and 2, respectively.
          </div>
        </section>
        <section id="other-valid-attributes">
          <h4>Attributes Reserved as Valid</h4>
          <p>The attributes
          <dfn class="element-attr">intent</dfn> and <dfn class="element-attr">arg</dfn>
	  are reserved as valid attributes.</p>
          <p>
           This specification does not define any observable behavior that is
           specific to the <a><code>intent</code></a> and <a><code>arg</code></a> attributes.
          </p>
          <div class="note">
           These attributes are described in [[MATHML4]] and
	   future versions of this specification may or may not
           define them. Authors should be aware that they are currently
           in development and subject to change.
	  </div>
	</section>
      </section>
      <section>
        <h3>Integration in the Web Platform</h3>
        <section id="html-and-svg">
          <h4>HTML and SVG</h4>
          <p>
            When
            <a data-cite="HTML/../#parsing">parsing HTML documents</a>
            user agents must treat any tag name corresponding to a
            <a>MathML Core Element</a> as belonging to the
            <a>MathML namespace</a>.
          </p>
          <p>
            Users agents must allow mixing HTML, SVG and MathML elements
            as allowed by sections
            <a data-cite="HTML/../#html-integration-point">HTML integration point</a>,
            <a data-cite="HTML/../#mathml-text-integration-point">MathML integration point</a>,
            <a data-cite="HTML/../#tree-construction-dispatcher">tree construction
              dispatcher</a>,
            <a data-cite="HTML/../#mathml">MathML</a> and
            <a data-cite="HTML/../#svg-0">SVG</a>
            from [[HTML]].
          </p>
          <p>
            When evaluating the SVG [^svg/requiredExtensions^]
            attribute, user agents must claim support for the language extension
            identified by the
            <a>MathML namespace</a>.
          </p>
          <div class="example" id="html-svg-example">
            <p>
              In this example, inline MathML and SVG elements are used inside
              an HTML document. SVG elements <code>&lt;switch&gt;</code> and
              <code>&lt;foreignObject&gt;</code> (with
              proper <code>&lt;requiredExtensions&gt;</code>) are used to
              embed a MathML formula with a text fallback, inside a diagram.
              HTML <code>input</code> element is used within the
              [^mtext^]
              to include an interactive input field inside a mathematical
              formula.
            </p>
            <pre data-include="examples/example-html-svg.html"
                 data-include-format="text"></pre>
            <img src="examples/example-html-svg.png" alt="html-svg example">
          </div>
          <div class="note">
            <ul>
              <li>
                The <code>&lt;math&gt;</code> element can be used at
                position permitted for
                <a>flow content</a>
                (e.g. a
                <a data-cite="SVG/embedded.html#ForeignObjectElement"><code>&lt;foreignObject&gt;</code></a> element)
                or <a>phrasing content</a>.
              </li>
              <li>
                Any
                <a>phrasing content</a>
                can be used inside
                [^mi^],
                [^mo^],
                [^mn^],
                [^ms^] and
                [^mtext^]
                elements.
              </li>
              <li>
                The <code>&lt;svg&gt;</code> element can be used inside
                [^annotation-xml^] elements.
              </li>
              <li>
                Any <a>flow content</a>
                can be used inside
                [^annotation-xml^] elements with
                encoding
                <code>application/xhtml+xml</code> or <code>text/html</code>.
              </li>
            </ul>
          </div>
        </section>
        <section id="css-styling">
          <h4>CSS styling</h4>
          <p>User agents must support various CSS features mentioned in this
            specification, including new ones described in
            <a href="#css-extensions-for-math-layout"></a>.
            They must follow the computation rule for
            <a data-cite="CSS-DISPLAY-3#unbox-mathml">display: contents</a>.
          </p>
          <div class="example" id="style-example">
            <p>
              In this example, the MathML formula inherits the CSS color of its
              parent and uses the <code>font-family</code> specified via the
              <a>style</a> attribute.
            </p>
            <pre data-include="examples/example-style.html"
                 data-include-format="text"></pre>
            <img src="examples/example-style.png" alt="style example">
          </div>
          <p>
            All documents containing <a>MathML Core elements</a> must include
            CSS rules described in <a href="#user-agent-stylesheet"></a>
            as part of user-agent level style sheet defaults.
            In particular, this adds <code>!important</code> rules to force
            <a>writing mode</a>
            to <code>horizontal-lr</code> on all MathML elements.
          </p>
          <p>
            The <a data-cite="CSS22" data-xref-type="css-property">float</a>
            property does
            not create floating of elements whose parent's computed
            <code>display</code> value is
            <code>block math</code> or <code>inline math</code>,
            and does not take them out-of-flow.
          </p>
          <p>
            The following CSS features are not supported and must be ignored:
          </p>
          <ul>
            <li>
              Line breaking inside math formulas:
              <code>white-space</code>
              is treated as <code>nowrap</code> on all MathML elements.
            </li>
            <li>
              Alignment properties:
              <code>align-content</code>, <code>justify-content</code>,
              <code>align-self</code>, <code>justify-self</code> have
              no effects on MathML elements.
            </li>
          </ul>
          <div class="note">
            These features might be handled in future versions of this document.
            For now, authors are discouraged from setting a different value for
            these properties as that might lead to backward incompatibility
            issues.
          </div>
        </section>
        <section id="dom-and-javascript">
          <h4>DOM and JavaScript</h4>
          <p>
            User agents supporting
            <a data-cite="HTML/../#webappapis">Web application APIs</a>
            must ensure that they keep the visual rendering of MathML
            synchronized with the [[DOM]] tree, in particular perform necessary
            updates when <a>MathML attributes</a> are modified dynamically.
          </p>
          <p>
            All the nodes representing <a>MathML elements</a> in the DOM
            must implement, and expose to scripts, the following
            <dfn class="interface">MathMLElement</dfn> interface.
          </p>
          <pre class="idl" data-include="webidl/MathMLElement.idl"></pre>
          <p>The {{GlobalEventHandlers}} and
            <dfn class="interface" data-cite="HTML/../#htmlorsvgelement"><code>HTMLOrForeignElement</code></dfn>
            interfaces are defined in [[HTML]].</p>
          <p>Each IDL attribute of the
            <a><code>MathMLElement</code></a> interface
            reflects the
            corresponding MathML
            <a href="#global-attributes">content attribute</a>.
          </p>
          <div class="example" id="dom-idl-example">
            <p>
              In the following example, a MathML formula is used to render
              the fraction "Î± over 2". When clicking the red Î±, it is changed
              into a blue Î².
            </p>
            <pre data-include="examples/example-dom-idl.html"
                 data-include-format="text"></pre>
            <img src="examples/example-dom-idl.png" alt="dom-idl example">
          </div>
          <div class="issue">
            <a href="https://github.com/whatwg/html/pull/5248">Rename
              HTMLOrSVGElement</a> and define MathMLElement in [[HTML]].
          </div>
        </section>
        <section id="text-layout">
          <h4>Text layout</h4>
          <p>
            Because math fonts generally contain very tall glyphs such as big
            integrals, using typographic metrics is important to avoid
            excessive line spacing of text. As a consequence,
            user agents must take into account the USE_TYPO_METRICS flag from
            the OS/2 table [[OPEN-FONT-FORMAT]] when performing text layout.
          </p>
        </section>
        <section id="focus">
          <h4>Focus</h4>
          <p>
            MathML provides the ability for authors to allow for
            interactivity in supporting interactive user agents
            using the same concepts, approach and guidance to
            <a data-cite="HTML/../#focus"><code>Focus</code></a>
            as described in HTML, with modifications or
            clarifications regarding application
            for MathML as described in this section.
          </p>
          <p>
            When an element is focused, all applicable CSS
            focus-related pseudo-classes as defined in
            <a data-cite="SELECT#title">Selectors Level 3</a>
            apply, as defined in that specification.
          </p>
          <p>
            The contents of embedded [^math^] elements
            (including HTML elements inside token elements)
            contribute to the sequential focus order of the containing owner HTML
            document (combined sequential focus order).
          </p>
        </section>
      </section>
    </section>
    <section class="normative">
      <h2>Presentation Markup</h2>
      <section>
        <h3>Visual formatting model</h3>
        <section>
          <h4>Box Model</h4>
          <p>
            The default [^math/display^] property
            is described in <a href="#user-agent-stylesheet"></a>:
          </p>
          <ul>
            <li>
              For the <code>&lt;math&gt;</code> root,
              it is equal to <code>inline math</code> or <code>block math</code>
              according to the value of the [^math/display^] attribute.
            </li>
            <li>
              For <a href="#tabular-math">Tabular MathML elements</a>
              [^mtable^],
              [^mtr^],
              [^mtd^] it is respectively equal to
              <code>inline-table</code>,
              <code>table-row</code> and
              <code>table-cell</code>.
            </li>
            <li>For all but the first children of the [^maction^]
              and [^semantics^] elements, it is equal to
              <code>none</code>.
            </li>
            <li>
              For all the other <a>MathML elements</a> it is equal
              to <code>block math</code>.
            </li>
          </ul>
          <p>
            In order to specify math layout in different
            <a>writing modes</a>,
            this specification uses concepts from [[CSS-WRITING-MODES-4]]:
          </p>
          <ul>
            <li>
              <a>abstract dimensions</a>:
              <a>block dimension</a>,
              <a>inline dimension</a>,
              <a>block axis</a>,
              <a>inline axis</a>,
              <a>block size</a>,
              <a>inline size</a>.
            </li>
            <li>
              <a>flow-relative directions</a>:
              <a>inline-start</a>,
              <a>inline-end</a>,
              <a>block-start</a>.
            </li>
            <li>
              <a>line-relative directions</a>:
              <a>line-left</a>,
              <a>line-over</a>,
              <a>line-under</a>.
            </li>
          </ul>
          <div class="note">
            Unless specified otherwise,
            the figures in this specification use a
            <a>writing mode</a>
            of <code>horizontal-lr</code> and <code>ltr</code>.
            See <a href="#box-model-horizontal-tb-rtl"></a>,
            <a href="#box-model-vertical-lr"></a> and
            <a href="#box-model-vertical-rl"></a> for examples of other
            writing modes that are sometimes used for math layout.
          </div>
          <p>
            Boxes used for MathML elements rely on several parameters in order to perform layout
            in a way that is compatible with CSS but also to take into account
            very accurate positions and spacing within math formulas:
          </p>
          <ol>
            <li>Inline metrics.
              <a>min-content inline size</a>,
              <a>max-content inline size</a> and
              <a>inline size</a>
              from CSS. See <a href="#box-model-generic"></a>.
              <figure id="box-model-generic">
                <img src="figures/horizontal-tb-ltr.svg">
                <figcaption>Generic Box Model for MathML elements</figcaption>
              </figure>
            </li>
            <li>
              <p>
                Block metrics.
                The <a>block size</a>,
                <a>first baseline set</a>
                and
                <a>last baseline set</a>.
                The following <a>baselines</a> are defined for MathML boxes:
              </p>
              <ol>
                <li>
                  The <dfn>alphabetic baseline</dfn>
                  which typically aligns with the bottom of uppercase Latin
                  glyphs. The algebraic distance from the
                  <a>alphabetic baseline</a> to the <a>line-over</a> edge of the box is called the
                  <dfn>line-ascent</dfn>. The algebraic distance from the
                  <a>line-under</a> edge to the <a>alphabetic baseline</a> of the box
                  is called the <dfn>line-descent</dfn>.
                </li>
                <li>
                  The <dfn>mathematical baseline</dfn>, also called
                  <dfn>math axis</dfn>, which typically aligns with the fraction
                  bar, middle of fences and binary operators. It is shifted away from the <a>alphabetic baseline</a> by <a>AxisHeight</a> towards the <a>line-over</a>.
                </li>
                <li>
                  The <dfn>ink-over baseline</dfn>, indicating the <a>line-over</a>
                  theorical limit of the math content drawn, excluding any
                  extra space.
                  If not specified, it is aligned with the <a>line-over</a> edge.
                  The algebraic distance from the <a>alphabetic baseline</a> to
                  the <a>ink-over baseline</a> is called the
                  <dfn>ink line-ascent</dfn>.
                </li>
                <li>
                  The <dfn>ink-under baseline</dfn>, indicating the <a>line-under</a>
                  theorical limit of the math content drawn, excluding any
                  extra space.
                  If not specified, it is aligned with the <a>line-under</a> edge.
                  The algebraic distance from the <a>ink-under baseline</a>
                  to the <a>alphabetic baseline</a> is called the
                  <dfn>ink line-descent</dfn>.
                </li>
              </ol>
              <div class="note">
                For math layout, it is very important to rely on the ink extent
                when positioning text. This is not the case for more complex
                notations (e.g. square root).
                Although ink-ascent and ink-descent are defined for
                all MathML elements they are really only used for the token
                elements. In other cases, they just match normal ascent and
                descent.
              </div>
              Unless specified otherwise, the <a>last baseline set</a> is equal to the
              <a>first baseline set</a> for MathML boxes.
            </li>
            <li>
              An optional <dfn>italic correction</dfn>
              which provides a measure of how much the text of a box is
              slanted along the <a>inline axis</a>.
              See <a href="#figure-italic-correction"></a>.
              <figure id="figure-italic-correction">
                <img src="figures/italcorr.svg">
                <figcaption>Examples of italic correction for italic f and large integral</figcaption>
              </figure>
              If it is requested during calculation of
              <a>min-content inline size</a> and
              <a>max-content inline size</a> or during layout
              then 0 is used as a fallback value.
            </li>
            <li>
              An optional <dfn>top accent attachment</dfn>
              which provides a reference offset on the
              <a>inline axis</a> of a box that should be used when
              positioning that box as an accent.
              See <a href="#figure-top-accent-attachment"></a>.
              <figure id="figure-top-accent-attachment">
                <img src="figures/topaccent.svg">
                <figcaption>Example of top accent attachment for a circumflex accent</figcaption>
              </figure>
              If it is requested during calculation of
              <a>min-content inline size</a>
              (respectively <a>max-content inline size</a>) then half the
              <a>min-content inline size</a> (respectively <a>max-content inline size</a>) is used as a
              fallback value.
              If it is requested during layout then half the
              inline size of the box is used as a fallback value.
            </li>
          </ol>
          <p>Given a MathML box, the following offsets are defined:</p>
          <ul>
            <li>The <dfn>inline offset</dfn> of a child box
            is the offset between the
            <a>inline-start</a> edge of
            the parent box and the
            <a>inline-start</a> edge
            of the child box.</li>
            <li>The <dfn>block offset</dfn> of a child box
            is the offset between the <a>block-start</a> edge of
            the parent box and the
            <a>block-start</a> edge
            of the child box.</li>
            <li>The <dfn>line-left offset</dfn> of a child box
            is the offset between the <a>line-left</a> edge of
            the parent box and the
            <a>line-left</a> edge
            of the child box.</li>
	  </ul>

          <figure id="box-model-horizontal-tb-rtl">
            <img src="figures/horizontal-tb-rtl.svg">
            <figcaption>Box model for writing mode <code>horizontal-tb</code> and <code>rtl</code> that may be used in e.g. Arabic math.</figcaption>
          </figure>
          <figure id="box-model-vertical-lr">
            <img src="figures/vertical-lr.svg">
            <figcaption>Box model for writing mode <code>vertical-lr</code> and <code>ltr</code> that may be used in e.g. Mongolian math.</figcaption>
          </figure>
          <figure id="box-model-vertical-rl">
            <img src="figures/vertical-rl.svg">
            <figcaption>Box model for writing mode <code>vertical-rl</code> and <code>ltr</code> that may be used in e.g. Japanese math.</figcaption>
          </figure>
          <div class="note">
            The position of child boxes and graphical items inside a MathML
            box are expressed using the <a>inline offset</a>
            and <a>block offset</a>.
            For convenience, the layout algorithms may describe offsets using
            flow-relative directions, line-relative directions or
            the <a>alphabetic baseline</a>.
            It is always possible to pass from one description to the other
            because position of child boxes is always performed after the
            metrics of the box and of its child boxes are calculated.
          </div>
          <div class="example">
            <p>Here are examples of offsets obtained from line-relative
              metrics:</p>
            <ul>
              <li>
                The <a>inline offset</a> of a child box is
                the <a>line-left offset</a> if the CSS property
                <a data-xref-type="css-property">direction</a>
                is <code>ltr</code> and
                is the <a>inline size</a> of the box âˆ’
                (<a>line-left offset</a> + <a>inline size</a> of
                the child box) otherwise.
              </li>
              <li>
                The <a>block offset</a> of the <a>alphabetic baseline</a> of a box
                is the <a>line-ascent</a>
                if the CSS property
                <a data-xref-type="css-property">writing-mode</a>
                is <code>horizontal-lr</code>,
                <code>vertical-rl</code> or <code>sideways-rl</code>
                and is the <a>line-descent</a> otherwise.
              </li>
            </ul>
          </div>
	  <div class="issue" data-number="78">Improve definition of ink ascent/descent?</div>
	  
</section>
        <section id="layout-algorithms">
          <h4>Layout Algorithms</h4>
          <p>
            Each MathML element has an associated <dfn>math content box</dfn>, which is
            calculated as described in this chapter's layout algorithms using the following
            structure:
          </p>
          <ol>
            <li>
              Calculation of <a>min-content inline size</a>
              and <a>max-content inline size</a>
              of the math content.
            </li>
            <li>
              Box layout:
              <ol>
                <li>
                  Layout of <a>in-flow</a> child boxes.
                </li>
                <li>
                  Calculation of <a>inline size</a>,
                  <a>ink line-ascent</a>,
                  <a>ink line-descent</a>,
                  <a>line-ascent</a> and
                  <a>line-ascent</a> of the math content.
                </li>
                <li>
                  Calculation of offsets of child boxes within the <a>math content box</a>
                  as
                  well as sizes and offsets of extra graphical items
                  (bars, radical symbol, etc).
                </li>
                <li>
                  Layout and positioning of <a data-cite="css-position-3/#absolute-position">absolutely-positioned</a> and <a data-cite="css-position-3/#fixed-position">fixed-positioned</a> boxes, as described in [[CSS-POSITION-3]].
                </li>
              </ol>
            </li>
          </ol>
          <p>
            The following extra steps must be performed:
          </p>
          <ul>
            <li>
              After calculating the <a>line-ascent</a> and <a>line-descent</a>
              of a <a>math content box</a>, its <a>block size</a> is set to their sum.
            </li>
            <li>
              By default,
              the box metrics, offsets, <a>baselines</a>, <a>italic correction</a> and
              <a>top accent attachment</a> of the
              <a>content box</a>
              are set to the one calculated for the <a>math content box</a>.
              However if a different size is specified for the
              <a>content box</a> (via
              <a data-xref-type="css-property">width</a>,
              <a data-xref-type="css-property">height</a> or related
              properties), that size is used instead and the
              the inline-start and block-start edges of the
              <a>math content box</a> are aligned with the ones of the
              <a>content box</a>, unless otherwise specified in
              a specific layout algorithm.
            </li>
            <li>
              <p>
                The box metrics and offsets of the
                <a>padding box</a>
                are obtained from the
                <a>content box</a>
                by taking into account the corresponding
                <a>padding</a>
                properties as described in CSS.
              </p>
              <p>
                The <a>baselines</a>
                of the <a>padding box</a> are the same as the one of the <a>content box</a>.
              </p>
              <p>
                If the <a>content box</a> has a <a>top accent attachment</a>
                then the <a>padding box</a> has the same property, increased
                by the inline-start padding. If the <a>content box</a> has an
                <a>italic correction</a> then the <a>padding box</a> has the
                same property, increased by the <a>inline-end</a> padding.
              </p>
            </li>
            <li>
              <p>
                The box metrics and offsets of the
                <a>border box</a>
                are obtained from the
                <a>padding box</a>
                by taking into account the corresponding
                <a data-xref-type="css-property">border-width</a>
                property as described in CSS.
              </p>
              <p>
                In general, the <a>baselines</a> of the <a>border box</a> are the same as
                the one of the <a>padding box</a>. However, if the <a>line-over</a> border is
                positive then the <a>ink-over baseline</a> is set to the
                <a>line-over</a> edge of the <a>border box</a> and if
                the <a>line-under</a> border is
                positive then the <a>ink-under baseline</a> is set to the
                <a>line-under</a> edge of the <a>border box</a>.
              </p>
              <p>
                If the <a>padding box</a> has a <a>top accent attachment</a>
                then the <a>border box</a> has the same property, increased by
                the border-width of its inline-start egde. If the
                <a>padding box</a> has an <a>italic correction</a> then the
                <a>border box</a> has the same property, increased by the
                border-width of its <a>inline-end</a> egde.
              </p>
            </li>
            <li>
              <p>
                The box metrics and offsets of the
                <a>margin box</a>
                are obtained from the
                <a>border box</a>
                by taking into account the corresponding
                <a data-xref-type="css-property">margin</a>
                properties as described in CSS.
              </p>
              <p>
                The <a>baselines</a>
                of the <a>margin box</a> are the same as the one of the <a>border box</a>.
              </p>
              <p>
                If the <a>padding box</a> has a <a>top accent attachment</a>
                then the <a>margin box</a> has the same property, increased
                by the inline-start margin. If the <a>padding box</a> has an
                <a>italic correction</a> then the <a>margin box</a> has the
                same property, increased by the <a>inline-end</a> margin.
              </p>
            </li>
          </ul>
          <div class="note">
            Per the description above, <a data-cite="CSS2/box.html#collapsing-margins">margin-collapsing</a> does not apply to MathML elements.
          </div>
          <p>
            During box layout, optional
            <dfn>inline stretch size constraint</dfn> and
            <dfn>block stretch size constraint</dfn> parameters may be used on
            <a>embellished operators</a>. The former indicates
            a target size that a [=embellished operator/core operator=] stretched along
            the <a>inline axis</a> should cover.
            The latter indicates an <a>ink line-ascent</a> and <a>ink line-descent</a>
            that a [=embellished operator/core operator=] stretched along the <a>block axis</a>
            should cover.
            Unless specified otherwise, these parameters are ignored during
            box layout and child boxes are laid out without
            any stretch size constraint.
          </p>
          <div class="issue" data-number="76">Define what inline percentages resolve against</div>
          <div class="issue" data-number="77">Define what block percentages resolve against</div>
        </section>
        <section id="anonymous-mrow-boxes">
          <h4>Anonymous &lt;mrow&gt; boxes</h4>
          <p>An <dfn>anonymous box</dfn> is a box without any associated
            element in the DOM tree and which is generated for layout purpose
            only. The properties of anonymous boxes are inherited from the
            enclosing non-anonymous box while non-inherited properties have
            their initial value.
            An <dfn>anonymous &lt;mrow&gt; box</dfn> is
            an <a>anonymous box</a> with <code>display</code> equal to
            <code>block math</code> and which is laid out as
            described in section <a href="#layout-of-mrow"></a>.
          </p>
          <p>If a MathML element
            <dfn>generates an anonymous &lt;mrow&gt; box</dfn> if it wraps
            in children in an anonymous &lt;mrow&gt; box i.e.
            its subtree in the visual formatting model is made of an
            <a>anonymous &lt;mrow&gt; box</a>
            which itself contains the boxes associated to the children of this
            MathML element.
          </p>
          <div class="example" id="anonymous-mrow-example">
            <p>In the following example, the [^math^] and
              [^mrow^] elements are laid out as described in section
              <a href="#layout-of-mrow"></a>. In particular, the
              <code>&lt;math&gt;</code> element adds proper spacing around its
              <code>&lt;mo&gt;â‰ &lt;/mo&gt;</code> child and the
              <code>&lt;mrow&gt;</code> element stretches its
              <code>&lt;mo&gt;|&lt;/mo&gt;</code> children vertically.
            </p>
            <p>The [^mtd^] element has
              <code>display: table-cell</code> and the
              [^msqrt^] element displays a radical symbol around its
              children. However, they also place their children in a way that
              is similar to what is described in section
              <a href="#layout-of-mrow"></a>: the
              <code>&lt;msqrt&gt;</code> element adds proper spacing around its
              <code>&lt;mo&gt;+&lt;/mo&gt;</code> child while the
              <code>&lt;mtd&gt;</code> element stretches its
              <code>&lt;mo&gt;</code> children vertically.
              In order to make this possible,
              each of these two elements
              <a>generates an anonymous &lt;mrow&gt; box</a>.
            </p>
            <pre data-include="examples/example-anonymous-mrow-nodes.html"
                 data-include-format="text"></pre>
            <img src="examples/example-anonymous-mrow-nodes.png" alt="math example (display)">
          </div>
        </section>
        <section id="stacking-contexts">
          <h4>Stacking contexts</h4>
          <p>MathML elements can overlap due to various spacing rules. They
            can as well contain extra graphical items
            (bars, radical symbol, etc).
            A MathML element with computed style
            <code>display: block math</code>
            or <code>display: inline math</code> generates a new stacking
            context. The <a data-cite="CSS2/zindex.html#painting-order">painting order</a>
            of <a>in-flow</a> children of such a MathML element
            is exactly the same as block elements. The extra graphical
            items are painted after text and background (right after
            step 7.2.4 for <code>display: inline math</code> and right after
            step 7.2 for <code>display: block math</code>).
          </p>
        </section>
      </section>
      <section id="token-elements">
        <h3>Token Elements</h3>
        <p>
          Token elements in presentation markup are broadly intended to
          represent the smallest units of mathematical notation which carry
          meaning. Tokens are roughly analogous to words in text. However,
          because of the precise, symbolic nature of mathematical notation, the
          various categories and properties of token elements figure
          prominently in MathML markup. By contrast, in textual data,
          individual words rarely need to be marked up or styled specially.
        </p>
        <div class="note">
          In practice, most MathML token elements just contain simple text
          for variables, numbers, operators etc and don't need sophisticated
          layout. However, it can contain text with line breaks or
          arbitrary HTML5 phrasing elements.
        </div>
        <section id="text-mtext">
          <h4>Text <code>&lt;mtext&gt;</code></h4>
          <p>
            The
            <dfn class="element">mtext</dfn>
            element is used to represent arbitrary text
            that should be rendered as itself. In general, the
            <code>&lt;mtext&gt;</code> element is intended to denote
            commentary text.
          </p>
          <p>
            The <code>&lt;mtext&gt;</code> element accepts the attributes described
            in <a href="#global-attributes"></a>.
          </p>
          <div class="example" id="mtext-example">
            <p>In the following example, [^mtext^] is used
              to put conditional words in a definition:</p>
            <pre data-include="examples/example-mtext.html"
                 data-include-format="text"></pre>
            <img src="examples/example-mtext.png" alt="mtext example">
          </div>
          <section>
            <h4>Layout of <code>&lt;mtext&gt;</code></h4>
            <p>
              If the element does not have its computed
              [^math/display^] property equal to
              <code>block math</code> or <code>inline math</code>
              then it is laid out according to the CSS specification where
              the corresponding value is described.
              Otherwise, the layout below is performed.
            </p>
            <p>
              If the <code>&lt;mtext&gt;</code> element contains only text
              content without
              <a>forced line break</a>
              or
              <a>soft wrap opportunity</a>
              then, the anonymous child node generated for that text is
              laid out as defined in the relevant CSS specification and:
            </p>
            <ul>
              <li>The <a>min-content inline size</a>,
                <a>max-content inline size</a> and <a>inline size</a> of
                the <a>math content box</a> are equal to the one of the
                anonymous child.</li>
              <li>The <a>ink line-ascent</a> and <a>ink line-descent</a>
                of the <a>math content box</a> are set so that
                its <a>ink-over baseline</a>, <a>ink-under baseline</a>
                and <a>alphabetic baseline</a> match the one of the
                ink bounding box of the text.
              </li>
              <li>The <a>line-ascent</a>
                (respectively <a>line-descent</a>) of the
                <a>math content box</a> is set to the <a>ink line-ascent</a>
                (respectively <a>ink line-descent</a>).
              </li>
              <li>
                If the text content is made of a single glyph and this glyph
                has an entry in the
                <a>MathItalicsCorrectionInfo</a> table then the specified
                value is used as the <a>italic correction</a>.
              </li>
              <li>
                If the text content is made of a single glyph and this glyph
                has an entry in the <a>MathTopAccentAttachment</a> table
                then the specified value is used as the top accent attachment of
                the <code>&lt;mtext&gt;</code> element.
	      </li>
            </ul>
            <p>
              Otherwise, the <code>mtext</code> element is laid out as a
              <a>block box</a>
              and corresponding <a>min-content inline size</a>,
              <a>max-content inline size</a>,
              <a>inline size</a>, <a>block size</a>,
              <a>first baseline set</a> and <a>last baseline set</a> are
              used for the <a>math content box</a>.
            </p>
          </section>
        </section>
        <section id="the-mathvariant-attribute">
          <h4>Identifier <code>&lt;mi&gt;</code></h4>
          <p>
            The
            <dfn class="element">mi</dfn>
            element represents a symbolic name or
            arbitrary text
            that should be rendered as an identifier. Identifiers can include
            variables, function names, and symbolic constants.
          </p>
          <p>
            The <code>&lt;mi&gt;</code> element accepts the attributes described
            in <a href="#global-attributes"></a> as well as the following attribute:
          </p>
          <ul>
            <li>[^mi/mathvariant^]</li>
          </ul>
          <p>The layout algorithm is the same as the [^mtext^] element. The
            <a>user agent stylesheet</a>
            must contain the following property in order to implement automatic
            italic via the text-transform value introduced in <a href="#new-text-transform-values"></a>:
          </p>
          <pre class="css" data-include="user-agent-stylesheet/mi.css"></pre>

            <p>
              The
              <dfn class="element-attr">mathvariant</dfn>
              attribute,
              if present, must be an
              <a>ASCII case-insensitive</a>
              match of <code>normal</code>.
              In that case, the user agent is expected to treat the attribute as a
              <a data-cite="HTML/../#presentational-hints">presentational hint</a> setting the element's
              <a data-xref-type="css-property">text-transform</a>
              property to <code>none</code>. Otherwise it has no effects.
            </p>
            <div class="note">
              <p>In [[MathML3]], the <code>mathvariant</code> attribute was used
                to define logical classes of token elements, each class providing
                a collection of typographically-related symbolic tokens with
                specific meaning within a given mathematical expression.</p>
              <p>
                In MathML Core, this attribute is only used to cancel automatic
                italic of the [^mi^] element. For other use cases, the proper
                Mathematical Alphanumeric Symbols [[UNICODE]] should be used
                instead. See also section <a href="#new-text-transform-mappings"></a>.
              </p>
            </div>
          <div class="example" id="mi-example">
            <p>In the following example, [^mi^] is used to render
              variables and function names. Note that identifiers containing a
              single letter are italic by default.</p>
            <pre data-include="examples/example-mi.html"
                 data-include-format="text"></pre>
            <img src="examples/example-mi.png" alt="mi example">
          </div>
        </section>
        <section>
          <h4>Number <code>&lt;mn&gt;</code></h4>
          <p>
            The
            <dfn class="element">mn</dfn>
            element represents a "numeric literal" or
            other data that should be rendered as a numeric literal. Generally
            speaking, a numeric literal is a sequence of digits, perhaps including a
            decimal point, representing an unsigned integer or real number.
          </p>
          <p>
            The <code>&lt;mn&gt;</code> element accepts the attributes described
            in <a href="#global-attributes"></a>. Its layout algorithm is
            the same as the
            [^mtext^] element.
          </p>
          <div class="example" id="mn-example">
            <p>In the following example, [^mn^] is used to
              write a decimal number.</p>
            <pre data-include="examples/example-mn.html"
                 data-include-format="text"></pre>
            <img src="examples/example-mn.png" alt="mn example">
          </div>
        </section>
        <section id="operator-fence-separator-or-accent-mo">
          <h4>Operator, Fence, Separator or Accent <code>&lt;mo&gt;</code></h4>
          <p>
            The
            <dfn class="element">mo</dfn>
            element represents an
            operator or anything that should be rendered as an operator.
            In general, the notational conventions for mathematical operators
            are quite complicated, and therefore MathML provides a relatively
            sophisticated mechanism for specifying the rendering behavior of an
            <code>&lt;mo&gt;</code> element.</p>
          <p>
            As a consequence, in MathML the
            list of things that should "render as an operator" includes a
            number of notations that are not mathematical operators in the
            ordinary sense. Besides ordinary operators with infix, prefix, or
            postfix forms, these include fence characters such as braces,
            parentheses, and "absolute value" bars; separators such as comma
            and semicolon; and mathematical accents such as a bar or tilde over
            a symbol. This chapter uses the term "operator" to refer to
            operators in this broad sense.
          </p>
          <p>
            The <code>&lt;mo&gt;</code> element accepts the attributes described
            in <a href="#global-attributes"></a> as well as the following
            attributes:
          </p>
          <ul id="mo-attributes">
            <li>[^mo/form^]</li>
            <li>[^mo/fence^]</li>
            <li>[^mo/separator^]</li>
            <li>[^mo/lspace^]</li>
            <li>[^mo/rspace^]</li>
            <li>[^mo/stretchy^]</li>
            <li>[^mo/symmetric^]</li>
            <li>[^mo/maxsize^]</li>
            <li>[^mo/minsize^]</li>
            <li>[^mo/largeop^]</li>
            <li>[^mo/movablelimits^]</li>
          </ul>
          <p>
            This specification does not define any observable behavior that is
            specific to the <dfn class="element-attr" data-dfn-for="mo">fence</dfn> and <dfn class="element-attr" data-dfn-for="mo">separator</dfn> attributes.
          </p>
          <div class="note">
            Authors may use the
            [^mo/fence^] and [^mo/separator^]
            to describe specific semantics of operators.
            The default values may be determined from the
            <a href="#operator-dictionary-compact-special-tables"><code>Operators_fence</code></a> and <a href="#operator-dictionary-compact-special-tables"><code>Operators_separator</code></a> tables, or equivalently
            the <a href="#operator-dictionary-human">human-readable version</a>
            of the operator dictionary.
        </div>
          <div class="example" id="mo-example">
            <p>
              In the following example, the [^mo^] element
              is used for the binary operator +. Default spacing is symmetric
              around that operator. A tigher spacing is used if you rely
              on the <a><code>form</code></a> attribute to force it to be
              treated as a prefix operator.
              Spacing can also be specified explicitly using the
              [^mo/lspace^] and
              [^mo/rspace^] attributes.
            </p>
            <pre data-include="examples/example-mo-1.html"
                 data-include-format="text"></pre>
            <img src="examples/example-mo-1.png" alt="mo example 1">
            <p>
              Another use case is for big operators such as summation.
              When <a>displaystyle</a> is true, such an operator is drawn
              larger but one can change that with the [^mo/largeop^] attribute.
              When <a>displaystyle</a> is false, underscripts are actually
              rendered as subscripts but one can change that with the
              [^mo/movablelimits^] attribute.
            </p>
            <pre data-include="examples/example-mo-2.html"
                 data-include-format="text"></pre>
            <img src="examples/example-mo-2.png" alt="mo example 2">
            <p>Operators are also used for stretchy symbols such as fences,
              accents, arrows etc. In the following example, the vertical arrow
              stretches to the height of the [^mspace^] element.
              One can override default stretch behavior with the
              [^mo/stretchy^] attribute e.g. to force an unstretched arrow.
              The [^mo/symmetric^] attribute allows to indicate whether
              the operator
              should stretch symmetrically above and below the math axis
              (fraction bar).
              Finally the [^mo/minsize^] and [^mo/maxsize^] attributes add
              additional constraints over the stretch size.
            </p>
            <pre data-include="examples/example-mo-3.html"
                 data-include-format="text"></pre>
            <img src="examples/example-mo-3.png" alt="mo example 3">
            <p>Note that the default properties of operators are
              dictionary-based, as explained in
              <a href="#dictionary-based-attributes"></a>. For example a binary
              operator typically has default symmetric spacing around it while a
              fence is generally stretchy by default.
            </p>
          </div>
          <section id="embellished-operators">
            <h5>Embellished operators</h5>
            <p>
              A <a>MathML Core element</a> is an
              <dfn>embellished operator</dfn>
              if it is:
            </p>
            <ol>
              <li>An [^mo^] element;</li>
              <li>
                a <a>scripted element</a> or an
                [^mfrac^],
                whose first <a>in-flow</a> child exists and is an
                <a>embellished operator</a>;
              </li>
              <li>
                a <a>grouping element</a> or [^mpadded^],
                whose <a>in-flow</a> children consist (in any order) of one
                <a>embellished operator</a> and zero or more
                <a>space-like</a> elements.
              </li>
            </ol>
            <p>
              The <dfn data-dfn-for="embellished operator">core operator</dfn> of an <a>embellished operator</a>
              is the <code>&lt;mo&gt;</code> element defined recursively as
              follows:
            </p>
            <ol class="algorithm">
              <li>The core operator of an [^mo^]
                element; is the element itself.</li>
              <li>
                The core operator of an embellished
                <a>scripted element</a> or
                [^mfrac^]
                element is the core operator of its first <a>in-flow</a> child.
              </li>
              <li>
                The core operator of an embellished
                <a>grouping element</a> or [^mpadded^]
                is the core operator of its unique <a>embellished operator</a>
                <a>in-flow</a> child.
              </li>
            </ol>
            <p>
              The <dfn data-dfn-for="embellished operator">stretch axis</dfn> of an <a>embellished operator</a>
                is <em>inline</em> if its
              [=embellished operator/core operator=] contains only text content
              made of a single character <code>c</code>, and that character has
              inline <a>intrinsic stretch axis</a>.
              Otherwise, the stretch axis of the <a>embellished operator</a>
              is <em>block</em>.
            </p>
            <p>
              The same definitions apply for boxes in the
              visual formatting model where an
              <a>anonymous &lt;mrow&gt; box</a> is treated as a
              <a>grouping element</a>.
            </p>
          </section>
          <section id="dictionary-based-attributes">
            <h4>Dictionary-based attributes</h4>
            <p>
              The <code>form</code>
              property of an <a>embellished operator</a> is either
              <code>infix</code>, <code>prefix</code> or
              <code>postfix</code>.
              The corresponding <dfn class="element-attr" data-dfn-for="mo">form</dfn> attribute on the
              [^mo^] element, if present, must be an
              <a>ASCII case-insensitive</a>
              match to one of these values.
            </p>
            <p>
              The <dfn class="abstract-op">algorithm for determining the <code>form</code> of an <a>embellished operator</a></dfn> is as follows:
            </p>
            <ol class="algorithm">
              <li>If the <code>form</code> attribute is present and valid
                on the [=embellished operator/core operator=], then its
                <a data-lt="ASCII lowercase">ASCII lowercased value</a>
                is used.
              </li>
              <li>If the embellished operator is the first <a>in-flow</a> child of a
                <a>grouping element</a>,
                [^mpadded^] or
                [^msqrt^] with more than one <a>in-flow</a> child
                (ignoring all <a>space-like</a> children) then it has
                form <code>prefix</code>.
              </li>
              <li>Or, if the embellished operator is the last <a>in-flow</a> child of
                a
                <a>grouping element</a>,
                [^mpadded^] or
                [^msqrt^]
                with more than one <a>in-flow</a> child
                (ignoring all <a>space-like</a> children) then it has
                form <code>postfix</code>.
              </li>
              <li>Or, if the embellished operator is an <a>in-flow</a> child of a
                <a>scripted element</a>, other than the first <a>in-flow</a>
                child, then it has form <code>postfix</code>.
              </li>
              <li>
                Otherwise, the embellished operator has form
                <code>infix</code>.
              </li>
            </ol>
            <p>
              The
              <dfn data-dfn-for="embellished operator"><code>stretchy</code></dfn>,
              <dfn data-dfn-for="embellished operator"><code>symmetric</code></dfn>,
              <dfn data-dfn-for="embellished operator"><code>largeop</code></dfn>,
              <dfn data-dfn-for="embellished operator"><code>movablelimits</code></dfn>
              properties of an <a>embellished operator</a> are
              either <code>false</code> or <code>true</code>. In the latter
              case, it
              is said that the <a>embellished operator</a> <em>has</em> the
              property.
              The corresponding <dfn class="element-attr" data-dfn-for="mo">stretchy</dfn>, <dfn class="element-attr" data-dfn-for="mo">symmetric</dfn>, <dfn class="element-attr" data-dfn-for="mo">largeop</dfn>, <dfn class="element-attr" data-dfn-for="mo">movablelimits</dfn> attributes on the
              [^mo^] element, if present, must be a
              <a>boolean</a>.
            </p>
            <p>
              The
              <dfn data-dfn-for="embellished operator"><code>lspace</code></dfn>,
              <dfn data-dfn-for="embellished operator"><code>rspace</code></dfn>,
              <dfn data-dfn-for="embellished operator"><code>minsize</code></dfn>
              properties of an <a>embellished operator</a> are
              <a data-xref-type="css-type" href="https://www.w3.org/TR/css-values-4/#typedef-length-percentage">&lt;length-percentage&gt;</a>.
              The <dfn><code>maxsize</code></dfn> property
              of an <a>embellished operator</a> is either a
              <a data-xref-type="css-type" href="https://www.w3.org/TR/css-values-4/#typedef-length-percentage">&lt;length-percentage&gt;</a> or âˆž.
              The
              <dfn class="element-attr" data-dfn-for="mo">lspace</dfn>,
              <dfn class="element-attr" data-dfn-for="mo">rspace</dfn>,
              <dfn class="element-attr" data-dfn-for="mo">minsize</dfn> and
              <dfn class="element-attr" data-dfn-for="mo">maxsize</dfn> attributes on the
              [^mo^] element, if present,
              must be a <a data-xref-type="css-type" href="https://www.w3.org/TR/css-values-4/#typedef-length-percentage">&lt;length-percentage&gt;</a>.
            </p>
            <p>
              The <dfn id="algorithm-for-determining-the-properties-of-an-embellished-operator" class="abstract-op">algorithm for determining the properties of
              an <a>embellished operator</a></dfn> is as follows:
            </p>
            <ol class="algorithm">
              <li>If the corresponding
                <code>stretchy</code>,
                <code>symmetric</code>,
                <code>largeop</code>,
                <code>movablelimits</code>,
                <code>lspace</code>,
                <code>rspace</code>,
                <code>maxsize</code> or
                <code>minsize</code>
                attribute is present and valid
                on the [=embellished operator/core operator=], then the
                <a data-lt="ASCII lowercase">ASCII lowercased value</a>
                of this property is used.</li>
              <li>Otherwise, run the <a>algorithm for determining the <code>form</code> of an embellished operator</a>.</li>
              <li>
                If the [=embellished operator/core operator=] contains only text
                content <code>Content</code>, then set <code>Category</code>
                to the result of the
                <a>algorithm to determine the category of an operator</a>
                <code>(Content, Form)</code>
                where <code>Form</code> is the <a><code>form</code></a>
                calculated at the previous step.
              </li>
              <li>
                If <code>Category</code> is <code>Default</code> and
                the <a><code>form</code></a>
                of <a>embellished operator</a> was not explicitly specified
                as an attribute on its [=embellished operator/core operator=]:
                <ol>
                  <li>Set <code>Category</code> to the result of the
                  <a>algorithm to determine the category of an operator</a>
                  <code>(Content, Form)</code> where <code>Form</code> is
                  <code>infix</code>.</li>
                  <li>If <code>Category</code> is <code>Default</code>, then
                    run the algorithm again with <code>Form</code> set to
                    <code>postfix</code>.</li>
                  <li>If <code>Category</code> is <code>Default</code>, then
                    run the algorithm again with <code>Form</code> set to
                    <code>prefix</code>.</li>
                </ol>
              </li>
              <li>
                Run the
                <a>algorithm to set the properties of an operator from its
                category</a> <code>Category</code>.
              </li>
            </ol>
            <p>When used during layout,
              the values of [=embellished operator/stretchy=],
              [=embellished operator/symmetric=],
              [=embellished operator/largeop=],
              [=embellished operator/movablelimits=],
              [=embellished operator/lspace=],
              [=embellished operator/rspace=],
              [=embellished operator/minsize=] are
              obtained by the
              <a>algorithm for determining the properties of an embellished operator</a> with the following extra resolutions:</p>
            <ul>
              <li>Percentage values for <code>lspace</code>,
              <code>rspace</code> are interpreted
              relative to the value read from the dictionary
              or to the fallback value above.
              </li>
            <li>
              Interpretation of percentage values for <code>minsize</code>
              and <code>maxsize</code> are described in
              <a href="#layout-of-operators"></a>.
            </li>
            <li>
              Font-relative lengths for
              <code>lspace</code>, <code>rspace</code>,
              <code>minsize</code> and <code>maxsize</code> rely on the
              font style of the [=embellished operator/core operator=], not the one of the
              <a>embellished operator</a>.
            </li>
          </ul>
          </section>
          <section id="layout-of-operators">
            <h4>Layout of operators</h4>
            <p>
              If the <code>&lt;mo&gt;</code> element does not have its computed
              [^math/display^] property equal to
              <code>block math</code> or <code>inline math</code>
              then it is laid out according to the CSS specification where
              the corresponding value is described.
              Otherwise, the layout below is performed.
            </p>
            <p>
              The text of the operator must only be painted if the
              <a data-xref-type="css-property">visibility</a> of
              the <code>&lt;mo&gt;</code> element is <code>visible</code>.
              In that case, it must be painted with the
              <a data-xref-type="css-property">color</a>
              of the <code>&lt;mo&gt;</code> element.
            </p>
            <p>Operators are laid out as follows:</p>
            <ol class="algorithm">
              <li>
                If the content of the <code>&lt;mo&gt;</code> element is not
                made
                of a single character <code>c</code> then fall back to the
                layout algorithm of <a href="#layout-of-mtext"></a>.
              </li>
              <li>
                If the operator has the [=embellished operator/stretchy=] property:
                <ul>
                  <li>
                    If the [=embellished operator/stretch axis=] of the operator is inline:
                    <ol>
                      <li>
                        If it is not possible to <a>shape a stretchy glyph</a>
                        corresponding to <code>c</code> in the inline direction
                        with the
                        <a>first available font</a>
                        then fall back to the
                        layout algorithm of <a href="#layout-of-mtext"></a>.
                      </li>
                      <li>
                        The <a>min-content inline size</a> and
                        <a>max-content inline size</a> of the math content
                        are set to the one obtained by the layout algorithm of
                        <a href="#layout-of-mtext"></a>.
                      </li>
                      <li>
                        If there is not any
                        <a>inline stretch size constraint</a>
                        <code>T<sub>inline</sub></code>
                        then
                        fall back to the
                        layout algorithm of <a href="#layout-of-mtext"></a>.
                      </li>
                      <li>
                        The <a>inline size</a> and (ink) block metrics of the math content
                        are given by algorithm to
                        <a>shape a stretchy glyph</a> to <a>inline dimension</a>
                        <code>T<sub>inline</sub></code>.
                      </li>
                      <li>
                        The painting of the operator is performed by the
                        algorithm
                        to <a>shape a stretchy glyph</a>
                        stretched to <a>inline dimension</a>
                        <code>T<sub>inline</sub></code> and
                        at position determined by the previous box metrics.
                      </li>
                    </ol>
                  </li>
                  <li>
                    Otherwise, the [=embellished operator/stretch axis=] of the operator is
                    block. The following steps are performed:
                    <ol>
                      <li>
                        If it is not possible to <a>shape a stretchy glyph</a>
                        corresponding to <code>c</code> in the block direction
                        with the
                        <a>first available font</a>
                        then fall back to the
                        layout algorithm of <a href="#layout-of-mtext"></a>.
                      </li>
                      <li>
                        The <a>min-content inline size</a> and
                        <a>max-content inline size</a> of the math content
                        are set to the
                        <a>preferred inline size of a glyph stretched
                          along the block axis</a>.
                      </li>
                      <li>
                        If there is not any
                        <a>block stretch size constraint</a>
                        <code>(U<sub>ascent</sub>, U<sub>descent</sub>)</code>
                        then
                        fall back to the
                        layout algorithm of <a href="#layout-of-mtext"></a>.
                      </li>
                      <li>If the operator has the [=embellished operator/symmetric=] property
                        then set the target sizes
                        <code>T<sub>ascent</sub></code> and
                        <code>T<sub>descent</sub></code> to
                        <code>S<sub>ascent</sub></code> and
                        <code>S<sub>descent</sub></code> respectively:
                        <ul>
                          <li>
                            <code>S<sub>ascent</sub></code> =
                            max(
                            <code>U<sub>ascent</sub></code> âˆ’ <a>AxisHeight</a>,
                            <code>U<sub>descent</sub></code> + <a>AxisHeight</a>
                            ) + <a>AxisHeight</a>
                          </li>
                          <li>
                            <code>S<sub>descent</sub></code> =
                            max(
                            <code>U<sub>ascent</sub></code> âˆ’ <a>AxisHeight</a>,
                            <code>U<sub>descent</sub></code> + <a>AxisHeight</a>
                            ) âˆ’ <a>AxisHeight</a>
                          </li>
                        </ul>

                        Otherwise set them to
                        <code>U<sub>ascent</sub></code> and
                        <code>U<sub>descent</sub></code> respectively.
                      </li>
                      <li>
                        Let <code>minsize</code> and <code>maxsize</code>
                        be the [=embellished operator/minsize=] and [=embellished operator/maxsize=] properties on the
                        operator. Percentage values are interpreted relative
                        to <code>T</code> =
                        <code>T<sub>ascent</sub></code> +
                        <code>T<sub>descent</sub></code>.
                        If <code>minsize</code> &lt; 0 then set <code>minsize</code>
                        to 0.
                        If <code>maxsize</code> &lt; <code>minsize</code> then
                        set <code>maxsize</code> to <code>minsize</code>.
                        With 0 â‰¤ <code>minsize</code> â‰¤ <code>maxsize</code>:
                        <ul>
                          <li>
                            If <code>T</code> &le; 0 then set
                            <code>T<sub>ascent</sub></code> to <code>minsize</code> / 2  and
                            then set <code>T<sub>descent</sub></code>
                            to <code>minsize</code> âˆ’
                            <code>T<sub>ascent</sub></code>.                            
                          </li>
                          <li>
                            Otherwise, if
                            0 &lt; <code>T</code> &lt; <code>minsize</code>
                            then first
                            multiply
                            <code>T<sub>ascent</sub></code>
                            by <code>minsize</code> / <code>T</code>
                            and then set <code>T<sub>descent</sub></code>
                            to <code>minsize</code> -
                            <code>T<sub>ascent</sub></code>.
                          </li>
                          <li>
                            Otherwise, if <code>maxsize</code> &lt; <code>T</code>
                            then first multiply
                            <code>T<sub>ascent</sub></code> by
                            <code>maxsize</code> / <code>T</code> and
                            then set <code>T<sub>descent</sub></code>
                            to <code>maxsize</code> âˆ’
                            <code>T<sub>ascent</sub></code>.
                          </li>
                        </ul>
                      </li>
                      <li>
                        The <a>inline size</a>,
                        <a>ink line-ascent</a>,
                        <a>ink line-descent</a>,
                        <a>line-ascent</a> and
                        <a>line-descent</a>
                        of the math content
                        are obtained by the algorithm to
                        <a>shape a stretchy glyph</a>
                        to <a>block dimension</a>
                        <code>T<sub>ascent</sub></code> +
                        <code>T<sub>descent</sub></code>.
                        The <a>inline size</a> of the math content is the width of
                        the stretchy glyph. The stretchy glyph is shifted
                        towards the <a>line-under</a> by a value Î” so that its
                        center aligns with the center of the target:
                        the ink ascent of the math content is
                        the ascent of the stretchy glyph âˆ’ Î”
                        and the ink descent of the math content is
                        the descent of the stretchy glyph + Î”.
                        These centers have coordinates "Â½(ascent âˆ’ descent)"
                        so Î” = [(ascent of stretchy glyph âˆ’ descent of stretchy glyph) âˆ’ (<code>T<sub>ascent</sub></code> âˆ’ <code>T<sub>descent</sub></code>)] / 2.
                      </li>
                      <li>
                        The painting of the operator is performed by the
                        algorithm to <a>shape a stretchy glyph</a>
                        stretched to <a>block dimension</a>
                        <code>T<sub>ascent</sub></code> +
                        <code>T<sub>descent</sub></code>
                        and at position determined by the previous box metrics
                        shifted by Î” towards the <a>line-over</a>.
                      </li>
                    </ol>
                    <figure id="figure-base-variants-and-assembly">
                      <img src="figures/bracesize.svg">
                      <figcaption>Base size, size variants and glyph assembly
                        for
                        the left brace</figcaption>
                    </figure>
                  </li>
                </ul>
              </li>
              <li>
                If the operator has the [=embellished operator/largeop=] property and
                if <a><code>math-style</code></a> on
                the <code>&lt;mo&gt;</code> element is <code>normal</code>,
                then:
                <ol>
                  <li>
                    <p>
                      Use the
                      <code>MathVariants</code>
                      table to try and find a glyph of height at least
                      <a>DisplayOperatorMinHeight</a>.
                      If none is found, fall back to the
                      largest non-base glyph. If none is found, fall back to
                      the layout algorithm of <a href="#layout-of-mtext"></a>.
                    </p>
                  </li>
                  <li>
                    The <a>min-content inline size</a>,
                    <a>max-content inline size</a>,
                    <a>inline size</a> and block metrics of the math content
                    are given by the
                    glyph found.
                  </li>
                  <li>
                    Paint the glyph.
                  </li>
                </ol>
                <figure id="figure-sum-base-and-displastyle-sizes">
                  <img src="figures/sumsize.svg">
                  <figcaption>Base and displaystyle sizes of the summation symbol</figcaption>
                </figure>
              </li>
              <li>
                Otherwise fall back to the
                layout algorithm of <a href="#layout-of-mtext"></a>.
              </li>
            </ol>
            <p>If the algorithm to <a>shape a stretchy glyph</a> has been
              used for one of the step above, then the <a>italic correction</a>
              of the math content is set to the value returned by that algorithm.
            </p>
            <div class="note">
              If <code>maxsize</code> is equal to its default value âˆž
              then <code>minsize â‰¤ maxsize</code> is satisfied but
              <code>maxsize &lt; T</code> is not.
            </div>
          </section>
        </section>
        <section id="space-mspace">
          <h4>Space <code>&lt;mspace&gt;</code></h4>
          <p>
            The
            <dfn class="element">mspace</dfn>
            empty element represents a blank space of any
            desired size, as set by its attributes.
          </p>
          <p>
            The <code>&lt;mspace&gt;</code> element accepts the attributes described
            in <a href="#global-attributes"></a> as well as the following
            attributes:
          </p>
          <ul id="mspace-attributes">
            <li>[^mspace/width^]</li>
            <li>[^mspace/height^]</li>
            <li>[^mspace/depth^]</li>
          </ul>
          <p>The
            <dfn id="attribute-mspace-width" class="element-attr" data-dfn-for="mspace">width</dfn>,
            <dfn id="attribute-mspace-height" class="element-attr" data-dfn-for="mspace">height</dfn>,
            <dfn id="attribute-mspace-depth" class="element-attr" data-dfn-for="mspace">depth</dfn>, if present, must
            have a value that is a valid <a data-xref-type="css-type" href="https://www.w3.org/TR/css-values-4/#typedef-length-percentage">&lt;length-percentage&gt;</a>.
          </p>
          <ul>
            <li>
              If the <code>width</code>
              attribute is present, valid and not a percentage then
              that attribute is used as a
              <a data-cite="HTML/../#presentational-hints">presentational hint</a>
              setting the element's
              <a data-xref-type="css-property">width</a>
              property to the corresponding value.
            </li>
            <li>
              If the <code>height</code>
              attribute is absent, invalid or a percentage then the requested
              line-ascent is <code>0</code>.
              Otherwise the requested line-ascent is the resolved
              value of the <code>height</code> attribute, clamping
              negative values to <code>0</code>.
            </li>
            <li>
              If both the <code>height</code> and <code>depth</code> attributes
              are present, valid and not a percentage then they are used as a
              <a data-cite="HTML/../#presentational-hints">presentational hint</a>
              setting the element's
              <a data-xref-type="css-property">height</a>
              property to the concatenation of the strings
              "<code>calc(</code>", the <code>height</code> attribute value,
              "<code> + </code>", the <code>depth</code> attribute value,
              and "<code>)</code>".
              If only one of these attributes is
              present, valid and not a percentage then it is treated as a
              <a data-cite="HTML/../#presentational-hints">presentational hint</a>
              setting the element's
              <a data-xref-type="css-property">height</a>
              property to the corresponding value.
            </li>
          </ul>
          <div class="example" id="mspace-example">
            <p>In the following example, [^mspace^] is used to
              force spacing within the formula (a 1px blue border is
              added to easily visualize the space):</p>
            <pre data-include="examples/example-mspace.html"
                 data-include-format="text"></pre>
            <img src="examples/example-mspace.png" alt="mspace example">
          </div>
          <p>
            If the <code>&lt;mspace&gt;</code> element does not have its
            computed
            [^math/display^] property equal to
            <code>block math</code> or <code>inline math</code>
            then it is laid out according to the CSS specification where
            the corresponding value is described.
            Otherwise,
            the <code>&lt;mspace&gt;</code> element is laid out as shown on
            <a href="#figure-box-mspace"></a>.
            The <a>min-content inline size</a>,
            <a>max-content inline size</a> and <a>inline size</a> of the math
            content are equal to the resolved value of the
            <a data-xref-type="css-property">width</a> property.
            The <a>block size</a> of the math content is equal to the resolved
            value of the <a data-xref-type="css-property">height</a> property.
            The <a>line-ascent</a> of the math content is equal to the
            requested line-ascent determined above.
          </p>
          <figure id="figure-box-mspace">
            <img src="figures/mspacebox.svg">
            <figcaption>Box model for the <code>&lt;mspace&gt;</code> element</figcaption>
          </figure>
          <div class="note">
            The terminology height/depth comes from [[MATHML3]], itself inspired
            from [[TEXBOOK]].
          </div>
          <section id="definition-of-space-like-elements">
            <h3>Definition of space-like elements</h3>
            <p>
              A number of MathML presentation elements are "space-like" in the
              sense that they typically render as whitespace, and do not affect
              the mathematical meaning of the expressions in which they appear.
              As a consequence, these elements often function in somewhat
              exceptional ways in other MathML expressions.
            </p>
            <p>
              A <a>MathML Core element</a> is a
              <dfn data-lt="space-like">space-like element</dfn>
              if it is:
            </p>
            <ol>
              <li>an
                [^mtext^] or
                [^mspace^];
              </li>
              <li>or a
                <a>grouping element</a> or [^mpadded^]
                all of whose <a>in-flow</a> children are <a>space-like</a>.
              </li>
            </ol>
            <p>
              The same definitions apply for boxes in the
              visual formatting model where an
              <a>anonymous &lt;mrow&gt; box</a> is treated as a
              <a>grouping element</a>.
            </p>
            <div class="note">
              Note that an [^mphantom^] is not
              automatically defined to be space-like, unless its content is
              space-like. This is because operator spacing is affected by
              whether adjacent elements are space-like.
              Since the <code>&lt;mphantom&gt;</code> element is
              primarily intended as an aid in aligning expressions, operators
              adjacent to an <code>&lt;mphantom&gt;</code> should behave
              as if they were adjacent to the contents of the
              <code>&lt;mphantom&gt;</code>, rather than to an equivalently
              sized area of whitespace.
            </div>
          </section>
        </section>
        <section id="string-literal-ms">
          <h4>String Literal <code>&lt;ms&gt;</code></h4>
          <p>
            <dfn class="element">ms</dfn>
            element is used to represent
            "string literals" in expressions meant to be interpreted by computer
            algebra systems or other systems containing "programming languages".
          </p>
          <p>
            The <code>&lt;ms&gt;</code> element accepts the attributes described
            in <a href="#global-attributes"></a>.  Its layout algorithm is
            the same as the [^mtext^] element.
          </p>
          <div class="example" id="ms-example">
            <p>In the following example, [^ms^] is used to
              write a literal string of characters:</p>
            <pre data-include="examples/example-ms.html"
                 data-include-format="text"></pre>
            <img src="examples/example-ms.png" alt="ms example">
          </div>
          <div class="note">
            In MathML3, it was possible to use the <code>lquote</code> and
            <code>rquote</code> attributes to respectively specify the strings
            to use as opening and closing quotes. These are no longer supported
            and the quotes must instead be specified as part of the text of the
            <code>&lt;ms&gt;</code> element. One can add CSS rules to legacy
            documents in order to preserve visual rendering. For example,
            in left-to-right direction:
            <pre class="css" data-include="user-agent-stylesheet/ms-legacy.css"></pre>
          </div>
        </section>
      </section>
      <section>
        <h3>General Layout Schemata</h3>
        <p>Besides tokens there are several families of MathML presentation
          elements. One family of elements deals with various "scripting"
          notations, such as subscript and superscript. Another family is
          concerned with matrices and tables. The remainder of the elements,
          discussed in this section, describe other basic notations such as
          fractions and radicals, or deal with general functions such as
          setting style properties and error handling.
        </p>
        <section id="horizontally-group-sub-expressions-mrow">
          <h4>Group Sub-Expressions <code>&lt;mrow&gt;</code></h4>
          <p>
            The
            <dfn class="element">mrow</dfn>
            element is used to group together any number of sub-expressions, usually
            consisting of one or more <code>&lt;mo&gt;</code> elements acting as
            "operators" on one or more other expressions that are their "operands".
          </p>
          <div class="example" id="mrow-example">
            <p>In the following example, [^mrow^] is used to
              group a sum "1 + 2/3" as a fraction numerator (first child
              of [^mfrac^]) and to construct a fenced expression
              (first child of [^msup^]) that is raised to the power of 5.
              Note that [^mrow^] alone does not add visual fences
              around its grouped content, one has to explicitly specify them
              using the [^mo^] element.
            </p>
            <p>
              Within the [^mrow^] elements, one can see that
              vertical alignment of children (according to the
              <a>alphabetic baseline</a> or the <a>mathematical baseline</a>)
              is properly performed, fences are vertically stretched and
              spacing around the binary + operator automatically calculated.
            </p>
            <pre data-include="examples/example-mrow.html"
                 data-include-format="text"></pre>
            <img src="examples/example-mrow.png" alt="mrow example">
          </div>
          <p>
            The <code>&lt;mrow&gt;</code> element accepts the attributes described
            in <a href="#global-attributes"></a>. An <code>&lt;mrow&gt;</code>
            element with <a>in-flow</a> children
            child<sub>1</sub>, child<sub>2</sub>, â€¦, child<sub>N</sub>
            is laid out as shown on <a href="#figure-box-mrow"></a>. The child boxes
            are put in a row one after the other with all their
            <a>alphabetic baselines</a>
            aligned.
          </p>
          <figure id="figure-box-mrow">
            <img src="figures/mrowbox.svg">
            <figcaption>Box model for the <code>&lt;mrow&gt;</code> element</figcaption>
          </figure>
          <div class="note">
            Because the box model ensures alignment of <a>alphabetic baselines</a>,
            fraction bars or symmetric stretchy operators
            will also be aligned along the <a>math axis</a> in the typical case when
            <a>AxisHeight</a> is the same for all <a>in-flow</a> children.
          </div>
          <section id="algorithm-for-stretching-operators-along-the-block-axis">
            <h5>Algorithm for stretching operators along the block axis</h5>
            <figure id="symmetric-and-non-symmetric-vertical-stretching">
              <img src="figures/vstretch.svg">
              <figcaption>Symmetric and non-symmetric stretching of
                operators along the <a>block axis</a></figcaption>
            </figure>
            <p>
              The <dfn class="abstract-op">algorithm for stretching operators along the block axis</dfn>
              consists in the following steps:
            </p>
            <ol class="algorithm">
              <li>
                If there is a <a>block stretch size constraint</a>
                or an <a>inline stretch size constraint</a>
                then the element being laid out is an
                <a>embellished operator</a>. Lay out the one <a>in-flow</a> child that
                is an <a>embellished operator</a>
                with the same stretch size constraint and
                all the other <a>in-flow</a> children
                without any stretch size constraint
                and stop.
              </li>
              <li>Otherwise,
                split the list of <a>in-flow</a> children into a first list
                <code>L<sub>ToStretch</sub></code> containing
                <a>embellished operators</a> with
                a [=embellished operator/stretchy=] property and block [=embellished operator/stretch axis=];
                and a second list <code>L<sub>NotToStretch</sub></code>.
              </li>
              <li>
                Perform layout without any stretch size constraint on
                all the items of <code>L<sub>NotToStretch</sub></code>.
                If <code>L<sub>ToStretch</sub></code> is empty then stop.
                If <code>L<sub>NotToStretch</sub></code> is empty, perform
                layout with stretch size constraint 0 on
                all the items of <code>L<sub>ToStretch</sub></code>.
              </li>
              <li>
                Calculate the unconstrained target sizes
                <code>U<sub>ascent</sub></code>
                and <code>U<sub>descent</sub></code> as respectively the maximum
                ink ascent and maximum ink descent of the <a>margin boxes</a> of
                <a>in-flow</a> children that
                have been laid out in the previous step.
              </li>
              <li>
                Lay out or relayout all the elements of
                <code>L<sub>ToStretch</sub></code> with
                <a>block stretch size constraint</a>
                <code>(U<sub>ascent</sub>, U<sub>descent</sub>)</code>.
              </li>
            </ol>
          </section>
          <section id="layout-of-mrow">
            <h5>Layout of <code>&lt;mrow&gt;</code></h5>
            <p>
              If the box is not an <a>anonymous &lt;mrow&gt; box</a>
              and the associated element does not have its computed
              [^math/display^] property equal to
              <code>block math</code> or <code>inline math</code>
              then it is laid out according to the CSS specification where
              the corresponding value is described.
              Otherwise, the layout below is performed.
            </p>
            <p>
              A child box is <dfn>slanted</dfn> if it is not an
              <a>embellished operator</a>
              and has nonzero <a>italic correction</a>.
            </p>
            <div class="note">
              Large operators may have nonzero <a>italic correction</a> but that one
              is used when attaching scripts.
              More generally, all <a>embellished operators</a>
              are treated as non-slanted since the spacing around them is
              calculated as specified by [=embellished operator/lspace=] and
              [=embellished operator/rspace=].
            </div>
            <p>
              The <a>min-content inline size</a>
              (respectively <a>max-content inline size</a>) are
              calculated using the following algorithm:
            </p>
            <ol class="algorithm">
              <li>
                Set <code>add-space</code> to true if
                the box corresponds to a [^math^] element
                or is not an
                <a>embellished operator</a>; and to false otherwise.
              </li>
              <li>Set <code>inline-offset</code> to 0.</li>
              <li>Set <code>previous-italic-correction</code> to 0.</li>
              <li>
                For each <a>in-flow</a> child:
                <ol>
                  <li>
                    If the child is not <a>slanted</a>, then increment
                    <code>inline-offset</code> by
                    <code>previous-italic-correction</code>.
                  </li>
                  <li>
                    If the child is an <a>embellished operator</a>
                    and <code>add-space</code> is true then
                    increment <code>inline-offset</code> by
                    its [=embellished operator/lspace=] property.
                  </li>
                  <li>
                    Increment <code>inline-offset</code> by
                    the <a>min-content inline size</a>
                    (respectively <a>max-content inline size</a>) of
                    the child's <a>margin box</a>.
                  </li>
                  <li>
                    If the child is <a>slanted</a> then
                    set <code>previous-italic-correction</code> to
                    its <a>italic correction</a>. Otherwise set it to 0.
                  </li>
                  <li>
                    If the child is an <a>embellished operator</a>
                    and <code>add-space</code> is true then
                    increment <code>inline-offset</code> by
                    its [=embellished operator/rspace=] property.
                  </li>
                </ol>
              </li>
              <li>
                Increment <code>inline-offset</code> by
                <code>previous-italic-correction</code>.
              </li>
              <li>
                Return <code>inline-offset</code>.
              </li>
            </ol>
            <p>
              The <a>in-flow</a> children are laid out using the
              <a>algorithm for stretching operators along the block axis</a>.
            </p>
            <p>
              The <a>inline size</a> of the math content is calculated like
              the <a>min-content inline size</a> and
              <a>max-content inline size</a> of the math content,
              using the <a>inline size</a> of the
              <a>in-flow</a> children's <a>margin boxes</a> instead.
            </p>
            <p>
              The <a>ink line-ascent</a> (respectively <a>line-ascent</a>)
              of the math content
              is the maximum of the
              <a>ink line-ascents</a> (respectively <a>line-ascents</a>)
              of all the <a>in-flow</a> children's <a>margin boxes</a>. Similarly,
              the <a>ink line-descent</a> (respectively <a>line-descent</a>)
              of the math content is the maximum of the <a>ink line-descents</a>
              (respectively <a>ink line-ascents</a>)
              of all the <a>in-flow</a> children's <a>margin boxes</a>.
            </p>
            <p>
              The <a>in-flow</a> children are positioned using the following
              algorithm:
            </p>
            <ol class="algorithm">
              <li>
                Set <code>add-space</code> to true if
                the box corresponds to a [^math^] element
                or is not an
                <a>embellished operator</a>; and to false otherwise.
              </li>
              <li>Set <code>inline-offset</code> to 0.</li>
              <li>Set <code>previous-italic-correction</code> to 0.</li>
              <li>For each <a>in-flow</a> child:
                <ol>
                  <li>
                    If the child is not <a>slanted</a>, then increment
                    <code>inline-offset</code> by
                    <code>previous-italic-correction</code>.
                  </li>
                  <li>
                    If the child is an <a>embellished operator</a>
                    and <code>add-space</code> is true then
                    increment <code>inline-offset</code> by
                    its [=embellished operator/lspace=] property.
                  </li>
                  <li>
                    Set the <a>inline offset</a> of the child
                    to <code>inline-offset</code> and its <a>block offset</a> such
                    that the <a>alphabetic baseline</a> of the child is aligned with the <a>alphabetic baseline</a>.
                  </li>
                  <li>
                    Increment <code>inline-offset</code> by
                    the <a>inline size</a> of the child's <a>margin box</a>.
                  </li>
                  <li>
                    If the child is <a>slanted</a> then
                    set <code>previous-italic-correction</code> to
                    its <a>italic correction</a>. Otherwise set it to 0.
                  </li>
                  <li>
                    If the child is an <a>embellished operator</a>
                    and <code>add-space</code> is true then
                    increment <code>inline-offset</code> by
                    its [=embellished operator/rspace=] property.
                  </li>
                </ol>
              </li>
            </ol>
            <p>The <a>italic correction</a> of the math content is set to the italic
              correction of the last <a>in-flow</a> child, which is
              the final value of <code>previous-italic-correction</code>.</p>
          </section>
        </section>
        <section id="fractions-mfrac">
          <h4>Fractions <code>&lt;mfrac&gt;</code></h4>
          <p id="mfrac">
            The
            <dfn class="element">mfrac</dfn>
            element is used for fractions. It can also be used to mark up
            fraction-like objects such as binomial coefficients and Legendre symbols.
          </p>
          <p>
            If the <code>&lt;mfrac&gt;</code> element does not have its computed
            [^math/display^] property equal to <code>block math</code>
            or <code>inline math</code>
            then it is laid out according to the CSS specification where
            the corresponding value is described.
            Otherwise, the layout below is performed.
          </p>
          <p>
            The <code>&lt;mfrac&gt;</code> element accepts the attributes described
            in <a href="#global-attributes"></a> as well as the
            following attribute:
          </p>
          <ul>
            <li>[^mfrac/linethickness^]</li>
          </ul>
          <p>
            The
            <dfn data-dfn-for="mfrac" class="element-attr">linethickness</dfn>
            attribute indicates the <dfn>fraction line thickness</dfn>
            to use for the fraction bar.
            If present, it must
            have a value that is a valid <a data-xref-type="css-type" href="https://www.w3.org/TR/css-values-4/#typedef-length-percentage">&lt;length-percentage&gt;</a>.
            If the attribute is absent or has an invalid value,
            <a>FractionRuleThickness</a> is used as the default
            value. A percentage is interpreted relative to that default value.
            A negative value is interpreted as 0.
          </p>
          <div class="example" id="mfrac-example">
            <p>The following example contains four fractions
              with different [^mfrac/linethickness^] values. The bars are always
              aligned with the middle of plus and minus signs.
              The numerator and denominator are horizontally centered.
              The fractions that are not in <a>displaystyle</a>
              use smaller gaps and font-size.</p>
            <pre data-include="examples/example-mfrac.html"
                 data-include-format="text"></pre>
            <img src="examples/example-mfrac.png" alt="mfrac example">
          </div>
          <p>
            The <code>&lt;mfrac&gt;</code> element sets
            <a><code>displaystyle</code></a> to <code>false</code>,
            or if it was already <code>false</code> increments
            <a><code>scriptlevel</code></a> by 1, within its children.
            It sets <a>math-shift</a> to
            <code>compact</code> within its second child.
            To avoid visual confusion between the fraction bar and another
            adjacent items (e.g. minus sign or another fraction's bar),
            a default 1-pixel space is added around the element.
            The <a>user agent stylesheet</a>
            must contain the following rules:
          </p>
          <pre class="css" data-include="user-agent-stylesheet/mfrac.css"></pre>
          <p>
            If the <code>&lt;mfrac&gt;</code> element
            has less or more than two <a>in-flow</a> children, its layout algorithm
            is the same as the [^mrow^] element.
            Otherwise, the first <a>in-flow</a> child is called
            <dfn>numerator</dfn>, the second <a>in-flow</a> child is called
            <dfn>denominator</dfn> and the layout algorithm is explained below.
          </p>
          <div class="note" id="fraction-css-rules-on-children">
            In practice, an <code>&lt;mfrac&gt;</code> element has two children
            that are <a>in-flow</a>. Hence the CSS rules basically perform
            <a><code>scriptlevel</code></a>, <a><code>displaystyle</code></a>
            and <a>math-shift</a>
            changes for the <a>numerator</a> and
            <a>denominator</a>.
          </div>
          <section id="fraction-with-nonzero-line-thickness">
            <h5>Fraction with nonzero line thickness</h5>
            <p>
              If the <a>fraction line thickness</a> is nonzero, the
              <code>&lt;mfrac&gt;</code>
              element is laid out as shown on <a href="#figure-box-mfrac"></a>.
              The fraction bar must only be painted if the
              <a data-xref-type="css-property">visibility</a> of
              the <code>&lt;mfrac&gt;</code> element is <code>visible</code>.
              In that case, the fraction bar must be painted with the
              <a data-xref-type="css-property">color</a>
              of the <code>&lt;mfrac&gt;</code> element.
            </p>
            <figure id="figure-box-mfrac">
              <img src="figures/mfracbox.svg">
              <figcaption>Box model for the <code>&lt;mfrac&gt;</code> element</figcaption>
            </figure>
            <p>The <a>min-content inline size</a>
              (respectively <a>max-content inline size</a>)
              of content is the maximum between the
              <a>min-content inline size</a>
              (respectively <a>max-content inline size</a>) of the <a>numerator</a>'s
              <a>margin box</a> and the <a>min-content inline size</a>
              (respectively <a>max-content inline size</a>) of the <a>denominator</a>'s
              <a>margin box</a>.
            </p>
            <p>
              If there is an <a>inline stretch size constraint</a>
              or a <a>block stretch size constraint</a> then
              the <a>numerator</a> is also laid out with the same stretch size
              constraint,
              otherwise it is laid out without any stretch
              size constraint. The <a>denominator</a> is always laid out without
              any stretch size constraint.
            </p>
            <p>
              The <a>inline size</a> of the math content
              is the maximum between the <a>inline size</a> of the
              <a>numerator</a>'s <a>margin box</a> and the <a>inline size</a> of the
              <a>denominator</a>'s <a>margin box</a>.
            </p>
            <p><code>NumeratorShift</code> is the maximum between:</p>
            <ul>
              <li>
                <a>FractionNumeratorShiftUp</a> (respectively
                <a>FractionNumeratorDisplayStyleShiftUp</a>) if
                the <a>math-style</a> is <code>compact</code>
                (respectively <code>normal</code>).
              </li>
              <li>
                The <a>AxisHeight</a> + half the
                <a>fraction line thickness</a> +
                <a>FractionNumeratorGapMin</a>
                (respectively <a>FractionNumDisplayStyleGapMin</a>)
                if the <a>math-style</a> is <code>compact</code>
                (respectively <code>normal</code>) +
                the <a>ink line-descent</a> of the <a>numerator</a>'s <a>margin box</a>.
              </li>
            </ul>
            <p><code>DenominatorShift</code> is the maximum between:</p>
            <ul>
              <li>
                <a>FractionDenominatorShiftDown</a> (respectively
                <a>FractionDenominatorDisplayStyleShiftDown</a>) if
                the <a>math-style</a> is <code>compact</code>
                (respectively <code>normal</code>).
              </li>
              <li>
                Half the <a>fraction line thickness</a> +
                <a>FractionDenominatorGapMin</a>
                (respectively <a>FractionDenomDisplayStyleGapMin</a>)
                if the <a>math-style</a> is <code>compact</code>
                (respectively <code>normal</code>) +
                the <a>ink line-ascent</a> of the <a>denominator</a>'s <a>margin box</a> âˆ’
                the <a>AxisHeight</a>.
              </li>
            </ul>
            <p>
              The <a>line-ascent</a> of the math content is the maximum between:
            </p>
            <ul>
              <li>
                 <code>Numerator Shift</code> +
                 the <a>line-ascent</a> of the <a>numerator</a>'s <a>margin box</a>.
              </li>
              <li>
                âˆ’<code>Denominator Shift</code> +
                the <a>line-ascent</a> of the <a>denominator</a>'s <a>margin box</a>
              </li>
              <li>
                <a>AxisHeight</a> plus half the
                <a>fraction line thickness</a>.
              </li>
            </ul>
            <p>
              The <a>line-descent</a> of the math content is the maximum between:
            </p>
            <ul>
              <li>
                âˆ’<code>Numerator Shift</code>
                + the <a>line-descent</a> of the <a>numerator</a>'s <a>margin box</a>.
              </li>
              <li>
                <code>Denominator Shift</code>
                + the <a>line-descent</a> of the <a>denominator</a>'s <a>margin box</a>.
              </li>
              <li>
                âˆ’<a>AxisHeight</a> plus half the
                <a>fraction line thickness</a>.
              </li>
              <li>0</li>
            </ul>
            <p>
              The <a>inline offset</a> of the <a>numerator</a> (respectively <a>denominator</a>)
              is half the <a>inline size</a> of the math content âˆ’
              half the <a>inline size</a> of
              the <a>numerator</a>'s <a>margin box</a>
              (respectively <a>denominator</a>'s <a>margin box</a>).
            </p>
            <p>
              The <a>alphabetic baseline</a> of the <a>numerator</a> (respectively <a>denominator</a>)
              is shifted away from the <a>alphabetic baseline</a> by a distance of
              <code>NumeratorShift</code> (respectively
              <code>DenominatorShift</code>)
              towards the <a>line-over</a> (respectively <a>line-under</a>).
            </p>
            <p>
              The <a>math content box</a> is placed within the
              <a>content box</a> so that their block-start edges
              are aligned and the middles of these edges are at the same
              position.
            </p>
            <p>
              The <a>inline size</a> of the fraction bar is the
              <a>inline size</a> of the <a>content box</a> and its
              inline-start edge is the aligned with the one the
              <a>content box</a>.
              The center of the fraction bar is shifted away from the <a>alphabetic baseline</a> of the <a>math content box</a>
              by a distance of <a>AxisHeight</a> towards the <a>line-over</a>.
              Its <a>block size</a> is the
              <a>fraction line thickness</a>.
            </p>
          </section>
          <section id="fraction-with-zero-line-thickness">
            <h5>Fraction with zero line thickness</h5>
            <p>
              If the <a>fraction line thickness</a> is zero,
              the <code>&lt;mfrac&gt;</code> element is instead laid out as
              shown on <a href="#figure-box-mfrac-without-bar"></a>.
            </p>
            <figure id="figure-box-mfrac-without-bar">
              <img src="figures/mfracnobarbox.svg">
              <figcaption>Box model for the <code>&lt;mfrac&gt;</code> element without bar</figcaption>
            </figure>
            <p>
              The <a>min-content inline size</a>, <a>max-content inline size</a>
              and <a>inline size</a> of the math content are calculated the same
              as in <a href="#fraction-with-nonzero-line-thickness"></a>.
            </p>
            <p>
              If there is an <a>inline stretch size constraint</a> or
              a <a>block stretch size constraint</a> then
              the <a>numerator</a> is also laid out with the same stretch size
              constraint
              and otherwise it is laid out without any stretch
              size constraint. The <a>denominator</a> is always laid out without
              any stretch size constraint.
            </p>
            <p>
              If the <a>math-style</a> is <code>compact</code> then
              <code>TopShift</code> and
              <code>BottomShift</code> are respectively
              set to <a>StackTopShiftUp</a> and <a>StackBottomShiftDown</a>.
              Otherwise <a>math-style</a> is <code>normal</code> and
              they are respectively set to <a>StackTopDisplayStyleShiftUp</a>
              and <a>StackBottomDisplayStyleShiftDown</a>.
            </p>
            <p>
              The <code>Gap</code> is defined to be
              (<code>BottomShift</code> âˆ’
              the <a>ink line-ascent</a> of the <a>denominator</a>'s <a>margin box</a>) +
              (<code>TopShift</code> âˆ’
              the <a>ink line-descent</a> of the <a>numerator</a>'s <a>margin box</a>).
              If <a>math-style</a> is <code>compact</code>
              then <code>GapMin</code>
              is <a>StackGapMin</a>,
              otherwise <a>math-style</a> is <code>normal</code>
              and it is <a>StackDisplayStyleGapMin</a>.
              If Î” = <code>GapMin</code> âˆ’ <code>Gap</code> is positive then
              <code>TopShift</code> and <code>BottomShift</code>
              are respectively increased by Î”/2 and Î” âˆ’ Î”/2.
            </p>
            <p>
              The <a>line-ascent</a> of the math content is the maximum between:
            </p>
            <ul>
              <li>
                 <code>TopShift</code> +
                 the <a>line-ascent</a> of the <a>numerator</a>'s <a>margin box</a>.
              </li>
              <li>
                âˆ’<code>BottomShift</code>
                + the <a>line-ascent</a> of the <a>denominator</a>'s <a>margin box</a>.
              </li>
            </ul>
            <p>
              The <a>line-descent</a> of the math content is the maximum between:
            </p>
            <ul>
              <li>
                âˆ’<code>TopShift</code>
                + the <a>line-descent</a> of the <a>numerator</a>'s <a>margin box</a>.
              </li>
              <li>
                <code>BottomShift</code>
                + the <a>line-descent</a> of the <a>denominator</a>'s <a>margin box</a>.
              </li>
              <li>0</li>
            </ul>
            <p>
              The <a>inline offsets</a> of the <a>numerator</a> and <a>denominator</a> are
              calculated the same as in
              <a href="#fraction-with-nonzero-line-thickness"></a>.
            </p>
            <p>
              The <a>alphabetic baseline</a> of the <a>numerator</a> (respectively <a>denominator</a>) is
              shifted away from the <a>alphabetic baseline</a> by a distance of
              <code>TopShift</code> (respectively âˆ’
              <code>BottomShift</code>) towards the
              <a>line-over</a> (respectively <a>line-under</a>).
            </p>
            <p>
              The <a>math content box</a> is placed within the
              <a>content box</a> so that their block-start edges
              are aligned and the middles of these edges are at the same
              position.
            </p>
          </section>
        </section>
        <section id="radicals-msqrt-mroot">
          <h4>Radicals <code>&lt;msqrt&gt;</code>, <code>&lt;mroot&gt;</code></h4>
          <p>
            The <a>radical elements</a> construct an expression with a
            root symbol âˆš with a line over the content.
            The <dfn class="element">msqrt</dfn> element is
            used for square roots, while the <dfn class="element">mroot</dfn> element is
            used to draw radicals with indices, e.g. a cube root.
          </p>
          <p>
            The <code>&lt;msqrt&gt;</code> and <code>&lt;mroot&gt;</code>
            elements accept the attributes described
            in <a href="#global-attributes"></a>.
          </p>
          <div class="example" id="msqrt-mroot-example">
            <p>The following example contains a square root
              written with [^msqrt^] and a cube root written
              with [^mroot^].
              Note that [^msqrt^] has several children and the
              square root applies to all of them.
              [^mroot^] has exactly two children: it is a
              root of index the second child (the number 3), applied to the
              first child (the square root).
              Also note these elements only change the font-size within the
              [^mroot^] index, but it is scaled down more than
              within the numerator and denumerator of the fraction.
            </p>
            <pre data-include="examples/example-msqrt-mroot.html"
                 data-include-format="text"></pre>
            <img src="examples/example-msqrt-mroot.png" alt="msqrt-mroot example">
          </div>
          <p>
            The <code>&lt;msqrt&gt;</code> and <code>&lt;mroot&gt;</code>
            elements sets <a>math-shift</a> to
            <code>compact</code>.
            The <code>&lt;mroot&gt;</code> element
            increments <a><code>scriptlevel</code></a> by 2, and sets <a><code>displaystyle</code></a> to "false" in all
            but its first child.
            The <a>user agent stylesheet</a>
            must contain the following rule in order to implement that behavior:
          </p>
          <pre class="css" data-include="user-agent-stylesheet/radicals.css"></pre>
          <p>
            If the <code>&lt;msqrt&gt;</code> or <code>&lt;mroot&gt;</code>
            element do not have their computed
            [^math/display^] property equal to <code>block math</code>
            or <code>inline math</code>
            then they are laid out according to the CSS specification where
            the corresponding value is described.
            Otherwise, the layout below is performed.
          </p>
          <p>
            If the <code>&lt;mroot&gt;</code> has less or more than two
            <a>in-flow</a> children,
            its layout algorithm
            is the same as the [^mrow^] element.
            Otherwise, the first <a>in-flow</a> child is called
            <dfn>mroot base</dfn> and
            the second <a>in-flow</a> child is called
            <dfn>mroot index</dfn>
            and its layout algorithm is explained below.
          </p>
          <div class="note" id="mroot-css-rules-on-children">
            In practice, an <code>&lt;mroot&gt;</code> element has two children
            that are <a>in-flow</a>. Hence the CSS rules basically perform
            <a><code>scriptlevel</code></a> and <a><code>displaystyle</code></a> changes for the index.
          </div>
          <p>
            The <code>&lt;msqrt&gt;</code> element
            <a>generates an anonymous &lt;mrow&gt; box</a>
            called the <dfn>msqrt base</dfn>.
          </p>
          <section id="radical-symbol">
            <h5>Radical symbol</h5>
            <p>
              The radical symbol must only be painted if the
              <a data-xref-type="css-property">visibility</a> of
              the <code>&lt;msqrt&gt;</code> or <code>&lt;mroot&gt;</code>
              element is <code>visible</code>.
              In that case, the radical symbol must be painted with the
              <a data-xref-type="css-property">color</a>
              of that element.
            </p>
            <p>
              The <dfn>radical glyph</dfn> is the glyph obtained for the
              character U+221A SQUARE ROOT.
            </p>
            <p>
              The <dfn>radical gap</dfn> is given by
              <a>RadicalVerticalGap</a>
              if the <a>math-style</a> is <code>compact</code> and
              <a>RadicalDisplayStyleVerticalGap</a>
              if the <a>math-style</a> is <code>normal</code>.
            </p>
            <p>
              The radical target size for the stretchy radical glyph is
              the sum of <a>RadicalRuleThickness</a>,
              <a>radical gap</a> and the ink height of the base.
            </p>
            <p>
              The <dfn>box metrics of the radical glyph</dfn>
              and <dfn>painting of the surd</dfn> are given by the algorithm to
              <a>shape a stretchy glyph</a> to <a>block dimension</a> the
              target size for the radical glyph.
            </p>
          </section>
          <section>
            <h5>Square root</h5>
            <p>
              The <code>&lt;msqrt&gt;</code> element is laid out as shown on
              <a href="#figure-box-msqrt"></a>.
            </p>
            <figure id="figure-box-msqrt">
              <img src="figures/msqrtbox.svg">
              <figcaption>Box model for the <code>&lt;msqrt&gt;</code> element</figcaption>
            </figure>
            <p>
              The <a>min-content inline size</a>
               (respectively <a>max-content inline size</a>)
              of the math content is
              the sum of the
              <a>preferred inline size of a glyph stretched along the
                block axis</a>
              for the <a>radical glyph</a>
              and of the
              <a>min-content inline size</a> (respectively <a>max-content inline size</a>)
              of the <a>msqrt base</a>'s <a>margin box</a>.
            </p>
            <p>
              The <a>inline size</a> of the math content is the sum of the advance width
              of the <a>box metrics of the radical glyph</a> and
              of the <a>inline size</a> of the <a>msqrt base</a>'s margin's box.
            </p>
            <p>
              The <a>line-ascent</a> of the math content is the maximum between:
            </p>
            <ul>
              <li>The <a>line-ascent</a> of the <a>msqrt base</a>'s <a>margin box</a>.</li>
              <li>The sum of the <a>ink line-ascent</a> of the <a>msqrt base</a>,
                the <a>radical gap</a>, the <a>RadicalRuleThickness</a>
                and <a>RadicalExtraAscender</a>.</li>
            </ul>
            <p>
              The <a>line-descent</a> of the math content is the maximum between:
            </p>
            <ul>
              <li>The <a>line-descent</a> of the <a>msqrt base</a>'s <a>margin box</a>.</li>
              <li>The sum of the <a>line-ascent</a> and <a>line-descent</a> for the
                <a>box metrics of the radical glyph</a> and of the
                <a>RadicalExtraAscender</a>, minus the
                <a>line-ascent</a> of the math content.
              </li>
            </ul>
            <p>
              The <a>inline size</a> of the overbar is the <a>inline size</a> of the
              <a>msqrt base</a>'s margin's box.
              The <a>inline offsets</a> of the <a>msqrt base</a> and overbar are also the same
              and equal to the width of the
              <a>box metrics of the radical glyph</a>.
            </p>
            <p>
              The <a>alphabetic baseline</a> of the <a>msqrt base</a> is aligned with the <a>alphabetic baseline</a>.
              The <a>block size</a> of the overbar is
              <a>RadicalRuleThickness</a>. Its vertical center is shifted away
              from the <a>alphabetic baseline</a> by a distance towards the <a>line-over</a>
              equal to the <a>line-ascent</a> of the math content, minus
              the <a>RadicalExtraAscender</a>,
              minus half the <a>RadicalRuleThickness</a>.
            </p>
            <p>
              Finally, the <a>painting of the surd</a> is performed:
            </p>
            <ul>
              <li>
                At <a>inline offset</a> 0.
              </li>
              <li>
                At <a>block offset</a> shifted away from the
                <a>line-over</a> edge of the overbar towards the <a>line-under</a>
                by a distance given by the ascent
                of the <a>box metrics of the radical glyph</a>.
              </li>
            </ul>
          </section>
          <section>
            <h5>Root with index</h5>
            <p>
              The <code>&lt;mroot&gt;</code> element is laid out as shown on
              <a href="#figure-box-mroot"></a>.
              The <a>mroot index</a> is first ignored and the <a>mroot base</a>
              and
              radical glyph are laid out as
              shown on figure <a href="#figure-box-msqrt"></a>
              using the same algorithm as in
              <a href="#square-root"></a>
              in order to produce a margin box B (represented in green).
            </p>
            <figure id="figure-box-mroot">
              <img src="figures/mrootbox.svg">
              <figcaption>Box model for the <code>&lt;mroot&gt;</code> element</figcaption>
            </figure>
            <p>
              The <a>min-content inline size</a>
              (respectively <a>max-content inline size</a>) of the math content is the sum
              of max(0, <a>RadicalKernBeforeDegree</a>),
              the <a>mroot index</a>'s
              <a>min-content inline size</a>
              (respectively <a>max-content inline size</a>)
              of the <a>mroot index</a>'s <a>margin box</a>,
              max(âˆ’<a>min-content inline size</a>, <a>RadicalKernAfterDegree</a>)
              (respectively max(âˆ’<a>max-content inline size</a>, <a>RadicalKernAfterDegree</a>))
              and of the
              <a>min-content inline size</a>
              (respectively <a>max-content inline size</a>) of B.
            </p>
            <p>Using the same clamping,
              <dfn>AdjustedRadicalKernBeforeDegree</dfn> and
              <dfn>AdjustedRadicalKernAfterDegree</dfn> are respectively
              defined as max(0, <a>RadicalKernBeforeDegree</a>) and
              is max(âˆ’<a>inline size</a> of the index's <a>margin box</a>,
              <a>RadicalKernAfterDegree</a>).</p>
            <p>
              The <a>inline size</a> of the math content is the sum of
              <a>AdjustedRadicalKernBeforeDegree</a>,
              the <a>inline size</a> of the index's <a>margin box</a>,
              <a>AdjustedRadicalKernAfterDegree</a>
              and of the <a>inline size</a> of B.
            </p>
            <p>
              The <a>line-ascent</a> of the math content is the maximum between:
            </p>
            <ul>
              <li>âˆ’the <a>line-descent</a> of B +
                <a>RadicalDegreeBottomRaisePercent</a> Ã—
                the <a>block size</a> of B + the <a>line-ascent</a> of the
                index's <a>margin box</a></li>
              <li>The <a>line-ascent</a> of B</li>
            </ul>
            <p>The <a>line-descent</a> of the math content is the maximum between:</p>
            <ul>
              <li>the <a>line-descent</a> of B âˆ’
                <a>RadicalDegreeBottomRaisePercent</a> Ã—
                the <a>block size</a> of B + the <a>line-ascent</a> of the
                index's <a>margin box</a></li>
              <li>The <a>line-descent</a> of B</li>
            </ul>
            <p>
              The <a>inline offset</a> of the index is
              <a>AdjustedRadicalKernBeforeDegree</a>.
              The inline-offset of the
              <a>mroot base</a> is the same + the
              <a>inline size</a> of the index's <a>margin box</a>.
            </p>
            <p>
              The <a>alphabetic baseline</a> of B is aligned with the <a>alphabetic baseline</a>.
              The <a>alphabetic baseline</a> of the index is shifted away
              from the <a>line-under</a> edge by a distance of
              <a>RadicalDegreeBottomRaisePercent</a> Ã—
              the <a>block size</a> of B + the <a>line-descent</a> of the
              index's <a>margin box</a>.
            </p>
            <div class="note">
              In general, the kerning before the root index is positive while
              the kerning after it is negative, which means that the root
              element will have some inline-start space and that the root index
              will overlap the surd.
            </div>
          </section>
        </section>
        <section id="style-change-mstyle">
          <h4>Style Change <code>&lt;mstyle&gt;</code></h4>
          <p>
            Historically, the
            <dfn class="element">mstyle</dfn>
            element was introduced to make
            style changes that affect the rendering of its contents.
          </p>
          <p>
            The <code>&lt;mstyle&gt;</code> element accepts the attributes described in
            <a href="#global-attributes"></a>. Its layout algorithm is the
            same as the [^mrow^] element.
          </p>
          <div class="note">
            <code>&lt;mstyle&gt;</code> is implemented for compatibility with full MathML. Authors whose only target is MathML Core are encouraged to use CSS for styling.
          </div>
          <div class="example" id="mstyle-example">
            <p>In the following example,
              [^mstyle^] is used to set the <a>scriptlevel</a>
              and <a>displaystyle</a>.
              Observe this is respectively affecting the
              font-size and placement of subscripts of their
              descendants. In MathML Core, one could just have used
              [^mrow^] elements instead.
            </p>
            <pre data-include="examples/example-mstyle.html"
                 data-include-format="text"></pre>
            <img src="examples/example-mstyle.png" alt="mstyle example">
          </div>
        </section>
        <section id="error-message-merror">
          <h4>Error Message <code>&lt;merror&gt;</code></h4>
          <p>
            The
            <dfn class="element">merror</dfn>
            element displays its contents as an
            â€error messageâ€. The intent of this element is to provide a standard way
            for programs that generate MathML from other input to report syntax errors
            in their input.
          </p>
          <div class="example" id="merror-example">
            <p>In the following example,
              [^merror^] is used to indicate a parsing error
              for some LaTeX-like input:
            </p>
            <pre data-include="examples/example-merror.html"
                 data-include-format="text"></pre>
            <img src="examples/example-merror.png" alt="merror example">
          </div>
          <p>
            The <code>&lt;merror&gt;</code> element accepts the attributes described in
            <a href="#global-attributes"></a>. Its layout algorithm is the
            same as the [^mrow^] element.
            The <a>user agent stylesheet</a>
            must contain the following rule in order to visually highlight the error
            message:
          </p>
          <pre class="css" data-include="user-agent-stylesheet/merror.css"></pre>
        </section>
        <section id="adjust-space-around-content-mpadded">
          <h4>Adjust Space Around Content <code>&lt;mpadded&gt;</code></h4>
          <p>
            The
            <dfn class="element">mpadded</dfn>
            element renders the same as its <a>in-flow</a> child content, but with the
            size and relative positioning point of its
            content modified according to <code>&lt;mpadded&gt;</code>â€™s attributes.
          </p>
          <p>
            The <code>&lt;mpadded&gt;</code> element accepts the attributes described
            in <a href="#global-attributes"></a> as well as the following
            attributes:
          </p>
          <ul id="mpadded-attributes">
            <li>[^mpadded/width^]</li>
            <li>[^mpadded/height^]</li>
            <li>[^mpadded/depth^]</li>
            <li>[^mpadded/lspace^]</li>
            <li>[^mpadded/voffset^]</li>
          </ul>
          <p>The
            <dfn id="attribute-mpadded-width" class="element-attr" data-dfn-for="mpadded">width</dfn>,
            <dfn id="attribute-mpadded-height" class="element-attr" data-dfn-for="mpadded">height</dfn>,
            <dfn id="attribute-mpadded-depth" class="element-attr" data-dfn-for="mpadded">depth</dfn>,
            <dfn id="attribute-mpadded-lspace" class="element-attr" data-dfn-for="mpadded">lspace</dfn>
            and
            <dfn id="attribute-mpadded-voffset" class="element-attr" data-dfn-for="mpadded">voffset</dfn>
            if present, must
            have a value that is a valid <a data-xref-type="css-type" href="https://www.w3.org/TR/css-values-4/#typedef-length-percentage">&lt;length-percentage&gt;</a>.
          </p>
          <div class="example" id="mpadded-example">
            <p>In the following example, [^mpadded^] is used to
              tweak spacing around a fraction
              (a blue background is used to visualize it).
              Without attributes, it behaves like an [^mrow^] but
              the attributes allow to specify the size of the box
              (width, height, depth) and position of the fraction within that
              box (lspace and voffset).
            </p>
            <pre data-include="examples/example-mpadded.html"
                 data-include-format="text"></pre>
            <img src="examples/example-mpadded.png" alt="mpadded example">
          </div>

          <section>
            <h5>Inner box and requested parameters</h5>
            <p>
              The [^mpadded^] element
              <a>generates an anonymous &lt;mrow&gt; box</a> called the
              <dfn>mpadded inner box</dfn> with parameters called
              inner inline size, inner <a>line-ascent</a> and inner line-descent.
            </p>
            <p>
              The requested <code>&lt;mpadded&gt;</code>
              parameters are determined as follows:
            </p>
            <ul class="algorithm">
              <li>
                The requested width
                is the resolved value of the
                <a data-xref-type="css-property">width</a> property.
                If the <code>width</code>
                attribute is present, valid and not a percentage then
                that attribute is used as a
                <a data-cite="HTML/../#presentational-hints">presentational hint</a>
                setting the element's
                <a data-xref-type="css-property">width</a>
                property to the corresponding value.
              </li>
              <li>
                If the <code>height</code>
                attribute is absent, invalid or a percentage then the requested
                height is the inner <a>line-ascent</a>.
                Otherwise the requested height is the resolved
                value of the <code>height</code> attribute, clamping
                negative values to <code>0</code>.
              </li>
              <li>
                If the <code>depth</code>
                attribute is absent, invalid or a percentage then the requested
                depth is the inner <a>line-ascent</a>.
                Otherwise the requested depth is the resolved
                value of the <code>depth</code> attribute, clamping
                negative values to <code>0</code>.
              </li>
              <li>
                If the <code>lspace</code>
                attribute is absent, invalid or a percentage then the requested
                lspace is 0. Otherwise the requested lspace is the resolved
                value of the <code>lspace</code> attribute, clamping
                negative values to <code>0</code>.
              </li>
              <li>
                If the <code>voffset</code>
                attribute is absent, invalid or a percentage then the requested
                voffset is 0. Otherwise the requested voffset is the resolved
                value of the <code>voffset</code> attribute.
                <div class="note">
                  Negative <code>voffset</code> values are not clamped to
                  <code>0</code>.
                </div>
              </li>
            </ul>
          </section>
          <section>
            <h5>Layout of <code>&lt;mpadded&gt;</code></h5>
            <p>
              If the <code>&lt;mpadded&gt;</code> element does not have its
              computed
              [^math/display^] property equal to <code>block math</code>
              or <code>inline math</code>
              then it is laid out according to the CSS specification where
              the corresponding value is described.
              Otherwise, it is laid out as shown on
              <a href="#figure-box-mpadded"></a>.
            </p>
            <figure id="figure-box-mpadded">
              <img src="figures/mpaddedbox.svg">
              <figcaption>Box model for the <code>&lt;mpadded&gt;</code> element</figcaption>
            </figure>
            <p>
              The <a>min-content inline size</a> (respectively <a>max-content inline size</a>)
              of the math content
              is the requested width calculated in
              <a href="#inner-box-and-requested-parameters"></a>
              but using the <a>min-content inline size</a> (respectively <a>max-content inline size</a>) of the
              <a>mpadded inner box</a> instead of the "inner inline size".
            </p>
            <p>
              The <a>inline size</a> of the math content
              is the requested width calculated in
              <a href="#inner-box-and-requested-parameters"></a>.
            </p>
            <p>
              The <a>line-ascent</a> of the math content is the requested height.
              The <a>line-descent</a> of the math content is the requested depth.
            </p>
            <p>
              The <a>mpadded inner box</a> is placed so that its <a>alphabetic baseline</a> is
              shifted away from the <a>alphabetic baseline</a> by the requested voffset
              towards the <a>line-over</a>.
            </p>
          </section>
        </section>
        <section id="making-sub-expressions-invisible-mphantom">
          <h4>Making Sub-Expressions Invisible <code>&lt;mphantom&gt;</code></h4>
          <p>
            Historically, the
            <dfn class="element">mphantom</dfn>
            element was introduced to render
            its content invisibly, but with the same metrics size and other dimensions,
            including <a>alphabetic baseline</a> position that its contents would have if they were
            rendered normally.
          </p>
          <div class="example" id="mphantom-example">
            <p>In the following example,
              [^mphantom^] is used to ensure alignment of
              corresponding parts of the numerator and denominator of a
              fraction:
            </p>
            <pre data-include="examples/example-mphantom.html"
                 data-include-format="text"></pre>
            <img src="examples/example-mphantom.png" alt="mphantom example">
          </div>
          <p>
            The <code>&lt;mphantom&gt;</code> element accepts the attributes described
            in <a href="#global-attributes"></a>. Its layout algorithm is
            the same as the [^mrow^] element.
            The <a>user agent stylesheet</a>
            must contain the following rule in order to hide the content:
          </p>
          <pre class="css" data-include="user-agent-stylesheet/mphantom.css"></pre>
          <div class="note">
            <code>&lt;mphantom&gt;</code> is implemented for compatibility with full MathML. Authors whose only target is MathML Core are encouraged to use CSS for styling.
          </div>
        </section>
      </section>
      <section id="script-and-limit-schemata">
        <h3>Script and Limit Schemata</h3>
        <p>
          The elements described in this section position one or more scripts
          around a base. Attaching various kinds of scripts and embellishments
          to symbols is a very common notational device in mathematics. For
          purely visual layout, a single general-purpose element could suffice
          for positioning scripts and embellishments in any of the traditional
          script locations around a given base. However, in order to capture
          the abstract structure of common notation better, MathML provides
          several more specialized scripting elements.
        </p>
        <p>
          In addition to sub-/superscript elements, MathML has overscript and
          underscript elements that place scripts above and below the base.
          These elements can be used to place limits on large operators, or for
          placing accents and lines above or below the base.
        </p>
        <section id="subscripts-and-superscripts-msub-msup-msubsup">
          <h4>Subscripts and Superscripts <code>&lt;msub&gt;</code>, <code>&lt;msup&gt;</code>, <code>&lt;msubsup&gt;</code></h4>
          <p>
            The <dfn class="element">msub</dfn>,
            <dfn class="element">msup</dfn> and
            <dfn class="element">msubsup</dfn> elements are used to attach
            subscript and superscript to a MathML expression.
            They accept the attributes described in
            <a href="#global-attributes"></a>.
          </p>
          <div class="example" id="msub-msup-msubsup-example">
            <p>The following example shows basic use of subscripts and
              superscripts. The font-size is automatically scaled down
              within the scripts.
            </p>
            <pre data-include="examples/example-msub-msup-msubsup.html"
                 data-include-format="text"></pre>
            <img src="examples/example-msub-msup-msubsup.png" alt="msub-msup-msubsup example">
          </div>
          <p>
            If the
            <code>&lt;msub&gt;</code>,
            <code>&lt;msup&gt;</code> or
            <code>&lt;msubsup&gt;</code> elements do not have their
            computed
            [^math/display^] property equal to <code>block math</code>
            or <code>inline math</code>
            then they are laid out according to the CSS specification where
            the corresponding value is described.
            Otherwise, the layout below is performed.
          </p>
          <section>
            <h5>Children of <code>&lt;msub&gt;</code>,
            <code>&lt;msup&gt;</code>, <code>&lt;msubsup&gt;</code></h5>
            <p>
              If the <code>&lt;msub&gt;</code> element
              has less or more than two <a>in-flow</a> children, its layout algorithm
              is the same as the [^mrow^] element.
              Otherwise, the first <a>in-flow</a> child is called the
              <dfn>msub base</dfn>, the second <a>in-flow</a> child is called the
              <dfn>msub subscript</dfn> and the layout algorithm is explained
              in <a href="#base-with-subscript"></a>.
            </p>
            <p>
              If the <code>&lt;msup&gt;</code> element
              has less or more than two <a>in-flow</a> children, its layout algorithm
              is the same as the [^mrow^] element.
              Otherwise, the first <a>in-flow</a> child is called the
              <dfn>msup base</dfn>, the second <a>in-flow</a> child is called the
              <dfn>msup superscript</dfn> and the layout algorithm is explained
              in <a href="#base-with-superscript"></a>.
            </p>
            <p>
              If the <code>&lt;msubsup&gt;</code> element
              has less or more than three <a>in-flow</a> children, its layout algorithm
              is the same as the [^mrow^] element.
              Otherwise, the first <a>in-flow</a> child is called the
              <dfn>msubsup base</dfn>, the second <a>in-flow</a> child
              is called the <dfn>msubsup subscript</dfn>,
              its third <a>in-flow</a> child is called
              the <dfn>msubsup superscript</dfn> and the layout algorithm is explained
              in <a href="#base-with-subscript-and-superscript"></a>.
            </p>
          </section>
          <section>
            <h5>Base with subscript</h5>
            <p>
              The <code>&lt;msub&gt;</code> element is laid out as shown on
              <a href="#figure-box-msub"></a>.
              <code>LargeOpItalicCorrection</code>
              is the <a>italic correction</a> of the <a>msub base</a>
              if it is an <a>embellished operator</a> with
              the [=embellished operator/largeop=] property and 0 otherwise.
            </p>
            <figure id="figure-box-msub">
              <img src="figures/msubbox.svg">
              <figcaption>Box model for the <code>&lt;msub&gt;</code> element</figcaption>
            </figure>
            <p>
              The
              <a>min-content inline size</a> (respectively <a>max-content inline size</a>) of the math content is the
              <a>min-content inline size</a> (respectively <a>max-content inline size</a>) of the <a>msub base</a>'s <a>margin box</a> âˆ’
              <code>LargeOpItalicCorrection</code> +
              <a>min-content inline size</a> (respectively <a>max-content inline size</a>) of
              the <a>msub subscript</a>'s <a>margin box</a> + <a>SpaceAfterScript</a>.
            </p>
            <p>
              If there is an
              <a>inline stretch size constraint</a>
              or a <a>block stretch size constraint</a>
              then the <a>msub base</a> is also laid out with the same stretch size
              constraint and otherwise it is laid out without any stretch
              size constraint. The scripts are always laid out without
              any stretch size constraint.
            </p>
            <p>
              The <a>inline size</a> of the math content
              is the inline size of the <a>msub base</a>'s <a>margin box</a> âˆ’
              <code>LargeOpItalicCorrection</code> +
              the <a>inline size</a> of
              the <a>msub subscript</a>'s <a>margin box</a> + <a>SpaceAfterScript</a>.
            </p>
            <p>
              <code>SubShift</code> is the maximum between:
            </p>
            <ul>
              <li><a>SubscriptShiftDown</a></li>
              <li>the <a>ink line-ascent</a> of the
                subscript's <a>margin box</a> âˆ’ <a>SubscriptTopMax</a></li>
              <li><a>SubscriptBaselineDropMin</a> + the <a>ink line-descent</a> of the
                <a>msub base</a>'s <a>margin box</a></li>
            </ul>
            <p>
              The <a>line-ascent</a> of the math content is the maximum between:
            </p>
            <ul>
              <li>The <a>line-ascent</a> of the <a>msub base</a>'s <a>margin box</a>.</li>
              <li>The <a>line-ascent</a> of the subscript's <a>margin box</a> âˆ’
                <code>SubShift</code>.</li>
            </ul>
            <p>
              The <a>line-descent</a> of the math content is the maximum between:
            </p>
            <ul>
              <li>The <a>line-descent</a> of the <a>msub base</a>'s <a>margin box</a>.</li>
              <li>The <a>line-descent</a> of the subscript's <a>margin box</a> +
                <code>SubShift</code>.</li>
            </ul>
            <p>
              The <a>inline offset</a> of the <a>msub base</a> is 0 and the <a>inline offset</a> of the
              <a>msub subscript</a> is the <a>inline size</a> of the <a>msub base</a>'s <a>margin box</a> âˆ’
              <code>LargeOpItalicCorrection</code>.
            </p>
            <p>
              The <a>msub base</a> is placed so that its <a>alphabetic baseline</a>
              matches the <a>alphabetic baseline</a>. The <a>msub subscript</a> is placed so that its <a>alphabetic baseline</a>
              is shifted away from the <a>alphabetic baseline</a> by <code>SubShift</code>
              towards the <a>line-under</a>.
            </p>
          </section>
          <section>
            <h5>Base with superscript</h5>
            <p>
              The <code>&lt;msup&gt;</code> element is laid out as shown on
              <a href="#figure-box-msup"></a>.
              <code>ItalicCorrection</code>
              is the <a>italic correction</a> of the <a>msup base</a>
              if it is not an <a>embellished operator</a> with
              the [=embellished operator/largeop=] property and 0 otherwise.
            </p>
            <figure id="figure-box-msup">
              <img src="figures/msupbox.svg">
              <figcaption>Box model for the <code>&lt;msup&gt;</code> element</figcaption>
            </figure>
            <p>
              The
              <a>min-content inline size</a> (respectively <a>max-content inline size</a>)
              of the math content
              is the
              <a>min-content inline size</a> (respectively <a>max-content inline size</a>) of
              the <a>msup base</a>'s <a>margin box</a> +
              <code>ItalicCorrection</code> +
              the <a>min-content inline size</a> (respectively <a>max-content inline size</a>) of
              the <a>msup superscript</a>'s <a>margin box</a> + <a>SpaceAfterScript</a>.
            </p>
            <p>
              If there is an
              <a>inline stretch size constraint</a>
              or a <a>block stretch size constraint</a>
              then the <a>msup base</a> is also laid out with the same stretch size
              constraint and otherwise it is laid out without any stretch
              size constraint. The scripts are always laid out without
              any stretch size constraint.
            </p>
            <p>
              The <a>inline size</a> of the math content
              is the <a>inline size</a> of the <a>msup base</a>'s <a>margin box</a> +
              <code>ItalicCorrection</code> +
              the <a>inline size</a> of
              the <a>msup superscript</a>'s <a>margin box</a> + <a>SpaceAfterScript</a>.
            </p>
            <p>
              <code>SuperShift</code> is the maximum between:
            </p>
            <ul>
              <li>The value <a>SuperscriptShiftUpCramped</a> if the
                element has a computed
                <a>math-shift</a> property equal to
                <code>compact</code>, or
                <a>SuperscriptShiftUp</a> otherwise.</li>
              <li>
                <a>SuperscriptBottomMin</a> + the <a>ink line-descent</a> of the
                superscript's <a>margin box</a></li>
              <li>The <a>ink line-ascent</a> of the <a>msup base</a>'s <a>margin box</a>
                âˆ’ <a>SuperscriptBaselineDropMax</a></li>
            </ul>
            <p>
              The <a>line-ascent</a> of the math content is the maximum between:
            </p>
            <ul>
              <li>The <a>line-ascent</a> of the <a>msup base</a>'s <a>margin box</a>.</li>
              <li>The <a>line-ascent</a> of the superscript's <a>margin box</a> +
                <code>SuperShift</code>.</li>
            </ul>
            <p>
              The <a>line-descent</a> of the math content is the maximum between:
            </p>
            <ul>
              <li>The <a>line-descent</a> of the <a>msup base</a>'s <a>margin box</a>.</li>
              <li>The <a>line-descent</a> of the superscript's <a>margin box</a> âˆ’
                <code>SuperShift</code>.</li>
            </ul>
            <p>
              The <a>inline offset</a> of the <a>msup base</a> is 0 and the <a>inline offset</a> of
              <a>msup superscript</a> is the <a>inline size</a> of the <a>msup base</a>'s <a>margin box</a> +
              <code>ItalicCorrection</code>.
            </p>
            <p>
              The <a>msup base</a> is placed so that its <a>alphabetic baseline</a>
              matches the <a>alphabetic baseline</a>. The <a>msup superscript</a> is placed so that its
              <a>alphabetic baseline</a>
              is shifted away from the <a>alphabetic baseline</a> by <code>SuperShift</code>
              towards the <a>line-over</a>.
            </p>
          </section>
          <section>
            <h5>Base with subscript and superscript</h5>
            <p>
              The <code>&lt;msubsup&gt;</code> element is laid out as shown on
              <a href="#figure-box-msup"></a>.
              <code>LargeOpItalicCorrection</code> and <code>SubShift</code>
              are set as in <a href="#base-with-subscript"></a>.
              <code>ItalicCorrection</code> and <code>SuperShift</code>
              are set as in <a href="#base-with-superscript"></a>.
            </p>
            <figure id="figure-box-msubsup">
              <img src="figures/msubsupbox.svg">
              <figcaption>Box model for the <code>&lt;msubsup&gt;</code> element</figcaption>
            </figure>
            <p>
              The
              <a>min-content inline size</a> (respectively <a>max-content inline size</a> and
              <a>inline size</a>) of the math content is the maximum between the
              <a>min-content inline size</a> (respectively <a>max-content inline size</a> and
              <a>inline size</a>) of the math content calculated in
              <a href="#base-with-subscript"></a> and
              <a href="#base-with-superscript"></a>.
            </p>
            <p>
              If there is an
              <a>inline stretch size constraint</a>
              or a <a>block stretch size constraint</a>
              then the <a>msubsup base</a> is also laid out with the same stretch size
              constraint and otherwise it is laid out without any stretch
              size constraint. The scripts are always laid out without
              any stretch size constraint.
            </p>
            <p>
              If there is an
              <a>inline stretch size constraint</a>
              or a <a>block stretch size constraint</a>
              then the <a>msubsup base</a> is also laid out with the same stretch size
              constraint and otherwise it is laid out without any stretch
              size constraint. The scripts are always laid out without
              any stretch size constraint.
            </p>
            <p>
              <code>SubSuperGap</code> is the gap between the two scripts
              along the <a>block axis</a> and is defined by
              (<code>SubShift</code> âˆ’ the <a>ink line-ascent</a> of the <a>msubsup subscript</a>'s
              <a>margin box</a>) +
              (<code>SuperShift</code> âˆ’ the <a>ink line-descent</a> of the
              <a>msubsup superscript</a>'s <a>margin box</a>).
              If <code>SubSuperGap</code> is not at least
              <a>SubSuperscriptGapMin</a> then the following steps are
              performed to ensure that the condition holds:
            </p>
            <ol class="algorithm">
              <li>
                Let Î” be <a>SuperscriptBottomMaxWithSubscript</a>
                âˆ’ (<code>SuperShift</code> âˆ’ the <a>ink line-descent</a> of the
                <a>msubsup superscript</a>'s <a>margin box</a>).
                If Î” &gt; 0 then set Î” to the minimum between Î” set
                <a>SubSuperscriptGapMin</a> âˆ’ <code>SubSuperGap</code> and
                increase <code>SuperShift</code> (and so
                <code>SubSuperGap</code> too) by Î”.
              </li>
              <li>
                Let Î” be <a>SubSuperscriptGapMin</a> âˆ’ <code>SubSuperGap</code>.
                If Î” &gt; 0 then
                increase <code>SubscriptShift</code> (and so
                <code>SubSuperGap</code> too) by Î”.
              </li>
            </ol>
            <p>
              The <a>ink line-ascent</a> (respectively <a>line-ascent</a>, <a>ink line-descent</a>,
              <a>line-descent</a>) of the math content
              is set to the maximum
              of the
              <a>ink line-ascent</a> (respectively <a>line-ascent</a>, <a>ink line-descent</a>,
              <a>line-descent</a>) of the math content
              calculated in
              <a href="#base-with-subscript"></a> and
              <a href="#base-with-superscript"></a>
              but using the adjusted values <code>SubShift</code> and
              <code>SuperShift</code> above.
            </p>
            <p>
              The <a>inline offset</a> and <a>block offset</a> of the <a>msubsup base</a> and scripts are
              performed the
              same as described in
              <a href="#base-with-subscript"></a> and
              <a href="#base-with-superscript"></a>.
            </p>
            <div class="note" id="msubsup-with-empty-scripts">
              <p>
                Even when the <a>msubsup subscript</a> (respectively <a>msubsup superscript</a>) is an empty
                box, <code>&lt;msubsup&gt;</code>
                does not generally render the same as
                <a href="#base-with-superscript"></a>
                (respectively <a href="#base-with-subscript"></a>)
                because of the additional constraint on
                <code>SubSuperGap</code>.
                Moreover, positioning the empty <a>msubsup subscript</a>
                (respectively <a>msubsup superscript</a>)
                may also change the total size.
              </p>
              <p>
                In order to keep the algorithm simple, no attempt is made to
                handle empty scripts in a special way.
              </p>
             </div>
          </section>
        </section>
        <section id="underscripts-and-overscripts-munder-mover-munderover">
          <h4>Underscripts and Overscripts <code>&lt;munder&gt;</code>, <code>&lt;mover&gt;</code>, <code>&lt;munderover&gt;</code></h4>
          <p>
            The <dfn class="element">munder</dfn>,
            <dfn class="element">mover</dfn> and
            <dfn class="element">munderover</dfn> elements are used to
            attach
            accents or limits placed under or over a MathML expression.
          </p>
          <p>
            The <code>&lt;munderover&gt;</code> element accepts the attribute
            described in <a href="#global-attributes"></a> as well as the
            following attributes:
          </p>
          <ul id="munderover-attributes">
            <li>[^munderover/accent^]</li>
            <li>[^munderover/accentunder^]</li>
          </ul>
          <p>
            Similarly, the <code>&lt;mover&gt;</code> element
            (respectively <code>&lt;munder&gt;</code> element) accepts the
            attribute described in <a href="#global-attributes"></a>
            as well as the [^mover/accent^]
            attribute (respectively the
            [^mover/accentunder^] attribute).
          </p>
          <p>
            <dfn class="element-attr" data-dfn-for="munderover,mover,munder">accent</dfn>,
            <dfn class="element-attr" data-dfn-for="munderover,mover,munder">accentunder</dfn>
            attributes, if present, must have values that are <a>booleans</a>.
            If these attributes are absent or invalid, they are treated as
            equal to <code>false</code>.
            User agents must implement them as described in
            <a href="#displaystyle-and-scriptlevel-in-scripts"></a>.
          </p>
          <div class="example" id="munder-mover-munderover-example">
            <p>The following example shows basic use of under- and overscripts.
              The font-size is automatically scaled down within the scripts,
              unless they are meant to be accents.
            </p>
            <pre data-include="examples/example-munder-mover-munderover.html"
                 data-include-format="text"></pre>
            <img src="examples/example-munder-mover-munderover.png" alt="munder-over-munderover example">
          </div>
          <p>
            If the
            <code>&lt;munder&gt;</code>,
            <code>&lt;mover&gt;</code> or
            <code>&lt;munderover&gt;</code> elements do not have their
            computed
            [^math/display^] property equal to <code>block math</code>
            or <code>inline math</code>
            then they are laid out according to the CSS specification where
            the corresponding value is described.
            Otherwise, the layout below is performed.
          </p>
          <section>
            <h5>Children of <code>&lt;munder&gt;</code>,
            <code>&lt;mover&gt;</code>, <code>&lt;munderover&gt;</code></h5>
            <p>
              If the <code>&lt;munder&gt;</code> element
              has less or more than two <a>in-flow</a> children, its layout algorithm
              is the same as the [^mrow^] element.
              Otherwise, the first <a>in-flow</a> child is called the
              <dfn>munder base</dfn> and the second <a>in-flow</a> child is called the
              <dfn>munder underscript</dfn>.
            </p>
            <p>
              If the <code>&lt;mover&gt;</code> element
              has less or more than two <a>in-flow</a> children, its layout algorithm
              is the same as the [^mrow^] element.
              Otherwise, the first <a>in-flow</a> child is called the
              <dfn>mover base</dfn> and the second <a>in-flow</a> child is called the
              <dfn>mover overscript</dfn>.
            </p>
            <p>
              If the <code>&lt;munderover&gt;</code> element
              has less or more than three <a>in-flow</a> children, its layout algorithm
              is the same as the [^mrow^] element.
              Otherwise, the first <a>in-flow</a> child is called the
              <dfn>munderover base</dfn>, the second <a>in-flow</a> child
              is called the <dfn>munderover underscript</dfn>
              and its third <a>in-flow</a> child is called
              the <dfn>munderover overscript</dfn>.
            </p>
            <p>
              If the
              <code>&lt;munder&gt;</code>, <code>&lt;mover&gt;</code> or
              <code>&lt;munderover&gt;</code> elements have a computed
              <a>math-style</a> property equal to <code>compact</code>
              and their base is an <a>embellished operator</a> with the
              [=embellished operator/movablelimits=] property, then
              their layout algorithms are respectively
              the same as the ones described for
              <code>&lt;msub&gt;</code>, <code>&lt;msup&gt;</code> and
              <code>&lt;msubsup&gt;</code> in
              <a href="#base-with-subscript"></a>,
              <a href="#base-with-superscript"></a> and
              <a href="#base-with-subscript-and-superscript"></a>.
            </p>
            <p>
              Otherwise, the
              <code>&lt;munder&gt;</code>, <code>&lt;mover&gt;</code> and
              <code>&lt;munderover&gt;</code> layout algorithms are respectively
              described in
              <a href="#base-with-underscript"></a>,
              <a href="#base-with-overscript"></a> and
              <a href="#base-with-underscript-and-overscript"></a>.
            </p>
          </section>
          <section id="algorithm-for-stretching-operators-along-the-inline-axis">
            <h4>Algorithm for stretching operators along the inline axis</h4>
            <p>
              The <dfn class="abstract-op">algorithm for stretching operators along the inline
                axis</dfn>
              is as follows.
            </p>
            <ol class="algorithm">
              <li>
                If there is an
                <a>inline stretch size constraint</a> or
                <a>block stretch size constraint</a>
                then the element being laid out is an
                <a>embellished operator</a>. Lay out the base
                with the same stretch size constraint.
              </li>
              <li>
                Split the list of <a>in-flow</a> children that have not been
                laid out yet into a first list
                <code>L<sub>ToStretch</sub></code> containing
                <a>embellished operators</a> with
                a [=embellished operator/stretchy=] property and inline [=embellished operator/stretch axis=];
                and a second list <code>L<sub>NotToStretch</sub></code>.
              </li>
              <li>
                Perform layout without any stretch size constraint on
                all the items of <code>L<sub>NotToStretch</sub></code>.
                If <code>L<sub>ToStretch</sub></code> is empty then stop.
                If <code>L<sub>NotToStretch</sub></code> is empty, perform
                layout with stretch size constraint 0 on
                all the items of <code>L<sub>ToStretch</sub></code>.
              </li>
              <li>
                Calculate the target size <code>T</code> to
                the maximum <a>inline size</a> of the
                <a>margin boxes</a> of child boxes that have been laid out in the
                previous step.
              </li>
              <li>
                Lay out or relayout all the elements of
                <code>L<sub>ToStretch</sub></code>
                with <a>inline stretch size constraint</a> <code>T</code>.
              </li>
            </ol>
          </section>
          <section>
            <h4>Base with underscript</h4>
            <p>
              The <code>&lt;munder&gt;</code> element is laid out as shown on
              <a href="#figure-box-munder"></a>.
              <code>LargeOpItalicCorrection</code>
              is the <a>italic correction</a> of the <a>munder base</a>
              if it is an <a>embellished operator</a> with
              the [=embellished operator/largeop=] property and 0 otherwise.
            </p>
            <figure id="figure-box-munder">
              <img src="figures/munderbox.svg">
              <figcaption>Box model for the <code>&lt;munder&gt;</code> element</figcaption>
            </figure>
            <p>
              The <a>min-content inline size</a> (respectively <a>max-content inline size</a>)
              of the math content are
              calculated like the <a>inline size</a> of the math content below
              but replacing the
              <a>inline sizes</a> of the <a>munder base</a>'s <a>margin box</a> and <a>munder underscript</a>'s <a>margin box</a>
              with the
              <a>min-content inline size</a> (respectively <a>max-content inline size</a>)
              of the <a>munder base</a>'s <a>margin box</a> and <a>munder underscript</a>'s <a>margin box</a>.
            </p>
            <p>
              The <a>in-flow</a> children are laid out
              using the <a>algorithm for stretching operators along the inline axis</a>.
            </p>
            <p>
              The <a>inline size</a> of the math content is
              calculated by determining the absolute difference between:
            </p>
            <ul>
              <li>The maximum of:
                <ul>
                  <li>Half the <a>inline size</a> of the <a>munder base</a>'s <a>margin box</a>.</li>
                  <li>Half the <a>inline size</a> of the <a>munder underscript</a>'s <a>margin box</a> âˆ’
                    half <code>LargeOpItalicCorrection</code>.</li>
                </ul>
              </li>
              <li>The minimum of:
                <ul>
                  <li>âˆ’half the <a>inline size</a> of the <a>munder base</a>'s <a>margin box</a>.</li>
                  <li>âˆ’half the <a>inline size</a> of the <a>munder underscript</a>'s <a>margin box</a> âˆ’
                    half <code>LargeOpItalicCorrection</code>.</li>
                </ul>
              </li>
            </ul>
            <p>
              If m is the minimum calculated in the second item above then the
              <a>inline offset</a>
              of the <a>munder base</a> is âˆ’m âˆ’ half the <a>inline size</a> of the base's <a>margin box</a>.
              The <a>inline offset</a> of the <a>munder underscript</a> is
              âˆ’m âˆ’ half the <a>inline size</a> of the <a>munder underscript</a>'s <a>margin box</a> âˆ’
              half <code>LargeOpItalicCorrection</code>.
            </p>
            <p>
              Parameters
              <code>UnderShift</code> and <code>UnderExtraDescender</code>
              are determined by considering three cases in the following order:
            </p>
            <ol>
              <li>
                <p>
                  The <a>munder base</a> is an
                  <a>embellished operator</a> with the
                  [=embellished operator/largeop=] property.
                  <code>UnderShift</code> is the maximum of
                </p>
                <ul>
                  <li><a>LowerLimitBaselineDropMin</a></li>
                  <li><a>LowerLimitGapMin</a> + the ascent of the
                    <a>munder underscript</a>.</li>
                </ul>
                <p>
                  <code>UnderExtraDescender</code> is 0.
                </p>
              </li>
              <li>
                <p>
                  The <a>munder base</a> is an
                  <a>embellished operator</a> with the
                  [=embellished operator/stretchy=] property
                  and [=embellished operator/stretch axis=] inline.
                  <code>UnderShift</code> is the maximum of:
                </p>
                <ul>
                  <li><a>StretchStackBottomShiftDown</a></li>
                  <li><a>StretchStackGapAboveMin</a> + the ascent of the
                    <a>munder underscript</a>.</li>
                </ul>
                <code>UnderExtraDescender</code> is 0.
              </li>
              <li>
                Otherwise,
                <code>UnderShift</code> is equal to <a>UnderbarVerticalGap</a>
                if the [^munder/accentunder^] attribute is not an
                <a>ASCII case-insensitive</a> match to <code>true</code>
                and to zero otherwise.
                <code>UnderExtraAscender</code> is
                <a>UnderbarExtraDescender</a>.
              </li>
            </ol>
            <p>
              The <a>line-ascent</a> of the math content is the maximum between:
            </p>
            <ul>
              <li>The <a>line-ascent</a> of the <a>munder base</a>'s <a>margin box</a>.</li>
              <li>The <a>line-ascent</a> of the <a>munder underscript</a>'s <a>margin box</a> âˆ’
                <code>UnderShift</code>.</li>
            </ul>
            <p>
              The <a>line-descent</a> of the math content is the maximum between:
            </p>
            <ul>
              <li>The <a>line-descent</a> of the <a>munder base</a>'s <a>margin box</a>.</li>
              <li>The <a>line-descent</a> of the <a>munder underscript</a>'s <a>margin box</a> +
                <code>UnderShift</code> + <code>UnderExtraAscender</code>.</li>
            </ul>
            <p>
              The <a>alphabetic baseline</a> of the <a>munder base</a> is aligned with the <a>alphabetic baseline</a>.
              The <a>alphabetic baseline</a> of the <a>munder underscript</a> is shifted away from the <a>alphabetic baseline</a>
              and towards the <a>line-under</a> by a distance equal to
              the <a>ink line-descent</a> of the <a>munder base</a>'s <a>margin box</a>
              + <code>UnderShift</code>.
            </p>
            <p>
              The <a>math content box</a> is placed within the
              <a>content box</a> so that their block-start edges
              are aligned and the middles of these edges are at the same
              position.
            </p>
          </section>
          <section>
            <h4>Base with overscript</h4>
            <p>
              The <code>&lt;mover&gt;</code> element is laid out as shown on
              <a href="#figure-box-mover"></a>.
              <code>LargeOpItalicCorrection</code>
              is the <a>italic correction</a> of the <a>mover base</a>
              if it is an <a>embellished operator</a> with
              the [=embellished operator/largeop=] property and 0 otherwise.
            </p>
            <figure id="figure-box-mover">
              <img src="figures/moverbox.svg">
              <figcaption>Box model for the <code>&lt;mover&gt;</code> element</figcaption>
            </figure>
            <p>
              The <a>min-content inline size</a> (respectively <a>max-content inline size</a>)
              of the math content are
              calculated like the <a>inline size</a> of the math content
              below but replacing the
              <a>inline sizes</a> of the <a>mover base</a>'s <a>margin box</a> and <a>mover overscript</a>'s <a>margin box</a> with
              the <a>min-content inline size</a> (respectively <a>max-content inline size</a>) of the <a>mover base</a>'s <a>margin box</a> and <a>mover overscript</a>'s <a>margin box</a>.
            </p>
            <p>
              The <a>in-flow</a> children are laid out
              using the <a>algorithm for stretching operators along the inline axis</a>.
            </p>
            <p>
              The <code>TopAccentAttachment</code> is the
              <a>top accent attachment</a> of the <a>mover overscript</a> or
              half the <a>inline size</a> of the <a>mover overscript</a>'s <a>margin box</a>
              if it is undefined.
            </p>
            <p>
              The <a>inline size</a> of the math content is
              calculated by
              applying the <a>algorithm for stretching operators along the inline axis</a> for
              layout and determining the absolute difference between:
            </p>
            <ul>
              <li>The maximum of:
                <ul>
                  <li>Half the <a>inline size</a> of the <a>mover base</a>'s <a>margin box</a>.</li>
                  <li>The <a>inline size</a> of the <a>mover overscript</a>'s <a>margin box</a>
                    âˆ’ <code>TopAccentAttachment</code> +
                    half <code>LargeOpItalicCorrection</code>.</li>
                </ul>
              </li>
              <li>The minimum of:
                <ul>
                  <li>âˆ’half the <a>inline size</a> of the <a>mover base</a>'s <a>margin box</a>.</li>
                  <li>âˆ’<code>TopAccentAttachment</code> +
                    half <code>LargeOpItalicCorrection</code>.</li>
                </ul>
              </li>
            </ul>
            <p>
              If m is the minimum calculated in the second item above then the
              <a>inline offset</a>
              of the <a>mover base</a> is âˆ’m âˆ’ half the <a>inline size</a> of the base's margin.
              The <a>inline offset</a> of the <a>mover overscript</a> is
              âˆ’m âˆ’ half the <a>inline size</a> of the <a>mover overscript</a>'s <a>margin box</a> +
              half <code>LargeOpItalicCorrection</code>.
            </p>
            <p>
              Parameters
              <code>OverShift</code> and <code>OverExtraDescender</code>
              are determined by considering three cases in the following order:
            </p>
            <ol>
              <li>
                <p>
                  The <a>mover base</a> is an
                  <a>embellished operator</a> with the
                  [=embellished operator/largeop=] property.
                  <code>OverShift</code> is the maximum of
                </p>
                <ul>
                  <li><a>UpperLimitBaselineRiseMin</a></li>
                  <li><a>UpperLimitGapMin</a> + the descent of the
                    <a>mover overscript</a>.</li>
                </ul>
                <p>
                  <code>OverExtraAscender</code> is 0.
                </p>
	      </li>
              <li>
                <p>
                  The <a>mover base</a> is an
                  <a>embellished operator</a> with the
                  [=embellished operator/stretchy=] property and
                  [=embellished operator/stretch axis=] inline.
                  <code>OverShift</code> is the maximum of:
                </p>
                <ul>
                  <li><a>StretchStackTopShiftUp</a></li>
                  <li><a>StretchStackGapBelowMin</a> + the descent of the
                    <a>mover overscript</a>.</li>
                </ul>
                <code>OverExtraDescender</code> is 0.
              </li>
              <li>
                <p>
                  Otherwise, <code>OverShift</code> is equal to</p>
                <ol>
                  <li><a>OverbarVerticalGap</a> if the
                    [^mover/accent^] attribute is not an
                    <a>ASCII case-insensitive</a> match to <code>true</code>.</li>
                  <li>Or <a>AccentBaseHeight</a> minus the <a>line-ascent</a>
                    of the <a>mover base</a>'s <a>margin box</a>
                    if this difference is nonnegative.</li>
                  <li>Or 0 otherwise.</li>
                </ol>
                <p>
                  <code>OverExtraAscender</code> is <a>OverbarExtraAscender</a>.
                </p>
              </li>
            </ol>
            <div class="note">
              For accent overscripts and bases with <a>line-ascents</a> that are at
              most
              <a>AccentBaseHeight</a>, the rule from
              [[OPEN-FONT-FORMAT]] [[?TEXBOOK]] is actually to align the
              <a>alphabetic baselines</a> of the overscripts and of the bases. This assumes that
              accent glyphs are designed in such a way that their ink bottoms
              are
              more or less <a>AccentBaseHeight</a> above their <a>alphabetic baselines</a>. Hence,
              the previous rule will guarantee that all the overscript bottoms
              are aligned while still avoiding collision with the bases.
              However, MathML can have arbitrary accent overscripts, so
              a more general and simpler rule is provided above: Ensure
              that the bottom of overscript is at least
              <a>AccentBaseHeight</a> above the <a>alphabetic baseline</a> of the base.
            </div>
            <p>
              The <a>line-ascent</a> of the math content is the maximum between:
            </p>
            <ul>
              <li>The <a>line-ascent</a> of the <a>mover base</a>'s <a>margin box</a>.</li>
              <li>The <a>line-ascent</a> of the <a>mover overscript</a>'s <a>margin box</a> +
                <code>OverShift</code> + <code>OverExtraAscender</code>.</li>
            </ul>
            <p>
              The <a>line-descent</a> of the math content is the maximum between:
            </p>
            <ul>
              <li>The <a>line-descent</a> of the <a>mover base</a>'s <a>margin box</a>.</li>
              <li>The <a>line-descent</a> of the <a>mover overscript</a>'s <a>margin box</a> âˆ’
                <code>OverShift</code>.</li>
            </ul>
            <p>
              The <a>alphabetic baseline</a> of the <a>mover base</a> is aligned with the <a>alphabetic baseline</a>.
              The <a>alphabetic baseline</a> of the <a>mover overscript</a> is shifted away from the <a>alphabetic baseline</a>
              and towards the <a>line-over</a> by a distance equal to
              the <a>ink line-ascent</a> of the base + <code>OverShift</code>.
            </p>
            <p>
              The <a>math content box</a> is placed within the
              <a>content box</a> so that their block-start edges
              are aligned and the middles of these edges are at the same
              position.
            </p>
          </section>
          <section>
            <h4>Base with underscript and overscript</h4>
            <p>
              The general layout of <code>&lt;munderover&gt;</code> is shown on
              <a href="#figure-box-munderover"></a>. The
              <code>LargeOpItalicCorrection</code>,
              <code>UnderShift</code>,
              <code>UnderExtraDescender</code>,
              <code>OverShift</code>,
              <code>OverExtraDescender</code> parameters
              are calculated the same as in
              <a href="#base-with-underscript"></a> and
              <a href="#base-with-overscript"></a>.
            </p>
            <figure id="figure-box-munderover">
            <img src="figures/munderoverbox.svg">
            <figcaption>Box model for the <code>&lt;munderover&gt;</code> element</figcaption>
            </figure>
            <p>
              The <a>min-content inline size</a>, <a>max-content inline size</a>
              and <a>inline size</a> of the math content
              are calculated as an absolute difference
              between a maximum <a>inline offset</a> and minimum <a>inline offset</a>.
              These extrema are calculated by taking the extremum value
              of the corresponding extrema calculated in
              <a href="#base-with-underscript"></a> and
              <a href="#base-with-overscript"></a>.
              The <a>inline offsets</a> of the <a>munderover base</a>,
              <a>munderover underscript</a> and
              <a>munderover overscript</a>
              are calculated as in these sections but using
              the new minimum m (minimum of the corresponding minima).
            </p>
            <p>
              Like in these sections, the <a>in-flow</a> children are laid out
              using the <a>algorithm for stretching operators along the inline axis</a>.
            </p>
            <p>
              The <a>line-ascent</a> and <a>line-descent</a> of the math content
              are also calculated by taking the extremum value
              of the extrema calculated in
              <a href="#base-with-underscript"></a> and
              <a href="#base-with-overscript"></a>.
            </p>
            <p>
              Finally, the <a>alphabetic baselines</a> of the
              <a>munderover base</a>,
              <a>munderover underscript</a> and
              <a>munderover overscript</a>
              are calculated as in sections
              <a href="#base-with-underscript"></a> and
              <a href="#base-with-overscript"></a>.
            </p>
            <p>
              The <a>math content box</a> is placed within the
              <a>content box</a> so that their block-start edges
              are aligned and the middles of these edges are at the same
              position.
            </p>
            <div class="note">
              <p>
                When the underscript (respectively overscript) is an empty
                box, the base and overscript (respectively underscript) are laid
                out similarly to
                <a href="#base-with-overscript"></a>
                (respectively <a href="#base-with-underscript"></a>)
                but the position of the empty underscript (respectively
                overscript) may add extra space.
                In order to keep the algorithm simple, no attempt is made to
                handle empty scripts in a special way.
              </p>
            </div>
          </section>
        </section>
        <section id="prescripts-and-tensor-indices-mmultiscripts">
          <h4>Prescripts and Tensor Indices <code>&lt;mmultiscripts&gt;</code></h4>
          <p>
            Presubscripts and tensor notations are represented by
            the <dfn class="element">mmultiscripts</dfn> element.
            The <dfn class="element">mprescripts</dfn> element is
            used as a separator between the postscripts and prescripts.
            These two elements accept the attributes described in
            <a href="#global-attributes"></a>.
          </p>
          <div class="example" id="mmultiscripts-example">
            <p>
              The following example shows basic use of prescripts
              and postscripts, involving a [^mprescripts^].
	      Empty [^mrow^] elements are used at positions where
              no scripts are rendered.
              The font-size is automatically scaled down within the scripts.
            </p>
            <pre data-include="examples/example-mmultiscripts.html"
                 data-include-format="text"></pre>
            <img src="examples/example-mmultiscripts.png" alt="mmultiscripts example">
          </div>
          <p>
            If the
            <code>&lt;mmultiscripts&gt;</code> or
            <code>&lt;mprescripts&gt;</code>
            elements do not have their
            computed
            [^math/display^] property equal to <code>block math</code>
            or <code>inline math</code>
            then they are laid out according to the CSS specification where
            the corresponding value is described.
            Otherwise, the layout below is performed.
          </p>
          <p>
            The
            <code>&lt;mprescripts&gt;</code>
            element is laid out as an [^mrow^]
            element.
          </p>
          <p>
            A valid <code>&lt;mmultiscripts&gt;</code> element contains the
            following <a>in-flow</a> children:
          </p>
          <ul>
            <li>
              A first <a>in-flow</a> child, called the
              <dfn>mmultiscripts base</dfn>, that is not an
              [^mprescripts^] element.
            </li>
            <li>
              Followed by an even number of <a>in-flow</a> children called
              <dfn>mmultiscripts postscripts</dfn>, none of them being a
              [^mprescripts^] element.
              These scripts form a (possibly empty) list
              subscript, superscript, subscript, superscript,
              subscript, superscript, etc.
              Each consecutive couple of children subscript, superscript
              is called a
              <dfn>subscript/superscript pair</dfn>.
            </li>
            <li>Optionally followed by
              an [^mprescripts^] element and
              an even number of <a>in-flow</a> children called
              <dfn>mmultiscripts prescripts</dfn>, none of them being a
              [^mprescripts^] element.
              These scripts form a (possibly empty) list of
              <a>subscript/superscript pair</a>.
            </li>
          </ul>
          <p>
            If an <code>&lt;mmultiscripts&gt;</code> element is not valid then
            it is laid out the same as the
            [^mrow^] element.
            Otherwise the layout algorithm is performed as in
            <a href="#base-with-prescripts-and-postscripts"></a>.
          </p>
          <section>
            <h5 id="base-with-prescripts-and-postscripts">Base with prescripts and postscripts</h5>
            <p>
              The <code>&lt;mmultiscripts&gt;</code> element is laid out as
              shown on <a href="#figure-box-mmultiscripts"></a>.
              For each <a>subscript/superscript pair</a> of
              <a>mmultiscripts postscripts</a>,
              the <code>ItalicCorrection</code>
              <code>LargeOpItalicCorrection</code> are defined as
              in <a href="#base-with-subscript"></a>
              and <a href="#base-with-superscript"></a>.
            </p>
            <figure id="figure-box-mmultiscripts">
              <img src="figures/mmultiscriptsbox.svg">
              <figcaption>Box model for the <code>&lt;mmultiscripts&gt;</code> element</figcaption>
            </figure>
            <p>
              The
              <a>min-content inline size</a> (respectively <a>max-content inline size</a>)
              of the math content is
              calculated the same as the <a>inline size</a> of the math content
              below, but replacing
              "<a>inline size</a>" with "<a>min-content inline size</a>"
              (respectively "<a>max-content inline size</a>") for the
              <a>mmultiscripts base</a>'s
              <a>margin box</a> and scripts' <a>margin boxes</a>.
            </p>
            <p>
              If there is an <a>inline stretch size constraint</a> or a
              <a>block stretch size constraint</a>
              the <a>mmultiscripts base</a>
              is also laid out with the same stretch size constraint.
              Otherwise it is laid out without any stretch
              size constraint. The other elements are always laid out without
              any stretch size constraint.
            </p>
            <p>
              The <a>inline size</a> of the math content
              is calculated with the following algorithm:
            </p>
            <ol class="algorithm">
              <li>Set <code>inline-offset</code> to 0.</li>
              <li>
                <p>
                  For each <a>subscript/superscript pair</a> of
                  <a>mmultiscripts prescripts</a>, increment
                  <code>inline-offset</code> by <a>SpaceAfterScript</a> + the
                  maximum of
                </p>
                <ul>
                  <li>The <a>inline size</a> of the subscript's <a>margin box</a>.</li>
                  <li>The inline size of the superscript's <a>margin box</a>.</li>
                </ul>
              </li>
              <li>
                Increment <code>inline-offset</code> by the <a>inline size</a> of the
                <a>mmultiscripts base</a>'s <a>margin box</a> and
                set <code>inline-size</code> to <code>inline-offset</code>.
              </li>
              <li>
                <p>
                  For each <a>subscript/superscript pair</a> of
                  <a>mmultiscripts postscripts</a>, modify
                  <code>inline-size</code> to be at least:
                </p>
                <ul>
                  <li>
                    x + the <a>inline size</a> of the subscript's <a>margin box</a> +
                    <code>LargeOpItalicCorrection</code>.
                  </li>
                  <li>
                    x + the <a>inline size</a> of the superscript's <a>margin box</a> âˆ’
                    <code>ItalicCorrection</code>.
                  </li>
                </ul>
                <p>Increment <code>inline-offset</code> to the maximum of:</p>
                <ul>
                  <li>
                    the <a>inline size</a> of the subscript's <a>margin box</a>.
                  </li>
                  <li>
                    the <a>inline size</a> of the superscript's <a>margin box</a>.
                  </li>
                </ul>
                <p>
                  Increment <code>inline-offset</code> by
                  <a>SpaceAfterScript</a>.
                </p>
              </li>
              <li>Return <code>inline-size</code>.</li>
            </ol>
            <p>
              <code>SubShift</code> (respectively <code>SuperShift</code>)
              is calculated by taking the maximum of all subshifts
              (respectively supershifts) of each
              <a>subscript/superscript pair</a> as described in
              <a href="#base-with-subscript-and-superscript"></a>.
            </p>
            <p>
              The <a>line-ascent</a> of the math content is calculated
              by taking the maximum of all the <a>line-ascent</a>
              of each <a>subscript/superscript pair</a> as described in
              <a href="#base-with-subscript-and-superscript"></a>
              but using the <code>SubShift</code> and
              <code>SuperShift</code> values calculated above.
            </p>
            <p>
              The <a>line-descent</a> of the math content is calculated
              by taking the maximum of all the <a>line-descent</a>
              of each <a>subscript/superscript pair</a> as described in
              <a href="#base-with-subscript-and-superscript"></a>
              but using the <code>SubShift</code> and
              <code>SuperShift</code> values calculated above.
            </p>
            <p>
              Finally, the placement of the <a>in-flow</a> children is performed using
              the
              following algorithm:
            </p>
            <ol class="algorithm">
              <li>Set <code>inline-offset</code> to 0.</li>
              <li>
                <p>For each <a>subscript/superscript pair</a> of
                  <a>mmultiscripts prescripts</a>:</p>
                <ol>
                  <li>
                    Increment <code>inline-offset</code> by
                    <a>SpaceAfterScript</a>.
                  </li>
                  <li>
                    Set <code>pair-inline-size</code> to the maximum of
                    <ul>
                      <li>
                        the <a>inline size</a> of the subscript's <a>margin box</a>.
                      </li>
                      <li>
                        the <a>inline size</a> of the superscript's <a>margin box</a>.
                      </li>
                    </ul>
                  </li>
                  <li>
                    Place the subscript at inline-start position
                    <code>inline-offset</code> + <code>pair-inline-size</code>
                    âˆ’ the <a>inline size</a> of the subscript's <a>margin box</a>.
                  </li>
                  <li>
                    Place the superscript at inline-start position
                    <code>inline-offset</code> + <code>pair-inline-size</code>
                    âˆ’ the <a>inline size</a> of the superscript's <a>margin box</a>.
                  </li>
                  <li>
                    Place the subscript (respectively superscript) so its
                    <a>alphabetic baseline</a> is
                    shifted away from the <a>alphabetic baseline</a> by
                    <code>SubShift</code> (respectively <code>SuperShift</code>)
                    towards the <a>line-under</a> (respectively <a>line-over</a>).
                  </li>
                  <li>
                    Increment <code>inline-offset</code> by
                    <code>pair-inline-size</code>.
                  </li>
                </ol>
	      </li>
              <li>
                Place the <a>mmultiscripts base</a>
                and <code>&lt;mprescripts&gt;</code> boxes
                at <a>inline offsets</a>
                <code>inline-offset</code> and with their <a>alphabetic baselines</a>
                aligned with the <a>alphabetic baseline</a>.
              </li>
              <li>
                <p>
                  For each <a>subscript/superscript pair</a> of
                  <a>mmultiscripts postscripts</a>:
                </p>
                <ol>
                  <li>
                    Set <code>pair-inline-size</code> to the maximum of
                    <ul>
                      <li>
                        the <a>inline size</a> of the subscript's <a>margin box</a>.
                      </li>
                      <li>
                        the <a>inline size</a> of the superscript's <a>margin box</a>.
                      </li>
                    </ul>
                  </li>
                  <li>
                    Place the subscript
                    at inline-start position <code>inline-offset</code>
                    âˆ’ <code>LargeOpItalicCorrection</code>.
                  </li>
                  <li>
                    Place the superscript
                    at inline-start position <code>inline-offset</code>
                    + <code>ItalicCorrection</code>.
                  </li>
                  <li>
                    Place the subscript (superscript) so its <a>alphabetic baseline</a> is
                    shifted away from the <a>alphabetic baseline</a> by
                    <code>SubShift</code> (respectively <code>SuperShift</code>)
                    towards the <a>line-under</a> (respectively <a>line-over</a>).
                  </li>
                  <li>
                    Increment <code>inline-offset</code> by
                    <code>pair-inline-size</code>.
                  </li>
                  <li>
                    Increment <code>inline-offset</code> by
                    <a>SpaceAfterScript</a>.
                  </li>
                </ol>
              </li>
            </ol>
            <div class="note">
              <p>
                An <code>&lt;mmultiscripts&gt;</code> with only one
                <a>subscript/superscript pair</a> of
                <a>mmultiscripts postscripts</a> is laid out the same as a
                <code>&lt;msubsup&gt;</code> with the same <a>in-flow</a> children.
                However, as
                <a href="#msubsup-with-empty-scripts">noticed for
                  <code>&lt;msubsup&gt;</code></a>,
                if additionally the subscript (respectively superscript) is an
                empty box then it is not necessarily laid out the same as an
                <code>&lt;msub&gt;</code>
                (respectively <code>&lt;msup&gt;</code>) element.
                In order to keep the algorithm simple, no attempt is made to
                handle empty scripts in a special
                way.
              </p>
            </div>
          </section>
        </section>
        <section id="displaystyle-and-scriptlevel-in-scripts">
          <h4>Displaystyle, scriptlevel and math-shift in scripts</h4>
          <p>
            For all <a>scripted elements</a>, the rule of thumb is to set
            <a><code>displaystyle</code></a> to <code>false</code> and
            to increment <a><code>scriptlevel</code></a> in all child
            elements but the first one.
            However, an [^mover^] (respectively
            [^munderover^])
            element with an [^mover/accent^]
            attribute that is an
            <a>ASCII case-insensitive</a>
            match to <code>true</code> does not increment scriptlevel within
            its second child (respectively third child). Similarly,
            [^mover^] and
            [^munderover^] elements
            with an [^mover/accentunder^]
            attribute that is an
            <a>ASCII case-insensitive</a>
            match to <code>true</code> do not increment scriptlevel within
            their second child.
          </p>
          <p><code>&lt;mmultiscripts&gt;</code> sets
            <a><code>math-shift</code></a> to
            <code>compact</code> on its children at even position if they are
            before an [^mprescripts^], and on those at odd position
            if they are after
            an [^mprescripts^].
            The <code>&lt;msub&gt;</code> and <code>&lt;msubsup&gt;</code>
            elements set <a><code>math-shift</code></a> to
            <code>compact</code> on their second child.
            [^mover^] and
            [^munderover^]
            elements with an [^mover/accent^]
            attribute that is an
            <a>ASCII case-insensitive</a>
            match to <code>true</code> also set <a><code>math-shift</code></a> to
            <code>compact</code> within their first child.
          </p>
          <p>
            The
            <a href="#user-agent-stylesheet"></a> must contain the following
            style in order to implement this behavior:
          </p>
          <pre class="css" data-include="user-agent-stylesheet/scripts.css"></pre>
          <div class="note" id="scripted-elements-css-rules-on-children">
            In practice, all the children of the MathML elements described in
            this section are <a>in-flow</a> and the
            <code>&lt;mprescripts&gt;</code> is empty.
            Hence the CSS rules essentially perform automatic <a><code>displaystyle</code></a> and
            <a><code>scriptlevel</code></a> changes for the scripts; and
            <a><code>math-shift</code></a> changes for
            subscripts and sometimes the base.
          </div>
        </section>
      </section>
      <section id="tabular-math">
        <h3>Tabular Math</h3>
        <p>
          Matrices, arrays and other table-like mathematical notation are marked up
          using
          [^mtable^]
          [^mtr^]
          [^mtd^]
          elements.  These  elements are similar to the
          [^table^],
          [^tr^]
          and
          [^td^]
          elements of [[HTML]].
        </p>
        <div class="example" id="tables-example">
          <p>
            The following example shows how tabular layout allows to write a
            matrix. Note that it is vertically centered with the fraction
            bar and the middle of the equal sign.
          </p>
          <pre data-include="examples/example-tables.html"
               data-include-format="text"></pre>
          <img src="examples/example-tables.png" alt="tables example">
        </div>
        <section id="table-or-matrix-mtable">
          <h4>Table or Matrix <code>&lt;mtable&gt;</code></h4>
          <p>The <dfn class="element">mtable</dfn> is laid out as an
            <code>inline-table</code> and sets
            <code>displaystyle</code> to <code>false</code>. The
            <a>user agent stylesheet</a> must contain
            the following rules in order to implement these properties:
          </p>
          <pre data-include="user-agent-stylesheet/mtable.css"></pre>
          <p>
            The <code>mtable</code> element is as a CSS
            <a data-xref-type="css-value" data-xref-for="display">table</a>
            and the
            <a>min-content inline size</a>, <a>max-content inline size</a>,
            <a>inline size</a>, <a>block size</a>,
            <a>first baseline set</a> and <a>last baseline set</a>
            sets are determined
            accordingly.
            The center of the table is aligned with the <a>math axis</a>.
          </p>
          <p>
            The <code>&lt;mtable&gt;</code> accepts the attributes described
            in <a href="#global-attributes"></a>.
          </p>
        </section>
        <section>
          <h4>Row in Table or Matrix <code>&lt;mtr&gt;</code></h4>
          <p>
            The <dfn class="element">mtr</dfn> is laid out as
            <code>table-row</code>. The
            <a>user agent stylesheet</a> must contain
            the following rules in order to implement that behavior:
          </p>
          <pre data-include="user-agent-stylesheet/mtr.css"></pre>
          <p>
            The <code>&lt;mtr&gt;</code> accepts the attributes described
            in <a href="#global-attributes"></a>.
          </p>
        </section>
        <section>
          <h4>Entry in Table or Matrix <code>&lt;mtd&gt;</code></h4>
          <p>
            The <dfn class="element">mtd</dfn> is laid out as
            a <code>table-cell</code> with content centered in the cell and
            a default padding. The
            <a>user agent stylesheet</a> must contain
            the following rules:
          </p>
          <pre data-include="user-agent-stylesheet/mtd.css"></pre>
          <p>
            The <code>&lt;mtd&gt;</code> accepts the attributes described
            in <a href="#global-attributes"></a> as well as the following attributes:
          </p>
          <ul id="mtd-attributes">
            <li><a>colspan</a></li>
            <li><a>rowspan</a></li>
          </ul>
          <p>
            The <dfn><code>colspan</code></dfn> (respectively
            <dfn><code>rowspan</code></dfn>) attribute has the same
            syntax and semantics as the
            [^td/colspan^]
            (respectively
            [^td/rowspan^])
            attribute on the <code>&lt;td&gt;</code> element from [[HTML]].
            In particular, the parsing of these attributes is handled as
            described in the
            <a data-cite="HTML/../#algorithm-for-processing-rows">algorithm for processing rows</a>.
          </p>
          <div class="note">
            The name of the column spanning attribute in [[MathML3]] and earlier
            versions was <code>columnspan</code>. For consistency with [[HTML]],
            this specification uses <code>colspan</code> instead.
          </div>
          <p>
            The <code>&lt;mtd&gt;</code> element
            <a>generates an anonymous &lt;mrow&gt; box</a>.
          </p>
        </section>
      </section>
      <section id="enlivening-expressions">
        <h3>Enlivening Expressions</h3>
        <p>
          Historically, the
          <dfn class="element">maction</dfn>
          element provides a mechanism
          for binding actions to expressions.
        </p>
        <p>
          The <code>&lt;maction&gt;</code> element accepts the attributes described
          in <a href="#global-attributes"></a> as well as the following
          attributes:
        </p>
        <ul id="legacy-maction-attributes">
          <li>[^maction/actiontype^]</li>
          <li>[^maction/selection^]</li>
        </ul>
        <p>
          This specification does not define any observable behavior
          that is specific to the <dfn data-dfn-for="maction" class="element-attr">actiontype</dfn> and <dfn data-dfn-for="maction" class="element-attr">selection</dfn>
          attributes.
        </p>
        <div class="example" id="maction-example">
          <p>
            The following example shows the "toggle" action type from
            [[MathML3]]
            where the renderer alternately displays the selected subexpression,
            starting from "one third" and cycling through them when there is a
            click on the selected subexpression ("one quarter", "one half",
            "one third", etc). This is not part of MathML Core but can be
            implemented using JavaScript and CSS polyfills. The default behavior
            is just to render the first child.
          </p>
          <pre data-include="examples/example-maction.html"
               data-include-format="text"></pre>
          <img src="examples/example-maction.png" alt="maction example">
        </div>
        <p>
          The layout algorithm of the <code>&lt;maction&gt;</code> element
          is the same as the <code>&lt;mrow&gt;</code> element.
          The <a>user agent stylesheet</a>
          must contain the following rules in order to hide all but
          its first child element,
          which is the default behavior for the legacy actiontype
          values:
        </p>
        <pre class="css" data-include="user-agent-stylesheet/maction.css"></pre>
        <div class="note">
	  <code>&lt;maction&gt;</code> is implemented for compatibility with full MathML. Authors whose only target is MathML Core are encouraged to use other HTML, CSS and JavaScript mechanisms to implement custom actions. They may
          rely on maction attributes defined in [[MathML3]].
        </div>
      </section>
      <section id="semantics-and-presentation">
        <h3>Semantics and Presentation</h3>
        <p>
          The
          <dfn class="element">semantics</dfn>
          element is the container element that associates
          annotations with a MathML expression. Typically, the
          <code>&lt;semantics&gt;</code> element has as its first child element
          a MathML expression to be annotated while subsequent child elements
          represent
          text annotations within an <dfn class="element">annotation</dfn>
          element, or more complex markup annotations within
          an <dfn class="element">annotation-xml</dfn> element.
        </p>
        <div class="example" id="semantics-example">
          <p>
            The following example shows how the fraction "one half" can be
            annotated with a textual annotation (LaTeX) or an XML annotation
            (content MathML). These annotations are not intended to be rendered
            by the user agent.
          </p>
          <pre data-include="examples/example-semantics.html"
               data-include-format="text"></pre>
          <img src="examples/example-semantics.png" alt="semantics example">
        </div>
        <p>
          The <code>&lt;semantics&gt;</code> element accepts the attributes
          described in <a href="#global-attributes"></a>. Its layout algorithm
          is the same as the [^mrow^] element.
          The <a>user agent stylesheet</a>
          must contain the following rule in order to only render the annotated
          MathML expression:
        </p>
        <pre data-include="user-agent-stylesheet/semantics.css"></pre>
        <p>
          The <code>&lt;annotation-xml&gt;</code> and
          <code>&lt;annotation&gt;</code> element accepts the attributes
          described in <a href="#global-attributes"></a> as well as the
          following attribute:
        </p>
        <ul>
          <li>[^annotation/encoding^]</li>
        </ul>
        <p>
          This specification does not define any observable behavior that is
          specific to the <dfn data-dfn-for="annotation,annotation-xml" class="element-attr">encoding</dfn> attribute.
        </p>
        <p>
          The layout algorithm of the <code>&lt;annotation-xml&gt;</code>
          and <code>&lt;annotation&gt;</code>
          element is the same as the [^mtext^] element.
        </p>
        <div class="note">
          Authors can use the [^annotation/encoding^] attribute to distinguish
          annotations
          for <a data-cite="HTML/../#html-integration-point">HTML integration point</a>,
          clipboard copy, alternative rendering, etc.
          In particular, CSS can be used to render alternative annotations, e.g.
          <pre class="css">
            /* Hide the annotated child. */
            semantics > :first-child { display: none; }
             /* Show all text annotations. */
            semantics > annotation { display: inline; }
            /* Show all HTML annotations. */
            semantics > annotation-xml[encoding="text/html" i],
            semantics > annotation-xml[encoding="application/xhtml+xml" i] {
              display: inline-block;
            }
          </pre>
        </div>
      </section>
    </section>
    <section class="normative">
      <h2>CSS Extensions for Math Layout</h2>
      <section id="new-display-math-value">
        <h3>The <code>display: block math</code>
          and <code>display: inline math</code> value</h3>
        <p>The <code>display</code> property
          from <a data-cite="CSS-DISPLAY-3"></a>
          is extended with a new inner display type:
        </p>
        <table class="def propdef partial" data-link-for-hint="display">
          <tbody>
            <tr>
              <th>Name:</th>
              <td><a class="css" data-xref-type="css-property">display</a></td>
            </tr>
            <tr class="value">
              <th><a data-cite="CSS-VALUES-4#value-defs">New values:</a></th>
              <td class="prod"><a data-xref-type="css-type" href="https://www.w3.org/TR/css-display-3/#typedef-display-outside">&lt;display-outside&gt;</a> <a data-cite="CSS-VALUES-4#comb-any">||</a> [ <a data-xref-type="css-type" href="https://www.w3.org/TR/css-display-3/#typedef-display-inside">&lt;display-inside&gt;</a> <a data-cite="CSS-VALUES-4#comb-one">|</a> math ]</td>
            </tr>
          </tbody>
        </table>
        <p>
          For elements that are not <a>MathML elements</a>, if the specified
          value of <code>display</code> is <code>inline math</code> or
          <code>block math</code> then the computed value is
          <code>block flow</code> and <code>inline flow</code> respectively.
          For the [^mtable^] element
          the computed value is <code>block table</code> and
          <code>inline table</code> respectively.
          For the [^mtr^] element, the computed value
          is <code>table-row</code>.
          For the [^mtd^] element, the computed value
          is <code>table-cell</code>.
        </p>
        <p>
          <a>MathML elements</a> with a
          computed <code>display</code> value equal to
          <code>block math</code> or <code>inline math</code>
          control box generation and layout according to their tag name, as
          described in the relevant sections.
          <a>Unknown MathML elements</a>
          behave the same as the [^mrow^] element.
        </p>
        <div class="note">
          The <code>display: block math</code> and
          <code>display: inline math</code> values provide a default
          layout for MathML elements while at the same time allowing
          to override it with either native display values or
          <a data-cite="CSS-LAYOUT-API-1#registering-layout">custom values</a>.
          This allows authors or polyfills to define their own custom notations
          to tweak or extend MathML Core.
        </div>
        <div class="example" id="display-example">
          <p>
            In the following example, the default layout of the
            MathML [^mrow^] element is overridden to render its
            content as a grid.
          </p>
          <pre data-include="examples/example-display.html"
               data-include-format="text"></pre>
          <img src="examples/example-display.png" alt="display example">
        </div>
      </section>
      <section id="new-text-transform-values">
        <h3>New <code>text-transform</code> value</h3>
        <p>The <a data-xref-type="css-property">text-transform</a> property
          from <a data-cite="CSS-TEXT-3"></a>
          is extended with a new value:
        </p>
        <table class="def propdef partial" data-link-for-hint="text-transform">
          <tbody>
            <tr>
              <th>Name:</th>
              <td><a class="css" data-xref-type="css-property" id="ref-for-propdef-text-transform">text-transform</a>
              </td>
            </tr>
            <tr class="value">
              <th><a data-cite="CSS-VALUES-4#value-defs">New value:</a></th>
              <td class="prod">math-auto</td>
            </tr>
          </tbody>
        </table>
        <p>
          On text nodes containing a single character, if the computed value
          is <code>math-auto</code> then the transformed text is obtained by
          performing conversion of each character according to the
          <a href="#italic-mappings">italic</a> table.
        </p>
        <div class="example" id="text-transform-example">
          <p>A common style convention is to render
            identifiers with multiple letters (e.g. the function name "exp")
            with normal style and identifiers with a single letter
            (e.g. the variable "n") with italic style. The
            <code>math-auto</code> property is intended to implement this
            default behavior, which can be overridden by authors if necessary.
            Note that mathematical fonts are designed with a special kind
            of italic glyphs located at the
            Unicode positions of
            <a href="#italic-mappings"></a>, which  differ from the shaping
            obtained via italic font style. Compare this
            mathematical formula
            rendered with the Latin Modern Math font using
            <code>font-style: italic</code> (left) and
            <code>text-transform: math-auto</code> (right):
          </p>
          <img src="examples/example-text-transform-math-auto.png" alt="font-style: italic VS text-transform: math-auto">
        </div>
      </section>
      <section id="the-math-style-property">
        <h3>The <code>math-style</code> property</h3>
        <table class="def propdef" data-link-for-hint="math-style">
          <tbody>
            <tr>
              <th>Name:</th>
              <td>
                <dfn class="dfn-paneled css" data-dfn-type="property" data-export id="propdef-math-style">math-style</dfn>
              </td>
            </tr>
            <tr class="value">
              <th><a data-cite="CSS-VALUES-4#value-defs">Value:</a></th>
              <td class="prod">normal <a data-link-type="grammar" data-cite="CSS-VALUES-4#comb-one">|</a> compact</td>
            </tr>
            <tr>
              <th><a data-cite="CSS-CASCADE-4#initial-values">Initial:</a></th>
              <td>normal</td>
            </tr>
            <tr>
              <th><a data-cite="CSS-CASCADE-4#applies-to">Applies to:</a></th>
              <td>All elements</td>
            </tr>
            <tr>
              <th><a data-cite="CSS-CASCADE-4#inherited-property">Inherited:</a></th>
              <td>yes</td>
            </tr>
            <tr><th><a href="https://www.w3.org/TR/css-values/#percentages">Percentages:</a></th><td>n/a</td></tr>
            <tr>
              <th><a data-cite="CSS-CASCADE-4#computed">Computed value:</a></th>
              <td>specified keyword</td>
            </tr>
            <tr>
              <th><a href="https://www.w3.org/TR/cssom/#serializing-css-values">Canonical order:</a></th>
              <td>n/a</td>
            </tr>
            <tr>
              <th><a href="https://www.w3.org/TR/web-animations/#animation-type">Animation type:</a></th>
              <td>not animatable</td>
            </tr>
            <tr>
              <th>Media:</th>
              <td>visual</td>
            </tr>
          </tbody>
        </table>
        <p>
          When <code>math-style</code> is <code>compact</code>,
          the math layout on descendants tries to minimize the
          <a>logical height</a> by
          applying the following rules:
        </p>
        <ul>
          <li>The <a data-xref-type="css-property">font-size</a> is scaled down when
            its specified value is <code>math</code> and
            the computed value of <a><code>math-depth</code></a> is
            <code>auto-add</code> (default for [^mfrac^])
            as described in <a href="#the-math-script-level-property"></a>.</li>
          <li>Operators with the [=embellished operator/largeop=] property
            do not follow rules from <a href="#layout-of-operators"></a>
            to make them bigger.</li>
          <li>Under-/overscripts attached to an operator with
            the [=embellished operator/movablelimits=] property are actually drawn as sub-/superscripts
            as described in <a href="#children-of-munder-mover-munderover"></a>.</li>
          <li>Smaller vertical gaps and shifts from the <a href="#opentype-math-table">OpenType MATH table</a> are used for fractions and radicals,
            as described in
            <a href="#fraction-with-nonzero-line-thickness"></a>,
            <a href="#fraction-with-zero-line-thickness"></a> and
            <a href="#radical-symbol"></a>.</li>
        </ul>
          <div class="example" id="math-style-example">
            <p>The following example shows a
              mathematical formula rendered with
              its [^math^] root styled with
              <code>math-style: compact</code> (left) and
              <code>math-style: normal</code> (right).
              In the former case, the font-size is automatically scaled down
              within the fractions and the summation limits are rendered as
              subscript and superscript of the âˆ‘. In the latter case, the âˆ‘ is
              drawn bigger than normal text and
              vertical gaps within fractions (even relative to current
              font-size) are larger.
            </p>
            <img src="examples/example-math-style.png" alt="math-style example">
            <p>These two <code>math-style</code> values typically correspond to
              mathematical expressions in inline and display
              mode respectively [[TeXBook]].
              A mathematical formula in display mode
              may automatically switch to inline mode within some subformulas
              (e.g. scripts, matrix elements, numerators and denominators, etc)
              and it is sometimes desirable to override this default behavior.
              The <a>math-style</a> property allows to easily implement these
              features for MathML in the
              <a>user agent stylesheet</a>
              and with the <a>displaystyle</a> attribute; and also exposes
              them to polyfills.
            </p>
          </div>
      </section>
      <section id="the-math-shift">
        <h3>The <code>math-shift</code> property</h3>
        <table class="def propdef" data-link-for-hint="math-shift">
          <tbody>
            <tr>
              <th>Name:</th>
              <td>
                <dfn class="dfn-paneled css" data-dfn-type="property" data-export id="propdef-math-shift">math-shift</dfn>
              </td>
            </tr>
            <tr class="value">
              <th><a data-cite="CSS-VALUES-4#value-defs">Value:</a></th>
              <td class="prod">normal <a data-link-type="grammar" data-cite="CSS-VALUES-4#comb-one">|</a> compact</td>
            </tr>
            <tr>
              <th><a data-cite="CSS-CASCADE-4#initial-values">Initial:</a></th>
              <td>normal</td>
            </tr>
            <tr>
              <th><a data-cite="CSS-CASCADE-4#applies-to">Applies to:</a></th>
              <td>All elements</td>
            </tr>
            <tr>
              <th><a data-cite="CSS-CASCADE-4#inherited-property">Inherited:</a></th>
              <td>yes</td>
            </tr>
            <tr><th><a href="https://www.w3.org/TR/css-values/#percentages">Percentages:</a></th><td>n/a</td></tr>
            <tr>
              <th><a data-cite="CSS-CASCADE-4#computed">Computed value:</a></th>
              <td>specified keyword</td>
            </tr>
            <tr>
              <th><a href="https://www.w3.org/TR/cssom/#serializing-css-values">Canonical order:</a></th>
              <td>n/a</td>
            </tr>
            <tr>
              <th><a href="https://www.w3.org/TR/web-animations/#animation-type">Animation type</a>:</th>
              <td>not animatable</td>
            </tr>
            <tr>
              <th>Media:</th>
              <td>visual</td>
            </tr>
          </tbody>
        </table>
        <p>
          If the value of <code>math-shift</code> is <code>compact</code>, the math layout on descendants will use the
          <a>superscriptShiftUpCramped</a> parameter to place superscript.
          If the value of <code>math-shift</code> is <code>normal</code>, the math
          will use the <a>superscriptShiftUp</a> parameter instead.
        </p>
        <p>
          This property is used for positioning superscript during the layout
          of MathML <a>scripted elements</a>.
          See Â§ <a href="#subscripts-and-superscripts-msub-msup-msubsup"></a>,
          <a href="#prescripts-and-tensor-indices-mmultiscripts"></a> and
          <a href="#underscripts-and-overscripts-munder-mover-munderover"></a>.
        </p>
          <div class="example" id="math-shift-example">
            <p>In the following example, the two "x squared" are rendered with
              compact <a>math-style</a> and the same <code>font-size</code>.
              However, the one within the square root is rendered with
              compact <code>math-shift</code> while
              the other one is rendered with
              normal <code>math-shift</code>, leading
              to subtle different shift of the superscript "2".
            </p>
            <img src="examples/example-math-shift.png" alt="math-shift example">
            <p>Per [[TeXBook]], a
              mathematical formula uses normal style by default but may
              switch to compact style ("cramped" in TeX's terminology)
              within some subformulas
              (e.g. radicals, fraction denominators, etc).
              The <a>math-shift</a> property allows to easily
              implement these rules for MathML in the
              <a>user agent stylesheet</a>.
              Page authors or developers of polyfills may also benefit from
              having access to this property to tweak or refine the default
              implementation.
            </p>
          </div>
      </section>
      <section id="the-math-script-level-property">
        <h3>The <code>math-depth</code> property</h3>
        <p>
          A new <a>math-depth</a> property is introduced to describe a notion
          of "depth" for each element of a mathematical formula, with respect to
          the top-level container of that formula. Concretely, this is used to
          determine the computed value of the
          <a data-xref-type="css-property">font-size</a>
          property when its specified value is <code>math</code>.
        </p>
        <table class="def propdef" data-link-for-hint="math-depth">
          <tbody>
            <tr>
              <th>Name:</th>
              <td>
                <dfn class="dfn-paneled css" data-dfn-type="property" data-export id="propdef-math-depth">math-depth</dfn>
              </td>
            </tr>
            <tr class="value">
              <th><a data-cite="CSS-VALUES-4#value-defs">Value:</a></th>
              <td class="prod">auto-add <a data-link-type="grammar" data-cite="CSS-VALUES-4#comb-one">|</a> add(&lt;integer&gt;) <a data-link-type="grammar" data-cite="CSS-VALUES-4#comb-one">|</a> &lt;integer&gt;</td>
            </tr>
            <tr>
              <th><a data-cite="CSS-CASCADE-4#initial-values">Initial:</a></th>
              <td>0</td>
            </tr>
            <tr>
              <th><a data-cite="CSS-CASCADE-4#applies-to">Applies to:</a></th>
              <td>All elements</td>
            </tr>
            <tr>
              <th><a data-cite="CSS-CASCADE-4#inherited-property">Inherited:</a></th>
              <td>yes</td>
            </tr>
            <tr><th><a href="https://www.w3.org/TR/css-values/#percentages">Percentages:</a></th><td>n/a</td></tr>
            <tr>
              <th><a data-cite="CSS-CASCADE-4#computed">Computed value:</a></th>
              <td>an integer, see below</td>
            </tr>
            <tr>
              <th><a href="https://www.w3.org/TR/cssom/#serializing-css-values">Canonical order:</a></th>
              <td>n/a</td>
            </tr>
            <tr>
              <th><a href="https://www.w3.org/TR/web-animations/#animation-type">Animation type:</a></th>
              <td>not animatable</td>
            </tr>
            <tr>
              <th>Media:</th>
              <td>visual</td>
            </tr>
          </tbody>
        </table>
        <p>The computed value of the <a>math-depth</a> value is
          determined as follows:</p>
        <ul class="algorithm">
          <li>If the specified value of <a>math-depth</a> is
            <code>auto-add</code> and
            the inherited value of <a>math-style</a>
            is <code>compact</code> then the computed value of
            <a>math-depth</a> of the element is its inherited value plus one.
          </li>
          <li>If the specified value of <a>math-depth</a> is of
            the form <code>add(&lt;integer&gt;)</code> then the computed value
            of <a>math-depth</a> of the element is its inherited value plus
            the specified integer.
          </li>
          <li>If the specified value of <a>math-depth</a> is of the form
            <code>&lt;integer&gt;</code> then the computed value
            of <a>math-depth</a> of the element is the specified integer.
	  </li>
          <li>Otherwise, the computed value
            of <a>math-depth</a> of the element is the inherited one.</li>
        </ul>
        <p>
          If the specified value
          <a data-xref-type="css-property">font-size</a>
          is <code>math</code> then the
          computed value of
          <a data-xref-type="css-property">font-size</a>
          is obtained by multiplying the inherited value of
          <a data-xref-type="css-property">font-size</a>
          by a nonzero scale factor calculated by the
          following procedure:
        </p>
        <ol class="algorithm">
          <li>Let A be the inherited <a>math-depth</a> value,
            B the computed <a>math-depth</a> value,
            C be 0.71 and S be 1.0</li>
          <li>
            <ul>
              <li>If A = B then return S.</li>
              <li>If B &lt; A, swap A and B and set <code>InvertScaleFactor</code> to true.</li>
              <li>Otherwise B &gt; A and set <code>InvertScaleFactor</code> to false.</li>
            </ul>
          </li>
          <li>Let E be B - A &gt; 0.</li>
          <li>If the inherited <a>first available font</a> has an OpenType MATH table:
            <ul>
              <li>If A â‰¤ 0 and B â‰¥ 2 then multiply S by <a>scriptScriptPercentScaleDown</a> and
                decrement E by 2.</li>
              <li>Otherwise if A = 1 then multiply S by
                <a>scriptScriptPercentScaleDown</a> / <a>scriptPercentScaleDown</a> and
                decrement E by 1.</li>
              <li>Otherwise if B = 1 then multiply S by <a>scriptPercentScaleDown</a>
                and decrement E by 1.</li>
            </ul>
          </li>
          <li>Multiply S by C<sup>E</sup>.</li>
          <li>Return S if <code>InvertScaleFactor</code> is false and 1/S otherwise.</li>
        </ol>
          <div class="example" id="font-size-scriptlevel-example">
            <p>The following example shows a mathematical formula
              with normal <a>math-style</a>
              rendered with the Latin Modern Math font.
              When entering subexpressions like scripts or fractions,
              the font-size is automatically scaled down according to the
              values of MATH table contained in that font.
              Note that font-size is scaled down when
              entering the superscripts but even faster when entering a
              root's prescript. Also it is scaled down when entering the inner
              fraction but not when entering the outer one, due to automatic
              change of <a>math-style</a> in fractions.
            </p>
            <img src="examples/example-font-size-scriptlevel.png" alt="font-size-scriptlevel example">
            <p>These rules from [[TeXBook]] are subtle and it's worth having a
              separate <code>math-depth</code> mechanism to express and
              handle them. They can be implemented in MathML using the
              <a>user agent stylesheet</a>.
              Page authors or developers of polyfills may also benefit from
              having access to this property to tweak or refine the default
              implementation. In particular, the <a>scriptlevel</a> attribute
              from MathML provides a way to perform <code>math-depth</code>
              changes.
            </p>
          </div>
      </section>
    </section>
    <section class="normative" id="opentype-math-table">
      <h2>OpenType <code>MATH</code> table</h2>
      <p>
        This chapter describes features provided by <code>MATH</code> table
        of an OpenType font [[OPEN-FONT-FORMAT]]. Throughout this chapter,
        a C-like notation
        <code>Table.Subtable1[index].Subtable2.Parameter</code> is used to
        denote OpenType parameters.
        Such parameters may not be available (e.g. if the font lacks one of the
        subtable, has an invalid offset, etc) and so fallback options are
        provided.
      </p>
      <div class="note">
        It is strongly encouraged to render MathML with a math font with
        the proper OpenType features. There is no guarantee that the fallback
        options provided will provide good enough rendering.
      </div>
      <p>
        OpenType values expressed in design units (perhaps indirectly via a
        <code>MathValueRecord</code> entry) are scaled to appropriate values
        for layout purpose, taking into account
        <code>head.unitsPerEm</code>, CSS
        <a data-xref-type="css-property">font-size</a>
        or zoom level.
      </p>
      <section>
        <h3>Layout constants (<code>MathConstants</code>)</h3>
        <p>These are global layout constants for the
          <a>first available font</a>:</p>
        <dl>
          <dt><dfn>Default fallback constant</dfn></dt>
          <dd>0</dd>
          <dt><dfn>Default rule thickness</dfn></dt>
          <dd>
            <code>post.underlineThickness</code> or
            <a>Default fallback constant</a> if the constant is not available.
          </dd>
          <dt><dfn>scriptPercentScaleDown</dfn></dt>
          <dd>
            <code>MATH.MathConstants.scriptPercentScaleDown / 100</code> or
            0.71 if <code>MATH.MathConstants.scriptPercentScaleDown</code> is
            null or not available.
          </dd>
          <dt><dfn>scriptScriptPercentScaleDown</dfn></dt>
          <dd>
            <code>MATH.MathConstants.scriptScriptPercentScaleDown / 100</code> or
            0.5041 if
            <code>MATH.MathConstants.scriptScriptPercentScaleDown</code> is
            null or not available.
          </dd>
          <dt><dfn>displayOperatorMinHeight</dfn></dt>
          <dd><code>MATH.MathConstants.displayOperatorMinHeight</code> or
            <a>Default fallback constant</a>
            if the constant is not available.</dd>
          <dt><dfn>axisHeight</dfn></dt>
          <dd><code>MATH.MathConstants.axisHeight</code> or half
             <code>OS/2.sxHeight</code> if the constant is not available.</dd>
          <dt><dfn>accentBaseHeight</dfn></dt>
          <dd><code>MATH.MathConstants.accentBaseHeight</code> or <code>OS/2.sxHeight</code> if the constant is not available.</dd>
          <dt><dfn>subscriptShiftDown</dfn></dt>
          <dd><code>MATH.MathConstants.subscriptShiftDown</code> or <code>OS/2.ySubscriptYOffset</code> if the constant is not available.</dd>
          <dt><dfn>subscriptTopMax</dfn></dt>
          <dd><code>MATH.MathConstants.subscriptTopMax</code> or â…˜ Ã— <code>OS/2.sxHeight</code> if the constant is not available.</dd>
          <dt><dfn>subscriptBaselineDropMin</dfn></dt>
          <dd><code>MATH.MathConstants.subscriptBaselineDropMin</code> or
            <a>Default fallback constant</a> if the constant is not available.</dd>
          <dt><dfn>superscriptShiftUp</dfn></dt>
          <dd><code>MATH.MathConstants.superscriptShiftUp</code> or <code>OS/2.ySuperscriptYOffset</code> if the constant is not available.</dd>
          <dt><dfn>superscriptShiftUpCramped</dfn></dt>
          <dd><code>MATH.MathConstants.superscriptShiftUpCramped</code> or
            <a>Default fallback constant</a> if the constant is not available.</dd>
          <dt><dfn>superscriptBottomMin</dfn></dt>
          <dd><code>MATH.MathConstants.superscriptBottomMin</code> or Â¼ Ã— <code>OS/2.sxHeight</code> if the constant is not available.</dd>
          <dt><dfn>superscriptBaselineDropMax</dfn></dt>
          <dd><code>MATH.MathConstants.superscriptBaselineDropMax</code> or
            <a>Default fallback constant</a> if the constant is not available.</dd>
          <dt><dfn>subSuperscriptGapMin</dfn></dt>
          <dd><code>MATH.MathConstants.subSuperscriptGapMin</code> or 4 Ã— <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>superscriptBottomMaxWithSubscript</dfn></dt>
          <dd><code>MATH.MathConstants.superscriptBottomMaxWithSubscript</code> or â…˜ Ã— <code>OS/2.sxHeight</code> if the constant is not available.</dd>
          <dt><dfn>spaceAfterScript</dfn></dt>
          <dd><code>MATH.MathConstants.spaceAfterScript</code> or 1/24em if the constant is not available.</dd>
          <dt><dfn>upperLimitGapMin</dfn></dt>
          <dd><code>MATH.MathConstants.upperLimitGapMin</code> or
            <a>Default fallback constant</a> if the constant is not available.</dd>
          <dt><dfn>upperLimitBaselineRiseMin</dfn></dt>
          <dd><code>MATH.MathConstants.upperLimitBaselineRiseMin</code> or <a>Default fallback constant</a> if the constant is not available.</dd>
          <dt><dfn>lowerLimitGapMin</dfn></dt>
          <dd><code>MATH.MathConstants.lowerLimitGapMin</code> or <a>Default fallback constant</a> if the constant is not available.</dd>
          <dt><dfn>lowerLimitBaselineDropMin</dfn></dt>
          <dd><code>MATH.MathConstants.lowerLimitBaselineDropMin</code> or <a>Default fallback constant</a> if the constant is not available.</dd>
          <dt><dfn>stackTopShiftUp</dfn></dt>
          <dd><code>MATH.MathConstants.stackTopShiftUp</code> or <a>Default fallback constant</a> if the constant is not available.</dd>
          <dt><dfn>stackTopDisplayStyleShiftUp</dfn></dt>
          <dd><code>MATH.MathConstants.stackTopDisplayStyleShiftUp</code> or <a>Default fallback constant</a> if the constant is not available.</dd>
          <dt><dfn>stackBottomShiftDown</dfn></dt>
          <dd><code>MATH.MathConstants.stackBottomShiftDown</code> or <a>Default fallback constant</a> if the constant is not available.</dd>
          <dt><dfn>stackBottomDisplayStyleShiftDown</dfn></dt>
          <dd><code>MATH.MathConstants.stackBottomDisplayStyleShiftDown</code> or <a>Default fallback constant</a> if the constant is not available.</dd>
          <dt><dfn>stackGapMin</dfn></dt>
          <dd><code>MATH.MathConstants.stackGapMin</code> or 3 Ã— <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>stackDisplayStyleGapMin</dfn></dt>
          <dd><code>MATH.MathConstants.stackDisplayStyleGapMin</code> or 7 Ã— <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>stretchStackTopShiftUp</dfn></dt>
          <dd><code>MATH.MathConstants.stretchStackTopShiftUp</code> or <a>Default fallback constant</a> if the constant is not available.</dd>
          <dt><dfn>stretchStackBottomShiftDown</dfn></dt>
          <dd><code>MATH.MathConstants.stretchStackBottomShiftDown</code> or <a>Default fallback constant</a> if the constant is not available.</dd>
          <dt><dfn>stretchStackGapAboveMin</dfn></dt>
          <dd><code>MATH.MathConstants.stretchStackGapAboveMin</code> or <a>Default fallback constant</a> if the constant is not available.</dd>
          <dt><dfn>stretchStackGapBelowMin</dfn></dt>
          <dd><code>MATH.MathConstants.stretchStackGapBelowMin</code> or <a>Default fallback constant</a> if the constant is not available.</dd>
          <dt><dfn>fractionNumeratorShiftUp</dfn></dt>
          <dd><code>MATH.MathConstants.fractionNumeratorShiftUp</code> or <a>Default fallback constant</a> if the constant is not available.</dd>
          <dt><dfn>fractionNumeratorDisplayStyleShiftUp</dfn></dt>
          <dd><code>MATH.MathConstants.fractionNumeratorDisplayStyleShiftUp</code> or <a>Default fallback constant</a> if the constant is not available.</dd>
          <dt><dfn>fractionDenominatorShiftDown</dfn></dt>
          <dd><code>MATH.MathConstants.fractionDenominatorShiftDown</code> or <a>Default fallback constant</a> if the constant is not available.</dd>
          <dt><dfn>fractionDenominatorDisplayStyleShiftDown</dfn></dt>
          <dd><code>MATH.MathConstants.fractionDenominatorDisplayStyleShiftDown</code> or <a>Default fallback constant</a> if the constant is not available.</dd>
          <dt><dfn>fractionNumeratorGapMin</dfn></dt>
          <dd><code>MATH.MathConstants.fractionNumeratorGapMin</code> or <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>fractionNumDisplayStyleGapMin</dfn></dt>
          <dd><code>MATH.MathConstants.fractionNumDisplayStyleGapMin</code> or 3 Ã— <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>fractionRuleThickness</dfn></dt>
          <dd><code>MATH.MathConstants.fractionRuleThickness</code> or <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>fractionDenominatorGapMin</dfn></dt>
          <dd><code>MATH.MathConstants.fractionDenominatorGapMin</code> or <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>fractionDenomDisplayStyleGapMin</dfn></dt>
          <dd><code>MATH.MathConstants.fractionDenomDisplayStyleGapMin</code> or 3 Ã— <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>overbarVerticalGap</dfn></dt>
          <dd><code>MATH.MathConstants.overbarVerticalGap</code> or 3 Ã— <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>overbarExtraAscender</dfn></dt>
          <dd><code>MATH.MathConstants.overbarExtraAscender</code> or <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>underbarVerticalGap</dfn></dt>
          <dd><code>MATH.MathConstants.underbarVerticalGap</code> or 3 Ã— <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>underbarExtraDescender</dfn></dt>
          <dd><code>MATH.MathConstants.underbarExtraDescender</code> or <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>radicalVerticalGap</dfn></dt>
          <dd><code>MATH.MathConstants.radicalVerticalGap</code> or 1Â¼ Ã— <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>radicalDisplayStyleVerticalGap</dfn></dt>
          <dd><code>MATH.MathConstants.radicalDisplayStyleVerticalGap</code> or <a>default rule thickness</a> + Â¼ <code>OS/2.sxHeight</code> if the constant is not available.</dd>
          <dt><dfn>radicalRuleThickness</dfn></dt>
          <dd><code>MATH.MathConstants.radicalRuleThickness</code> or <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>radicalExtraAscender</dfn></dt>
          <dd><code>MATH.MathConstants.radicalExtraAscender</code> or <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>radicalKernBeforeDegree</dfn></dt>
          <dd><code>MATH.MathConstants.radicalKernBeforeDegree</code> or 5/18em if the constant is not available.</dd>
          <dt><dfn>radicalKernAfterDegree</dfn></dt>
          <dd><code>MATH.MathConstants.radicalKernAfterDegree</code> or âˆ’10/18em if the constant is not available.</dd>
          <dt><dfn>radicalDegreeBottomRaisePercent</dfn></dt>
          <dd><code>MATH.MathConstants.radicalDegreeBottomRaisePercent / 100.0</code> or 0.6 if the constant is not available.</dd>
        </dl>
      </section>
      <section>
        <h3>Glyph information (<code>MathGlyphInfo</code>)</h3>
        <div class="note">MathTopAccentAttachment is at risk.</div>
        <p>
          These are per-glyph tables for the
          <a>first available font</a>:</p>
        <dl>
          <dt><dfn>MathItalicsCorrectionInfo</dfn></dt>
          <dd>
            The subtable
            <code>MATH.MathGlyphInfo.MathItalicsCorrectionInfo</code>
            of italics correction values. Use the corresponding value in
            <code>MATH.MathGlyphInfo.MathItalicsCorrectionInfo.italicsCorrection</code>
            if there is one for the requested glyph or
            <code>0</code> otherwise.
          </dd>
          <dt><dfn>MathTopAccentAttachment</dfn></dt>
          <dd>
            The subtable
            <code>MATH.MathGlyphInfo.MathTopAccentAttachment</code>
            of positioning top math accents along the <a>inline axis</a>.
            Use the corresponding value in
            <code>MATH.MathGlyphInfo.MathTopAccentAttachment.topAccentAttachment</code>
            if there is one for the requested glyph or
            half the advance width of the glyph otherwise.
          </dd>
        </dl>
      </section>
      <section>
        <h3>Size variants for operators (<code>MathVariants</code>)</h3>
        <p>
          This section describes how to handle stretchy glyphs of arbitrary
          size using the <code>MATH.MathVariants</code> table.
        </p>
        <section>
          <h4>The <code>GlyphAssembly</code> table</h4>
          <p>
            This section is based on [[?OPEN-TYPE-MATH-IN-HARFBUZZ]].
            For convenience, the following definitions are used:
          </p>
          <ul>
            <li>
              <dfn>o<sub>min</sub></dfn> is
              <code>MATH.MathVariant.minConnectorOverlap</code>.
            </li>
            <li>
              A <code>GlyphPartRecord</code> is an <em>extender</em>
              if and only if
              <code>GlyphPartRecord.partFlags</code> has the
              <code>fExtender</code> flag set.
            </li>
            <li>
              A <code>GlyphAssembly</code> is <em>horizontal</em>
              if it is obtained from
              <code>MathVariant.horizGlyphConstructionOffsets</code>.
              Otherwise it is <em>vertical</em> (and obtained from
              <code>MathVariant.vertGlyphConstructionOffsets</code>).
	    </li>
            <li>
              For a given <code>GlyphAssembly</code> table,
              <dfn>N<sub>Ext</sub></dfn> (respectively
              <dfn>N<sub>NonExt</sub></dfn>) is the number of extenders
              (respectively non-extenders) in
              <code>GlyphAssembly.partRecords</code>.
            </li>
            <li>
              For a given <code>GlyphAssembly</code> table,
              <dfn>S<sub>Ext</sub></dfn> (respectively
              <dfn>S<sub>NonExt</sub></dfn>) is the sum of
              <code>GlyphPartRecord.fullAdvance</code>
              for all extenders (respectively non-extenders) in
              <code>GlyphAssembly.partRecords</code>.
            </li>
            <li><dfn>S<sub>Ext,NonOverlapping</sub></dfn> = <a>S<sub>Ext</sub></a> âˆ’ <a>o<sub>min</sub></a> <a>N<sub>Ext</sub></a>
              is the sum of maximum non overlapping parts of extenders.
            </li>
          </ul>
          <p>
            User agents must treat the <code>GlyphAssembly</code> as invalid
            if the following conditions are not satisfied:
          </p>
          <ul>
            <li><a>N<sub>Ext</sub></a> &gt; 0. Otherwise, the assembly cannot
              be grown by repeating extenders.</li>
            <li>
              <a>S<sub>Ext,NonOverlapping</sub></a> &gt; 0.
              Otherwise, the assembly does not grow when joining extenders.
            </li>
            <li>
              For each <code>GlyphPartRecord</code>
              in <code>GlyphAssembly.partRecords</code>,
              the values of
              <code>GlyphPartRecord.startConnectorLength</code> and
              <code>GlyphPartRecord.endConnectorLength</code>
              must be at least <a>o<sub>min</sub></a>.
              Otherwise, it is not possible to satisfy the condition of
              <code>MathVariant.minConnectorOverlap</code>.
            </li>
          </ul>
          <p>
            In this specification, a glyph assembly is built by repeating each
            extender r times and using the same overlap value o between each
            glyph. The number of glyphs in such an assembly is
            <dfn>AssemblyGlyphCount</dfn>(r) = <a>N<sub>NonExt</sub></a> + r <a>N<sub>Ext</sub></a> while
            the stretch size is
            <dfn>AssembySize</dfn>(o, r) =
            <a>S<sub>NonExt</sub></a> + r <a>S<sub>Ext</sub></a>
            âˆ’ o (<a>AssemblyGlyphCount</a>(r) âˆ’ 1).
          </p>
          <p>
            <dfn>r<sub>min</sub></dfn> is the minimal number of repetitions
            needed to obtain an assembly of
            size at least T, i.e. the minimal r such that
            <a>AssembySize</a>(<a>o<sub>min</sub></a>, r) â‰¥ T.
            It is defined as the maximum between 0 and the ceiling of
            ((T âˆ’ <a>S<sub>NonExt</sub></a> + <a>o<sub>min</sub></a> (<a>N<sub>NonExt</sub></a> âˆ’ 1)) / <a>S<sub>Ext,NonOverlapping</sub></a>).
          </p>
          <p><dfn>o<sub>max,theorical</sub></dfn> = (<a>AssembySize</a>(0, <a>r<sub>min</sub></a>) âˆ’ T) / (<a>AssemblyGlyphCount</a>(<a>r<sub>min</sub></a>) âˆ’ 1)
              is the theorical overlap obtained by
              splitting evenly the extra size of an assembly built with
              null overlap.</p>
	  <p>
            <dfn>o<sub>max</sub></dfn> is the
            maximum overlap possible to build an assembly of size at least
            T by repeating each extender <a>r<sub>min</sub></a> times.

            If <a>AssemblyGlyphCount</a>(<a>r<sub>min</sub></a>) â‰¤ 1, then the actual overlap value is irrelevant.
            Otherwise, o<sub>max</sub> is defined to be the minimum of:
          </p>
          <ul>
            <li><a>o<sub>max,theorical</sub></a>.</li>
            <li>
              <code>GlyphPartRecord.startConnectorLength</code> for all
              the entries in
              <code>GlyphAssembly.partRecords</code>, excluding the
              last one if it is not an extender.
            </li>
            <li>
              <code>GlyphPartRecord.endConnectorLength</code> for all
              the entries in
              <code>GlyphAssembly.partRecords</code>, excluding the
              first one if it is not an extender.
            </li>
            </ul>
	  <p>
            The <dfn>glyph assembly stretch size</dfn>
            for a target size T is
            <a>AssembySize</a>(<a>o<sub>max</sub></a>, <a>r<sub>min</sub></a>).
          </p>
          <p>
            The
            <dfn>glyph assembly width</dfn>,
            <dfn>glyph assembly ascent</dfn>
            and <dfn>glyph assembly descent</dfn>
            are defined as follows:
          </p>
          <ul>
            <li>If <code>GlyphAssembly</code> is vertical,
              the width is the maximum advance width of the glyphs of ID
              <code>GlyphPartRecord.glyphID</code> for all the
              <code>GlyphPartRecord</code> in
              <code>GlyphAssembly.partRecords</code>,
              the ascent is the
              <a>glyph assembly stretch size</a>
              for a given target size <code>T</code>
              and the descent is 0.
            </li>
            <li>Otherwise, the <code>GlyphAssembly</code> is horizontal,
              the width is <a>glyph assembly stretch size</a>
              for a given target size <code>T</code> while
              the ascent (respectively descent) is the
              maximum ascent (respectively descent) of the glyphs of ID
              <code>GlyphPartRecord.glyphID</code> for all the
              <code>GlyphPartRecord</code> in
              <code>GlyphAssembly.partRecords</code>.
            </li>
          </ul>
          <p>
            The <dfn>glyph assembly height</dfn> is the sum
            of the <a>glyph assembly ascent</a> and
            <a>glyph assembly descent</a>.
          </p>
          <div class="note">
            The horizontal (respectively vertical) metrics for a vertical
            (respectively horizontal) glyph assembly do not depend
            on the target size <code>T</code>.
          </div>
          <p>The <dfn>shaping of the glyph assembly</dfn>
            is performed with the following algorithm:
          </p>
          <ol class="algorithm">
            <li>Calculate <a>r<sub>min</sub></a> and
              <a>o<sub>max</sub></a>.</li>
            <li>
              Set <code>(x, y)</code> to <code>(0, 0)</code>,
              <code>RepetitionCounter</code> to 0 and
              <code>PartIndex</code> to -1.
            </li>
            <li>
              Repeat the following steps:
              <ol>
                <li>
                  If <code>RepetitionCounter</code> is 0:
                  <ol>
                    <li>Increment <code>PartIndex</code>.</li>
                    <li>If <code>PartIndex</code> is
                      <code>GlyphAssembly.partCount</code>
                      then stop.</li>
                    <li>Otherwise, set
                      <code>Part</code> to
                      <code>GlyphAssembly.partRecords[PartIndex]</code>.
                      Set <code>RepetitionCounter</code> to
                      <a>r<sub>min</sub></a> if
                      <code>Part</code> is an extender and to 1 otherwise.
                    </li>
                  </ol>
                </li>
                <li>
                  <ul>
                    <li>If the glyph assembly is horizontal then
                      draw the glyph of ID
                      <code>Part.glyphID</code>
                      so that its (left, baseline) coordinates
                      are at position <code>(x, y)</code>.
                      Set <code>x</code> to
                      <code>x + Part.fullAdvance âˆ’
                        <a>o<sub>max</sub></a>.</code>
                    </li>
                    <li>Otherwise (if the glyph assembly is vertical),
                      then
                      draw the glyph of id
                      <code>Part.glyphID</code>
                      so that its (left, bottom) coordinates
                      are at position <code>(x, y)</code>.
                      Set <code>y</code> to
                      <code>y âˆ’ Part.fullAdvance +
                        <a>o<sub>max</sub></a>.</code>
                    </li>
                  </ul>
                </li>
                <li>Decrement <code>RepetitionCounter</code>.</li>
              </ol>
            </li>
          </ol>
        </section>
        <section>
          <h4>Algorithms for glyph stretching</h4>
          <p>
            The <dfn>preferred inline size of a glyph stretched along the block
            axis</dfn>
            is calculated using the following algorithm:
          </p>
          <ol class="algorithm">
            <li>
              Set <code>S</code> to the glyph's advance width.
            </li>
            <li>
              If there is a <code>MathGlyphConstruction</code> table
              in the <code>MathVariants.vertGlyphConstructionOffsets</code>
              table for the given glyph:
              <ol>
                <li>
                  For each <code>MathGlyphVariantRecord</code> in
                  <code>MathGlyphConstruction.mathGlyphVariantRecord</code>,
                  ensure that <code>S</code> is at least
                  the advance width of the glyph of id
                  <code>MathGlyphVariantRecord.variantGlyph</code>.
                </li>
                <li>
                  If there is valid <code>GlyphAssembly</code> subtable,
                  then ensure
                  that <code>S</code> is at least the
                  <a>glyph assembly width</a>.
                </li>
              </ol>
            </li>
            <li>Return <code>S</code>.</li>
          </ol>
          <div class="note">
            The <a>preferred inline size of a glyph stretched along the block
            axis</a> will return the maximum width of all possible
            vertical constructions for that glyph.
            In practice, math fonts are designed so that
            vertical constructions are almost constant width, so possible
            over-estimation of the actual width is small.
          </div>
          <p>
            The algorithm to <dfn>shape a stretchy glyph</dfn> to inline
            (respectively block) dimension <code>T</code>
            is the following:
          </p>
          <ol class="algorithm">
            <li>
              If there is not any <code>MathGlyphConstruction</code> table
              in the <code>MathVariants.horizGlyphConstructionOffsets</code>
              table  (respectively
              <code>MathVariants.vertGlyphConstructionOffsets</code> table)
              for the given glyph then exit with failure.
            </li>
            <li>
              If the glyph's advance width
              (respectively height) is at least <code>T</code>
              then use normal shaping and bounding box for that glyph,
              the <a>MathItalicsCorrectionInfo</a> for that glyph as
              italic correction and exit with success.
            </li>
            <li>
              Browse the list of <code>MathGlyphVariantRecord</code> in
              <code>MathGlyphConstruction.mathGlyphVariantRecord</code>.
              If one <code>MathGlyphVariantRecord.advanceMeasurement</code>
              is at least <code>T</code> then use
              normal shaping and bounding box
              for <code>MathGlyphVariantRecord.variantGlyph</code>,
              the <a>MathItalicsCorrectionInfo</a> for that glyph as
              italic correction and exit with success.
            </li>
            <li>
              If there is valid <code>GlyphAssembly</code> subtable
              then use the bounding box given by
              <a>glyph assembly width</a>,
              <a>glyph assembly height</a>,
              <a>glyph assembly ascent</a>,
              <a>glyph assembly descent</a>, the value
              <code>GlyphAssembly.italicsCorrection</code> as italic
              correction, perform <a>shaping of the glyph assembly</a> and
              exit with success.
            </li>
            <li>If none of the stretch options above allowed to cover the target
              size <code>T</code>, then choose last one that was tried and exit
              with success.
            </li>
          </ol>
          <div class="note">
            If a font does not provide tables for stretchy constructions, User
            Agents may use their own internal constructions as a fallback
            such as
            the one suggested in <a href="#unicode-based-glyph-assemblies"></a>.
          </div>
        </section>
      </section>
    </section>
    <section class="appendix normative" id="user-agent-stylesheet">
      <h2><dfn>User Agent Stylesheet</dfn></h2>
      <pre class="css">@namespace url(http://www.w3.org/1998/Math/MathML);

/* Universal rules */
<span data-include-replace="true" data-include="user-agent-stylesheet/universal.css"></span>
/* The &lt;math&gt; element */
<span data-include-replace="true" data-include="user-agent-stylesheet/math.css"></span>
/* &lt;mrow&gt;-like elements */
<span data-include-replace="true" data-include="user-agent-stylesheet/semantics.css"></span><span data-include-replace="true" data-include="user-agent-stylesheet/maction.css"></span><span data-include-replace="true" data-include="user-agent-stylesheet/merror.css"></span><span data-include-replace="true" data-include="user-agent-stylesheet/mphantom.css"></span>
/* Token elements */
<span data-include-replace="true" data-include="user-agent-stylesheet/mi.css"></span>
/* Tables */
<span data-include-replace="true" data-include="user-agent-stylesheet/mtable.css"></span><span data-include-replace="true" data-include="user-agent-stylesheet/mtr.css"></span><span data-include-replace="true" data-include="user-agent-stylesheet/mtd.css"></span>
/* Fractions */
<span data-include-replace="true" data-include="user-agent-stylesheet/mfrac.css"></span>
/* Other rules for scriptlevel, displaystyle and math-shift */
<span data-include-replace="true" data-include="user-agent-stylesheet/radicals.css"></span><span data-include-replace="true" data-include="user-agent-stylesheet/scripts.css"></span>
      </pre>
    </section>
    <section>
      <h2>Operator Tables</h2>
      <section id="operator-dictionary" class="normative">
        <h3>Operator Dictionary</h3>
        <div class="note">
          This section describes how to determine values of
          <a href="#dictionary-based-attributes"></a> and
          [=embellished operator/stretch axis=] of operators.
          Compact tables below are suitable for computer manipulation,
          see <a href="#operator-dictionary-human"></a> for an alternative
          presentation.
        </div>
        <p>The <dfn class="abstract-op">algorithm to set the properties of an operator from its category</dfn> is as follows:</p>
        <ul class="algorithm">
          <li>Set <code>minsize</code> to <code>1em</code>.</li>
          <li>Set <code>maxsize</code> to <code>âˆž</code>.</li>
          <li>Find the row corresponding to the specified category
            on <a href="#operator-dictionary-categories-values"></a>.
          </li>
          <li>Set <code>lspace</code> and <code>rspace</code> to the
            value specified in the corresponding column.</li>
          <li>For each property <code>stretchy</code>,
            <code>symmetric</code>, <code>largeop</code>,
            <code>movablelimits</code>, set that property to <code>true</code>
            if it is listed in the last column or to <code>false</code>
            otherwise.</li>
        </ul>

        <p>The <dfn class="abstract-op">algorithm to determine the category of an operator</dfn>
          (<code>Content</code>, <code>Form</code>) is as folllows:
        </p>
        <ol class=algorithm>
          <li>
            If <code>Content</code> as an UTF-16 string does not have length
            or 1 or 2 then exit with category <code>Default</code>.
          </li>
          <li>If <code>Content</code> is a single character in the
            range U+0320â€“U+03FF
            then exit with category <code>Default</code>. Otherwise,
            if it has two characters:
            <ul>
              <li>If <code>Content</code> is the surrogate pairs corresponding
                to
                U+1EEF0 ARABIC MATHEMATICAL OPERATOR MEEM WITH HAH WITH TATWEEL
                or U+1EEF1 ARABIC MATHEMATICAL OPERATOR HAH WITH DAL and
                <code>Form</code> is <code>postfix</code>, exit with category
                <code>I</code>.</li>
              <li>If the second character is
                U+0338 COMBINING LONG SOLIDUS OVERLAY or
                U+20D2 COMBINING LONG VERTICAL LINE OVERLAY then replace
                <code>Content</code> with the first character and move to step
                3.</li>
              <li>Otherwise, if <code>Content</code> is listed in
                <a href="#operator-dictionary-compact-special-tables"><code>Operators_2_ascii_chars</code></a> then
                replace <code>Content</code> with the
                Unicode character
                "U+0320 plus the index of <code>Content</code> in
                <code>Operators_2_ascii_chars</code>" and move to step
                3.
              </li>
              <li>Otherwise exit with category <code>Default</code>.</li>
            </ul>
          </li>
          <li>If <code>Form</code> is infix and <code>Content</code> corresponds
            to one of U+007C VERTICAL LINE or U+223C TILDE OPERATOR then exit
            with category <code>ForceDefault</code>. If the category of
            (<code>Content</code>, <code>Form</code>)
            provided by table
            <a href="#operator-dictionary-category-table"></a>
            has N/A encoding in table
            <a href="#operator-dictionary-categories-values"></a>
            (namely if it has category <code>L</code> or <code>M</code>), then
            exit with that category.
            Otherwise:
                <ul>
                  <li>Set <code>Key</code> to <code>Content</code> if it is in
                    range U+0000â€“U+03FF; or to <code>Content</code> âˆ’ 0x1C00
                    if it is in range U+2000â€“U+2BFF. Otherwise, exit with
                    category <code>Default</code>.
                  </li>
                  <li>Add 0x0000, 0x1000, 0x2000
                    to <code>Key</code> according to whether <code>Form</code>
                    is <code>infix</code>, <code>prefix</code>,
                    <code>postfix</code> respectively.
                  </li>
                  <li>Assert: <code>Key</code> is at most 0x2FFF.</li>
                  <li>Search an <code>Entry</code> in table
                    <a href="#operator-dictionary-categories-hexa-table"></a>
                    such that <code>Entry</code> % 0x4000 is equal to
                    <code>Key</code>. If one is found then return the category
                    corresponding to encoding <code>Entry</code> / 0x1000 in
                    <a href="#operator-dictionary-categories-values"></a>.
                    Otherwise, return category <code>Default</code>.
		  </li>
                </ul>
              </li>
            </ol>
        <div id="operator-dictionary-entries-compact"
             data-include="tables/operator-dictionary-compact.html"></div>

        <div class="note" id="operator-dictionary-compact-implementations">
          <ul>
            <li>
              Tables of
              <a href="#operator-dictionary-category-table"></a> and
              <a href="#operator-dictionary-categories-hexa-table"></a> are
              encoded as ranges to take profit of the presence of many
              contiguous Unicode blocks.
            </li>
            <li>
              To quickly find an entry in these tables, one can still perform a
              binary search over the range starts, followed by an
              extra check on the range length.
            </li>
            <li>Since log is concave,
              it is more efficient to perform one binary search
              on the whole table of
              <a href="#operator-dictionary-categories-hexa-table"></a>
              rather than on each large subtable
              of <a href="#operator-dictionary-category-table"></a>.
          </li>
	  </ul>
        </div>
        <p id="stretchy-operator-axis">
          The <dfn>intrinsic stretch axis</dfn> a Unicode character
          <code>c</code> is <em>inline</em> if it belongs to the list below.
          Otherwise, the intrinsic stretch axis of <code>c</code> is
          <em>block</em>.
        </p>
        <div data-include="tables/inline-axis-operators.html"></div>
        <div class="note">
          The intrinsic stretch axis could be included as a boolean property of
          the operator dictionary. But since it
          does not depend on the form and since very few operators can stretch
          along the <a>inline axis</a>, it is better implemented as a separate
          sorted array. Each entry can be encoded with 16 bytes if
          U+1EEF0 ARABIC MATHEMATICAL OPERATOR MEEM WITH HAH WITH TATWEEL and
          U+1EEF1 ARABIC MATHEMATICAL OPERATOR HAH WITH DAL are tested
          separately.
        </div>
      </section>
      <section id="operator-dictionary-human" class="informative">
        <h3>Operator Dictionary (human-readable)</h3>
        <p>
          The following dictionary provides a human-readable version
          of <a href="#operator-dictionary"></a>. Please refer to
          <a href="#dictionary-based-attributes"></a> for explanation about
          how to use this dictionary and how to
          determine the values <code>Content</code> and <code>Form</code>
          indexing together
          the dictionary.
        </p>
        <p>
          The values for [=embellished operator/rspace=] and [=embellished operator/lspace=] are indicated
          in the corresponding columns.
          The values of
          [=embellished operator/stretchy=],
          [=embellished operator/symmetric=],
          [=embellished operator/largeop=],
          [=embellished operator/movablelimits=]
          are <code>true</code>
          if they are listed in the "properties" column.
        </p>
        <div id="operator-dictionary-entries"
             data-include="tables/operator-dictionary.html"></div>
      </section>
      <section class="informative">
        <h3>Combining Character Equivalences</h3>
        <p>
          The following table gives mappings between spacing and non spacing
          characters when used in MathML accent constructs.
        </p>
        <div data-include="tables/combining-operators.html"></div>
      </section>
      <section class="informative">
        <h2>Unicode-based Glyph Assemblies</h2>
        <p>
          The following table provides fallback that user agents may use for
          stretching a given <em>base character</em> when the font does not
          provide a <code>MATH.MathVariants</code> table.
          The algorithms of
          <a href="#size-variants-for-operators-mathvariants"></a>
          work the same except with some adjustments:
        </p>
        <ul>
          <li>
            Entries are indexed by the base character.
          </li>
          <li>
            All the glyph IDs and metrics have to be deduced from Unicode
            code points.
          </li>
          <li>
            If the <em>glyph construction</em> is horizontal then
            the entry corresponds to
            a <code>MathVariants.horizGlyphConstructionOffsets[]</code> item;
            if it is vertical it corresponds to
            a <code>MathVariants.vertGlyphConstructionOffsets[]</code> item.
          </li>
          <li>
            The <code>MathGlyphConstruction.mathGlyphVariantRecord</code> is
            always empty.
          </li>
          <li>
            The
            <code>MathVariants.minConnectorOverlap</code>,
            <code>GlyphPartRecord.startConnectorLength</code> and
            <code>GlyphPartRecord.endConnectorLength</code>
            are treated as 0.
          </li>
          <li>
            The array of
            <code>MathGlyphConstruction.GlyphAssembly.partRecords</code> is built
            from each table row as follows:
            <ol class="algorithm">
              <li>A (non-extender) <em>bottom/left</em> character</li>
              <li>Followed by an <em>extender</em> character.</li>
              <li>Optionally followed by this:
                <ul>
                  <li>Optionally, a (non-extender) <em>middle</em> character
                    and the same extender character previously mentioned.</li>
			<li>A (non-extender) <em>top/right</em> character.</li>
                </ul>
              </li>
            </ol>
          </li>
        </ul>
        <div data-include="tables/unicode-assembly.html"></div>
      </section>
    </section>
    <section>
      <h3 id="new-text-transform-mappings">Mathematical Alphanumeric Symbols</h3>
      <p>
        The following tables enumerate the mathematical alphanumeric symbols
        with form bold, italic, fraktur, monospace, double-struck etc
        that are available in Unicode.
        For each of them, the character in its normal form is provided as
        well as the difference between the code points of the transformed and
        original characters.
      </p>
      <div class="note">
        This difference can be used to simplify implementations. For example
        for italic mappings, the code point of a uppercase latin letter is
        increased by 0x1D3F3, the code point of a lowercase latin letter is
        (generally) increased by 1D3ED, etc and the exceptions can be
        handled separately.
      </div>
          <div class="note">
            <p>It is sometimes needed to distinguish between
            Chancery and Roundhand style for MATHEMATICAL SCRIPT characters.
            These are notably used in LaTeX for the
            <code>\mathcal</code> and <code>\mathscr</code> commands.</p>
            <p>One way to do that is to rely on
            Chapter 23.4 Variation Selectors of
            Unicode which describes a way to
            specify selection of particular glyph variants [[UNICODE]].
            Indeed, the
            <code>StandardizedVariants.txt</code> file from the
            Unicode Character Database indicates that variant selectors
            U+FE00 and U+FE01 can be used on capital script to specify
            Chancery and Roundhand respectively.</p>
            <p>Alternatively, some
            mathematical fonts rely on <code>salt</code> or
            <code>ssXY</code> properties from [[OPEN-FONT-FORMAT]]
            to provide both styles. Page authors may use the
            <a data-xref-type="css-property">font-variant-alternates</a> property with corresponding OpenType font features
            to access these glyphs.</p>
          </div>
      <section class="informative" id="bold-script-mappings">
        <h4><code>bold-script</code> mappings</h4>
        <div data-include="tables/mathvariants-bold-script.html"></div>
      </section>
      <section class="informative" id="bold-italic-mappings">
        <h4><code>bold-italic</code> mappings</h4>
        <div data-include="tables/mathvariants-bold-italic.html"></div>
      </section>
      <section class="informative" id="tailed-mappings">
        <h4><code>tailed</code> mappings</h4>
        <div data-include="tables/mathvariants-tailed.html"></div>
      </section>
      <section class="informative" id="bold-mappings">
        <h4><code>bold</code> mappings</h4>
        <div data-include="tables/mathvariants-bold.html"></div>
      </section>
      <section class="informative" id="fraktur-mappings">
        <h4><code>fraktur</code> mappings</h4>
        <div data-include="tables/mathvariants-fraktur.html"></div>
      </section>
      <section class="informative" id="script-mappings">
        <h4><code>script</code> mappings</h4>
        <div data-include="tables/mathvariants-script.html"></div>
      </section>
      <section class="informative" id="monospace-mappings">
        <h4><code>monospace</code> mappings</h4>
        <div data-include="tables/mathvariants-monospace.html"></div>
      </section>
      <section class="informative" id="initial-mappings">
        <h4><code>initial</code> mappings</h4>
        <div data-include="tables/mathvariants-initial.html"></div>
      </section>
      <section class="informative" id="sans-serif-mappings">
        <h4><code>sans-serif</code> mappings</h4>
        <div data-include="tables/mathvariants-sans-serif.html"></div>
      </section>
      <section class="informative" id="double-struck-mappings">
        <h4><code>double-struck</code> mappings</h4>
        <div data-include="tables/mathvariants-double-struck.html"></div>
      </section>
      <section class="informative" id="looped-mappings">
        <h4><code>looped</code> mappings</h4>
        <div data-include="tables/mathvariants-looped.html"></div>
      </section>
      <section class="informative" id="stretched-mappings">
        <h4><code>stretched</code> mappings</h4>
        <div data-include="tables/mathvariants-stretched.html"></div>
      </section>
      <section class="normative" id="italic-mappings">
        <h4><code>italic</code> mappings</h4>
        <div data-include="tables/mathvariants-italic.html"></div>
      </section>
      <section class="informative" id="bold-fraktur-mappings">
        <h4><code>bold-fraktur</code> mappings</h4>
        <div data-include="tables/mathvariants-bold-fraktur.html"></div>
      </section>
      <section class="informative" id="sans-serif-bold-italic-mappings">
        <h4><code>sans-serif-bold-italic</code> mappings</h4>
        <div data-include="tables/mathvariants-sans-serif-bold-italic.html"></div>
      </section>
      <section class="informative" id="sans-serif-italic-mappings">
        <h4><code>sans-serif-italic</code> mappings</h4>
        <div data-include="tables/mathvariants-sans-serif-italic.html"></div>
      </section>
      <section class="informative" id="bold-sans-serif-mappings">
        <h4><code>bold-sans-serif</code> mappings</h4>
        <div data-include="tables/mathvariants-bold-sans-serif.html"></div>
      </section>
    </section>
    <section class="appendix informative">
      <h2>Acknowledgments</h2>
      <p>MathML Core is based on MathML3. See the
        <a href="https://www.w3.org/TR/MathML3/appendixe.html">appendix E</a>
        of [[MathML3]] for the people that contributed to that specification.
      </p>
      <p>MathML Core was initially developed by the MathML Community Group, and
	then by the Math Working Group. Working Group or Community Group
	members who regularly participated in MathML
        Core meetings during the development of this specification:
        Brian Kardell,
        Bruce Miller,
        Daniel Marques,
        David Carlisle,
        David Farmer,
        Deyan Ginev,
        FrÃ©dÃ©ric Wang,
	Louis Mahler,
        Moritz Schubotz,
        Murray Sargent,
        Neil Soiffer,
        Patrick Ion,
        Rob Buis,
        Steve Noble and
        Sam Dooley.
      </p>
        
      <p>In addition, we would like to extend special thanks to
        Brian Kardell,
        Neil Soiffer and
        Rob Buis for help with the editing.</p>
      <p>Many thanks also to the following people for their help with the
        test suite:
        Brian Kardell,
        FrÃ©dÃ©ric Wang,
        Neil Soiffer and
        Rob Buis.
        Several tests are also based on MathML tests from browser
        repositories and we are grateful to the Mozilla and WebKit
        contributors.
      </p>
      <p>We would like to thank the people who, through their input and
        feedback on public communication channels, have helped us with the
        creation of this specification:
        AndrÃ© Greiner-Petter,
        Anne van Kesteren,
        Boris Zbarsky,
        Brian Smith,
        Elika Etemad,
        Emilio Cobos Ãlvarez,
        ExE Boss,
        Ian Kilpatrick,
        Koji Ishii,
        L. David Baron,
        Michael Kohlhase,
        Michael Smith,
        Ryosuke Niwa,
        Sergey Malkin,
        Tab Atkins Jr.,
        Viktor Yaffle and
        frankvel.
      </p>

    </section>
    <section class="appendix informative">
      <h2>Security Considerations</h2>
      <p>
        This specification adds script execution mechanisms via the
        MathML event handler attributes described in
        <a href="#global-attributes"></a>. UAs may decide to prevent execution
        of scripts specified in these attributes, following the same
        security restrictions as those applying to HTML or SVG elements.
      </p>
      <div class="note">
        <p>In [[MathML3]], it was possible to make any element linkable
          via <code>href</code> or <code>xlink:href</code> attributes, with
          an URL pointing to an untrusted resource or even
          <code>javascript:</code> execution. These attributes are not
          available in MathML Core. However, as described in
          <a href="#html-and-svg"></a> it is possible to embed
          HTML or SVG content inside MathML, including HTML or SVG links.
        </p>
      </div>
      <div class="note">
        <p>In [[MathML3]], it was possible to use the
        [^maction^] element with
        the <code>actiontype</code> value set to <code>"statusline"</code>
        in order to override the text of the browser statusline. In particular,
        an attacker could use this
        to hide the URL text of an untrusted link e.g.</p>

        <pre data-include="examples/example-without-screenshot-maction-statusline.html"
             data-include-format="text"></pre>

        <p>This feature is not available in MathML Core, where
        the [^maction^] element essentially behaves
        like an [^mrow^] container with extra style.</p>
      </div>
      <p>An attacker can try to hang the UA by inserting very large
        stretchy operators, effectively making the algorithm
        <a>shaping of the glyph assembly</a> deal with a huge amount of
        glyphs. UAs may work around this issue
        by limiting <a>r<sub>min</sub></a> and
        <code>GlyphAssembly.partCount</code> to
        maximum values.</p>
      <p>As described in
        <a data-cite="CSS-FONTS-4#security">CSS Fonts Module</a>,
        an attacker can try to rely on malformed or malicious fonts to
        exploit potential security faults in browser implementations.
        Because the <a href="#opentype-math-table">OpenType MATH table</a>
        is used extensively in this specification, UAs should ensure their font
        sanitization mechanisms are able to deal with that table.</p>
      <p>Finally,
        in order to reduce attack surface, some UAs expose runtime options
        to disable part of the web platform. Disabling MathML layout can
        essentially be
        achieved by forcing elements in the DOM tree to be put in the HTML
        namespace and disabling <a href="#css-extensions-for-math-layout"></a>.
      </p>
    </section>
    <section class="appendix informative">
      <h2>Privacy Considerations</h2>
      <p>
        As explained in <a href="#html-and-svg"></a>,
        MathML can be embedded into an SVG image via the
        <a data-cite="SVG/embedded.html#ForeignObjectElement"><code>&lt;foreignObject&gt;</code></a>
        element which can thus be used in a
        [^canvas^]
        element.
        UA may decide to implement any measure to prevent potential
        <a data-cite="HTML/../#security-with-canvas-elements">information leakage</a>
        such as tainting the canvas and returning a
        {{"SecurityError"}}
        when one tries to access the canvas' content via JavaScript APIs.
      </p>
      <div class="example" id="canvas-example">
        <p>
          In the following example, the canvas image is set to the image of
          some MathML content with an HTML link to <code>https://example.org/</code>.
          It should not be possible for an attacker to determine whether that
          link was visited by reading pixels via <code>context.{{CanvasImageData/getImageData()}}</code>.
          For more about links in MathML, see
          <a href="#security-considerations"></a>.
        </p>
        <pre data-include="examples/example-without-screenshot-math-in-canvas.html"
             data-include-format="text"></pre>
      </div>
      <p>
        This specification describes layout of DOM
        <a>elements</a> which may involve system
        fonts. Like for HTML/CSS layout,
        it is thus possible to use JavaScript APIs
        (e.g.
        <code>context.{{CanvasImageData/getImageData()}}</code> on content embedded in a canvas context, or even just
        {{Element/getBoundingClientRect()}})
        to measure box sizes and positions and infer data from system fonts.
        By combining miscellaneous tests on such fonts and
        comparing measurements against results of well-known fonts, an attacker
        can try and determine the default fonts of the user.
      </p>
      <div class="example" id="font-information-leakage-1">
        <p>The following
        HTML+CSS+JavaScript document relies on a Web font with exotic metrics
        to try and determine whether <code>A Well Known System Font</code>
        is available by default.</p>
        <pre data-include="examples/example-without-screenshot-font-information-leakage-1.html"
             data-include-format="text"></pre>
      </div>
      <div class="example" id="font-information-leakage-2">
        <p>The following
        HTML+CSS+JavaScript document tries to determine whether the
        UI serif font provides Asian glyphs:</p>
        <pre data-include="examples/example-without-screenshot-font-information-leakage-2.html"
             data-include-format="text"></pre>
      </div>
      <div class="example" id="font-information-leakage-3">
        <p>The following
        HTML+CSS document contains the same text rendered with
        <a data-xref-type="css-property">text-decoration-thickness</a> set to <code>from-font</code> and <code>1em</code> (here
        100 pixels)
        respectively. By comparing the heights of the two underlines,
        one can calculate a good approximation of the
        <code>underlineThickness</code> value from the PostScript Table
        [[OPEN-FONT-FORMAT]].
        </p>
        <pre data-include="examples/example-without-screenshot-font-information-leakage-3.html"
             data-include-format="text"></pre>
      </div>
      <p>This specification relies on information from
        <a href="#opentype-math-table"></a> to render MathML content. One
        can get good approximation of most
        layout parameters from <code>MathConstants</code> and
        <code>MathGlyphInfo</code> using measurement
        techniques similar to what is described above for
        HTML+CSS+JavaScript document. The use of the <code>MathVariants</code>
        table for MathML rendering can also be observed by putting stretchy
        operators of different sizes inside a <code>canvas</code> context.</p>
      <p>Although none of these parameters taken individually are personal,
        implementing this specification increases the set of exposed
        font information that can be used by an attacker to implement
        fingerprinting techniques. Typically, they could help determine
        available and preferred math fonts for a user.
      </p>
    </section>
    <section id="conformance" class="appendix normative override">
      <h2>Conformance</h2>
        <p>
          Conformance requirements are expressed with a combination of
          descriptive assertions and RFC 2119 terminology. The key words â€œMUSTâ€,
          â€œMUST NOTâ€, â€œREQUIREDâ€, â€œSHALLâ€, â€œSHALL NOTâ€, â€œSHOULDâ€, â€œSHOULD NOTâ€,
          â€œRECOMMENDEDâ€, â€œMAYâ€, and â€œOPTIONALâ€ in the normative parts of this
          document are to be interpreted as described in RFC 2119.
          However, for readability, these words do not appear in all uppercase
          letters in this specification.
        </p>
        <p>
          All of the text of this specification is normative except sections
          explicitly marked as non-normative, examples, and notes.
          [[RFC2119]]
        </p>
        <p>
          Examples in this specification are introduced with the words
          â€œfor exampleâ€ or are set apart from the normative text with
          <code>class="example"</code>, like this:
        </p>
        <div class="example">
          <p>
            This is an example of an informative example.
          </p>
        </div>
        <p>
          Informative notes begin with the word â€œNoteâ€ and are set apart from
          the normative text with <code>class="note"</code>, like this:
        </p>
        <p class="note">
          Note, this is an informative note.
        </p>
        <p>
          Advisements are normative sections styled to evoke special attention
          and are set apart from other normative text with
          <code>&lt;strong class="advisement"&gt;</code>, like this:
          <strong class="advisement">UAs MUST provide an accessible alternative. </strong>
        </p>
    </section>
  </body>
</html>
