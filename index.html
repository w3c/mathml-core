<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>MathML Core</title>
    <link href="https://test.csswg.org/harness/stylesheets/annotate.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
    <script src="https://www.w3.org/Tools/respec/respec-w3c-common"
            class="remove"></script>
    <script src="tables/sorttable.js"></script>
    <script class="remove" src="wpt/data-tests.js"></script>
    <script class="remove" src="wpt/fetch-browser-results.js"></script>
    <script class="remove" src="spec-implementation-report.js"></script>
    <script class="remove">
      var respecConfig = {
          specStatus: "ED",
          editors: [{
              name: "David Carlisle",
              url: "https://davidcarlisle.github.io/dcarlisle/david/",
              company: "NAG"
          }, {
              name: "Frédéric Wang",
              url: "http://frederic-wang.fr",
              company: "Igalia"
          }],
          formerEditors: [{
              name: "Patrick Ion",
              url: "http://www-personal.umich.edu/~pion/",
              company: "Mathematical Reviews, American Mathematical Society"
          }, {
              name: "Robert Miner (deceased)",
              company: "Design Science, Inc."
          }],
          wg: "MathML Refresh Community Group",
          wgURI: "https://www.w3.org/community/mathml4/",
          edDraftURI: "https://mathml-refresh.github.io/mathml-core/",
          shortName: "mathml-core",
          mdn: true,
          testSuiteURI: "https://w3c-test.org/mathml/",
          issueBase: "https://github.com/mathml-refresh/mathml/issues/",
          implementationReportURI: "https://mathml-refresh.github.io/mathml-core/implementation-report.html",
          otherLinks: [{
              key: "Participate",
              data: [{
                  value: 'MathML Refresh CG',
                  href: 'https://www.w3.org/community/mathml4/'
              }, {
                  value: 'GitHub mathml-refresh/mathml',
                  href: 'https://github.com/mathml-refresh/mathml/'
              }, {
                  value: 'GitHub mathml-refresh/mathml-core',
                  href: 'https://github.com/mathml-refresh/mathml-core/'
              }, {
                  value: 'File a bug',
                  href: 'https://github.com/mathml-refresh/mathml/issues'
              }, {
                  value: 'Commit History',
                  href: 'https://github.com/mathml-refresh/mathml-core/commits/gh-pages'
              }, {
                  value: 'Pull requests',
                  href: 'https://github.com/mathml-refresh/mathml-core/pulls/'
              }]
          }],
          localBiblio: {
              "MATHML4": {
                  title: "Mathematical Markup Language (MathML) Version 4.0",
                  authors: [
                      "David Carlisle et al."
                  ],
                  status: "WD",
                  href: "https://mathml-refresh.github.io/mathml/"
              },
              "gperf": {
                  title: "gperf - Perfect Hash Function Generator",
                  href: "https://www.gnu.org/software/gperf"
              },
              "CMPH": {
                  title: "CMPH - C Minimal Perfect Hashing Library",
                  authors: [
                      "Fabiano Cupertino Botelho et al."
                  ],
                  href: "http://cmph.sourceforge.net/index.html"
              },
              "TEXBOOK": {
                  title: "The TeXBook",
                  date: "1984",
                  authors: [
                      "Knuth, Donald E."
                  ],
                  publisher: "Addison-Wesley Professional",
                  id: "ISBN9780201134483"
              },
              "OPEN-TYPE-MATH-ILLUMINATED": {
                  title: "OpenType Math Illuminated",
                  date: "2009",
                  authors: [
                      "Ulrik Vieth"
                  ],
                  href: "http://www.tug.org/TUGboat/tb30-1/tb94vieth.pdf",
              },
              "OPEN-TYPE-MATH-IN-HARFBUZZ": {
                  title: "OpenType MATH in HarfBuzz",
                  authors: [
                      "Frédéric Wang"
                  ],
                  href: "http://frederic-wang.fr/opentype-math-in-harfbuzz.html"
              }
          },
          preProcess: [initReport],
          postProcess: [sorttable.init, loadWebPlaformTestsResults]
      };
    </script>
  </head>
  <body>
    <div id="implementation-report"></div>
    <section id="abstract">
      <p>
        This specification defines a core subset of Mathematical Markup
        Language, or MathML, that is suitable for browser implementation.
        MathML is a markup language for describing mathematical notation
        and capturing both its structure and content. The goal of MathML is to
        enable mathematics to be served, received, and processed on the World
        Wide Web, just as HTML has enabled this functionality for text.
      </p>
    </section>
    <section id="sotd">
      <p>
        This is a public copy of the editors’ draft. It is provided for
        discussion only and may change at any moment. Its publication here does
        not imply endorsement of its contents by W3C. Don’t cite this document
        other than as work in progress.
      </p>
    </section>
    <section class="informative">
      <h2>Introduction</h2>
      <p>
        The [[MATHML3]] specification has several shortcomings that make it
        hard to implement consistently across web rendering engines or to
        extend with user-defined constructions e.g.
      </p>
      <ul>
        <li>It is a huge and standalone specification.</li>
        <li>It does not contain any detailed rendering rules.</li>
        <li>It is not driven by browser-implementation.</li>
        <li>It lacks automated testing.</li>
      </ul>
      <p>
        This MathML Core specification intends to address these issues by
        being as accurate as possible on the visual rendering of mathematical
        formulas using additional rules from the TeXBook’s Appendix G
        [[?TEXBOOK]] and from the Open Font Format [[OPEN-FONT-FORMAT]],
        [[OPEN-TYPE-MATH-ILLUMINATED]]. It also relies on modern browser
        implementations and web technologies [[HTML]] clarifying interactions
        with them when needed or introducing new low-level primitives to
        improve the web platform layering. Parts of MathML3 that do not
        fit well in this framework or are rarely used in practice have been
        omitted. Instead, they are described in a separate and larger
        [[MATHML4]] specification.
      </p>
      <p>
        By increasing the level of implementation details, focusing on a
        workable subset, following a browser-driven design and relying on
        automated web platform tests, this specification is expected to
        greatly improve MathML interoperability. Moreover, effort on MathML
        layering will enable users to implement the rest of the MathML 4
        specification, or more generally to extend MathML Core, using
        modern web technologies such as shadow DOM, custom elements,
        CSS layout API or other Houdini APIs.
      </p>
      <div class="warning">
        The MathML Refresh Community Group is still deciding what will go
        in MathML Core and what should instead be implemented as
        custom extensions. In particular, the list of
        MathML elements/attributes, TeX/OpenType features and
        supported CSS properties is not frozen yet.
        Additionally, new HTML5 features, CSS properties and Javascript APIs
        will be designed in order to allow authors to write better MathML
        web components.
      </div>
      <div class="issue" data-number="137">Add MathML examples to the spec.</div>
    </section>
    <section class="normative">
      <h2>MathML Fundamentals</h2>
      <section>
        <h3>Integration in the Web Platform</h3>
        <section id="mathml-elements">
          <h3>XML</h3>
          <p>
            The term <dfn>MathML element</dfn> refers to any element in the
            <a data-cite="INFRA#mathml-namespace">MathML namespace</a>.
            The MathML element defined in this specification are called the
            <dfn>MathML Core elements</dfn> and are listed below.
            Any MathML element that is not listed below is called an
            <dfn>Unknown MathML element</dfn>.
          </p>
          <ol>
            <li><a>&lt;annotation&gt;</a></li>
            <li><a>&lt;annotation-xml&gt;</a></li>
            <li><a>&lt;maction&gt;</a></li>
            <li><a>&lt;math&gt;</a></li>
            <li><a>&lt;menclose&gt;</a></li>
            <li><a>&lt;merror&gt;</a></li>
            <li><a>&lt;mfrac&gt;</a></li>
            <li><a>&lt;mi&gt;</a></li>
            <li><a>&lt;mmultiscripts&gt;</a></li>
            <li><a>&lt;mn&gt;</a></li>
            <li><a>&lt;mo&gt;</a></li>
            <li><a>&lt;mover&gt;</a></li>
            <li><a>&lt;mpadded&gt;</a></li>
            <li><a>&lt;mphantom&gt;</a></li>
            <li><a>&lt;mprescripts&gt;</a></li>
            <li><a>&lt;mroot&gt;</a></li>
            <li><a>&lt;mrow&gt;</a></li>
            <li><a>&lt;ms&gt;</a></li>
            <li><a>&lt;mspace&gt;</a></li>
            <li><a>&lt;msqrt&gt;</a></li>
            <li><a>&lt;mstyle&gt;</a></li>
            <li><a>&lt;msub&gt;</a></li>
            <li><a>&lt;msubsup&gt;</a></li>
            <li><a>&lt;msup&gt;</a></li>
            <li><a>&lt;mtable&gt;</a></li>
            <li><a>&lt;mtd&gt;</a></li>
            <li><a>&lt;mtext&gt;</a></li>
            <li><a>&lt;mtr&gt;</a></li>
            <li><a>&lt;munder&gt;</a></li>
            <li><a>&lt;munderover&gt;</a></li>
            <li><a>&lt;none&gt;</a></li>
            <li><a>&lt;semantics&gt;</a></li>
          </ol>
          <p>The <dfn>mrow-like elements</dfn> are
            <a>&lt;maction&gt;</a>,
            <a>&lt;math&gt;</a>,
            <a>&lt;merror&gt;</a>
            <a>&lt;mphantom&gt;</a>,
            <a>&lt;mprescripts&gt;</a>,
            <a>&lt;mrow&gt;</a>,
            <a>&lt;mstyle&gt;</a>,
            <a>&lt;none&gt;</a>,
            <a>&lt;semantics&gt;</a> and <a>unknown MathML elements</a>.</p>
          <p>The <dfn>scripted elements</dfn> are
            <a>&lt;mmultiscripts&gt;</a>,
            <a>&lt;mover&gt;</a>,
            <a>&lt;msub&gt;</a>,
            <a>&lt;msubsup&gt;</a>,
            <a>&lt;msup&gt;</a>,
            <a>&lt;munder&gt;</a> and
            <a>&lt;munderover&gt;</a>.
          </p>
          <p>The <dfn>radical elements</dfn> are
            <a>&lt;mroot&gt;</a> and <a>&lt;msqrt&gt;</a>.
          </p>
          <p>
            The attributes defined in this specification are called
            <dfn>MathML attributes</dfn> and have no namespace.
          </p>
        </section>
        <section id="html-and-svg">
          <h4>HTML and SVG</h4>
          <div class="issue" data-number="103">mpadded?</div>
          <div class="issue" data-number="105">menclose?</div>
          <div class="issue" data-number="120">ms?</div>
          <div class="issue" data-number="25">mglyph?</div>
          <div class="issue" data-number="72">mlabeledtr?</div>
          <p>
            When
            <a data-cite="HTML#parsing">parsing HTML documents</a>
            user agents must treat any tag name corresponding to a
            <a>MathML Core Element</a> as belonging to the
            <a data-cite="INFRA#mathml-namespace">MathML namespace</a>.
          </p>
          <p>
            Users agents must allow mixing HTML, SVG and MathML elements
            as allowed by sections
            <a data-cite="HTML#html-integration-point">HTML integration point</a>,
            <a data-cite="HTML#mathml-text-integration-point">MathML integration point</a>,
            <a data-cite="HTML#tree-construction-dispatcher">tree construction
              dispatcher</a>,
            <a data-cite="HTML#mathml">MathML</a> and
            <a data-cite="HTML#svg-0">SVG</a>
            from [[HTML]].
          </p>
          <p>
            When evaluating the SVG
            <a data-cite="SVG#RequiredExtensionsAttribute"><code>requiredExtensions</code></a>
            attribute, user agents must claim support for the language extension
            identified by the
            <a data-cite="INFRA#mathml-namespace">MathML namespace</a>.
          </p>
          <div class="note">
            <ul>
              <li>
                The <code>&lt;math&gt;</code> element can be used at
                position permitted for
                <a data-cite="HTML#flow-content-2">flow content</a>
                (e.g. a
                <a data-cite="SVG#ForeignObjectElement"><code>&lt;foreignObject&gt;</code></a> element)
                or <a data-cite="HTML#phrasing-content-2">phrasing content</a>.
              </li>
              <li>
                Any
                <a data-cite="HTML#phrasing-content-2">phrasing content</a>
                can be used inside
                <a><code>&lt;mi&gt;</code></a>,
                <a><code>&lt;mo&gt;</code></a>,
                <a><code>&lt;mn&gt;</code></a>,
                <a><code>&lt;ms&gt;</code></a> and
                <a><code>&lt;mtext&gt;</code></a>
                elements.
              </li>
              <li>
                The <code>&lt;svg&gt;</code> element can be used inside
                <a><code>&lt;annotation-xml&gt;</code></a> elements.
              </li>
              <li>
                Any <a data-cite="HTML#flow-content-2">flow content</a>
                can be used inside
                <a><code>&lt;annotation-xml&gt;</code></a> elements with
                encoding
                <code>application/xhtml+xml</code> or <code>text/html</code>.
              </li>
            </ul>
          </div>
        </section>
        <section id="css-styling">
          <h4>CSS styling</h4>
          <p>User agents must support various CSS features mentioned in this
            specification, including new ones described in
            <a href="#css-extensions-for-math-layout"></a>.
            They must follow the computation rule for
            <a data-cite="CSS-DISPLAY-3#unbox-mathml">display: contents</a>.
          </p>
          <p>
            All documents containing <a>MathML Core elements</a> must include
            CSS rules described in <a href="#user-agent-stylesheet"></a>
            as part of user-agent level style sheet defaults.
            Rules relying on universal selectors such as
            <code>mfrac > *</code> or <code>msub > :not(:first-child)</code> may
            be replaced with equivalent expanded rules listing all possible
            <a>MathML Core elements</a>.
          </p>
          <div class="issue">
            Only restrict this to
            <code>display: math</code> elements and set a default
            style on <code>&lt;math&gt;</code> root and tabular elements?
          </div>
          <p>
            The following CSS features are not supported and
            must be ignored:
          </p>
          <ul>
            <li>Vertical math layout:
              <code>writing-mode</code>
              is treated as <code>horizontal-tb</code> on all MathML
              elements.</li>
            <li>
              Line breaking inside math formulas:
              <code>white-space</code>
              is treated as <code>nowrap</code> on all MathML elements.
            </li>
            <li>
              Sizes:
              <code>width</code>,
              <code>height</code>,
              <code>inline-size</code> and
              <code>block-size</code>
              are treated as <code>auto</code> on elements
              with computed display value <a href="#new-display-math-value"><code>math</code></a>.
            </li>
            <li>
              Floats:
              <code>float</code> and <code>clear</code>
              are treated as <code>none</code> on all MathML elements.
            </li>
            <li>
              Alignment properties:
              <code>align-content</code>, <code>justify-content</code>,
              <code>align-self</code>, <code>justify-self</code> have
              no effect on MathML elements.
            </li>
          </ul>
          <div class="warning">
            These features might be handled in future versions of this document.
            For now, authors are discouraged from setting a different value for
            these properties as that might lead to backward incompatibility
            issues.
          </div>
      <div class="issue" data-number="94">links and focusable elements?</div>
          <div class="issue" data-number="18">vertical writing mode support</div>
          <div class="issue" data-number="112">Define MathML line breaking?</div>
          <div class="issue" data-number="16">Support floats?</div>
          <div class="issue" data-number="129">Support for CSS alignment properties</div>
          <div class="issue" data-number="34">text-indent, line-height, word-spacing, letter-spacing?</div>
          <div class="issue" data-number="35">CSS writing-mode and direction on the math root?</div>
          <div class="issue" data-number="36">font-style and font-weight on the math root?</div>
        </section>
        <section id="dom-and-javascript">
          <h4>DOM and Javascript</h4>
          <div class="issue" data-number="138">Custom MathML elements?</div>
          <div class="issue" data-number="139">Should <a>unknown MathML elements</a> specialize to a MathMLUnknownElement interface?</div>
          <div class="issue" data-number="140">Element.attachShadow()?</div>
          <p>
            User agents supporting
            <a data-cite="HTML#webappapis">Web application APIs</a>
            must ensure that they keep the visual rendering of MathML
            in synchronization with the [[DOM]] tree.
          </p>
          <div class="issue">
            <a href="https://github.com/whatwg/html/issues/4751">Rename
              HTMLOrSVGElement</a> and define MathMLElement in [[HTML]]?
          </div>
          <div class="issue">
            <code>HTMLElement includes ElementCSSInlineStyle;</code>
            should be moved to the [[CSSOM]] specification.
          </div>
          <p>
            All the nodes representing <a>MathML elements</a> in the DOM
            must implement, and expose to scripts, the following
            <dfn><code>MathMLElement</code></dfn> interface.
          </p>
          <pre class="idl" data-include="webidl/MathMLElement.idl"></pre>
          <p>The
            <dfn data-cite="HTML#globaleventhandlers"><code>GlobalEventHandlers</code></dfn>,
            <dfn data-cite="HTML#documentandelementeventhandlers"><code>DocumentAndElementEventHandlers</code></dfn> and
            <dfn data-cite="HTML#htmlorsvgelement"><code>HTMLOrForeignElement</code></dfn> interfaces are defined in
            [[HTML]].</p>
          <p>The
            <dfn data-cite="CSSOM#elementcssinlinestyle"><code>ElementCSSInlineStyle</code></dfn>
            interface is defined in [[CSSOM]].
          </p>
          <p>Each IDL attribute of the
            <a><code>MathMLElement</code></a> interface
            <a data-cite="HTML#reflect">reflects</a> the
            corresponding MathML
            <a href="#global-attributes">content attribute</a>.
          </p>
          <p>
            All of the nodes representing <a>MathML Hyperlink Elements</a> in the DOM must implement, and expose to scripts the following <dfn><code>MathMLLinkableElement</code></dfn> interface.
          </p>
          <pre class="idl" data-include="webidl/MathMLLinkableElement.idl"></pre>
        </section>
        <section id="text-layout">
          <h4>Text layout</h4>
          <p>
            Because math fonts generally contain very tall glyphs such as big
            integrals, using typographic metrics is important to avoid
            excessive line spacing of text. As a consequence,
            user agents must take into account the USE_TYPO_METRICS flag from
            the OS/2 table [[OPEN-FONT-FORMAT]] when performing text layout.
          </p>
        </section>
        <section id="focus">
            <h4>Focus</h4>
            <div class="issue" data-number="94">User Agent style for href hyperlinks and focusable elements</div>
            <p>
              MathML provides the ability for authors to allow for
              interactivity in supporting interactive user agents
              using the same concepts, approach and guidance to
              <a data-cite="HTML#focus"><code>Focus</code></a>
              as described in HTML, with modifications or
              clarifications regarding application
              for MathML as described in this section.
            </p>
            <p>
              When an element is focused, all applicable CSS
              focus-related pseudo-classes as defined in
              <a data-cite="SELECT#overview">CSS Selectors</a>
              apply, as defined in that specification.
            </p>
            <p>
              All <code>MathMLLinkableElement</code> elements are potentially linkable with an <code>href</code> attribute.  Their default tabindex is <code>0</code>.  If their <code>href</code> contains a valid URL, their focus flag must be set unless the user agent normally provides an alternative
              method of keyboard traversal of links, and they appear in the
              sequential focus order.
            </p>
            <p>
              The contents of embedded <code>&lt;math&gt;</code> elements
              (including HTML elements inside token elements),
              contribute to the sequential focus order of the containing owner HTML
              document (combined sequential focus order).
            </p>
        </section>
      </section>
      <section id="types-for-mathml-attribute-values">
        <h3>Types for MathML Attribute Values</h3>
        <div class="issue" data-number="122">Trimming of whitespace in attribute?</div>
        <dl>
          <dt><dfn>unsigned-integer</dfn></dt>
          <dd>An
            <a data-cite="CSS-VALUES-3#integer-value"><code>&lt;integer-value&gt;</code></a> value as defined in
            [[CSS-VALUES-3]], whose first character is neither
            U+002D HYPHEN-MINUS character (-) nor
            U+002B PLUS SIGN (+).
          </dd>
        </dl>
        <dl>
          <dt><dfn>unsigned-number</dfn></dt>
          <dd>A
            <a data-cite="CSS-VALUES-3#number-value"><code>&lt;number-value&gt;</code></a> value as defined in
            [[CSS-VALUES-3]], whose first character is neither
            U+002D HYPHEN-MINUS character (-) nor
            U+002B PLUS SIGN (+).
          </dd>
        </dl>
        <dl>
          <dt><dfn>length-percentage</dfn></dt>
          <dd>A
            <a data-cite="CSS-VALUES-3#typedef-length-percentage"><code>&lt;length-percentage&gt;</code></a>
            value as defined in
            [[CSS-VALUES-3]]
          </dd>
        </dl>
        <dl>
          <dt><dfn>unsigned-length-percentage</dfn></dt>
          <dd>A
            <a><code>length-percentage</code></a>
            whose first character is neither
            U+002D HYPHEN-MINUS character (-) nor
            U+002B PLUS SIGN (+).
          </dd>
        </dl>
        <dl>
          <dt><dfn>color</dfn></dt>
          <dd>A
            <a data-cite="CSS-COLOR-3#colorunits"><code>&lt;color&gt;</code></a>
            value as defined in [[CSS-COLOR-3]]
          </dd>
        </dl>
        <dl>
          <dt><dfn>boolean</dfn></dt>
          <dd>A string that is an
            <a data-cite="INFRA#ascii-case-insensitive">ASCII case-insensitive</a>
            match to <code>true</code> or
            <code>false</code>.
          </dd>
        </dl>
      </section>
      <section>
        <h3>Global Attributes</h3>
        <p>
          The following attributes are common to and may be specified on all MathML
          elements:
        </p>
        <ul>
          <li><a>id</a></li>
          <li><a>class</a></li>
          <li><a><code>style</code></a></li>
          <li><a><code>data-*</code></a></li>
          <li><a><code>dir</code></a></li>
          <li><a><code>displaystyle</code></a></li>
          <li><a><code>mathbackground</code></a></li>
          <li><a><code>mathcolor</code></a></li>
          <li><a><code>mathsize</code></a></li>
          <li><a><code>mathvariant</code></a></li>
          <li><a><code>nonce</code></a></li>
          <li><a><code>scriptlevel</code></a></li>
          <li><a><code>style</code></a></li>
          <li><a><code>tabindex</code></a></li>
          <li><a>class</a></li>
          <li><a>id</a></li>
          <li><a href="#event-handler-content-attributes"><code>on*</code> event handler attributes</a></li>
        </ul>
        <section id="attributes-common-to-html-and-mathml-elements">
          <h4>Attributes common to HTML and MathML elements</h4>
          <p>
            The
            <dfn><code>id</code></dfn>,
            <dfn><code>class</code></dfn>,
            <dfn><code>style</code></dfn>,
            <dfn><code>data-*</code></dfn>,
            <dfn><code>nonce</code></dfn> and
            <dfn><code>tabindex</code></dfn>
            attributes have the same syntax and semantic as defined for
            <a data-cite="HTML#the-id-attribute">id</a>,
            <a data-cite="HTML#classes">class</a>,
            <a data-cite="HTML#the-style-attribute">style</a>,
            <a data-cite="HTML#embedding-custom-non-visible-data-with-the-data-*-attributes">data-*</a>,
            <a data-cite="HTML#embedding-custom-non-visible-data-with-the-data-*-attributes">nonce</a> and
            <a data-cite="HTML#embedding-custom-non-visible-data-with-the-data-*-attributes">tabindex</a>
            attributes on HTML elements.
          </p>
          <div class="issue" data-number="125">Should all MathML elements really be potential hyperlinks / match :visited?</div>
          <div class="issue" data-number="94">User Agent style for href hyperlinks and focusable elements</div>
          <p>
            The
            <dfn><code>href</code></dfn>
            attribute has the same syntax and semantic as defined for
            the <a data-cite="HTML#attr-hyperlink-href">href</a> attribute on
            <code>&lt;a&gt;</code> element.
            To fully implement this attribute, the following CSS properties for
            links must be specified in the
            <a href="#user-agent-stylesheet">user agent stylesheet</a>:
          </p>
          <pre class="css" data-include="user-agent-stylesheet/links.css"></pre>
          <p>
            The
            <dfn><code>dir</code></dfn>
            attribute, if present,
            must be an
            <a data-cite="INFRA#ascii-case-insensitive">ASCII case-insensitive</a> match
            to <code>ltr</code> or <code>ltr</code>.
            It is mapped to the
            <a data-cite="CSS-WRITING-MODES-3#direction"><code>direction</code></a>
            CSS property.
            This attribute is used to set the directionality of math formulas, which is
            often <code>rtl</code> in Arabic speaking world.
          </p>
          <section id="event-handler-content-attributes">
            <h5>Event Handler Content Attributes</h5>
            <p>
              All MathML elements support event handler content attributes,
              as described in  <a data-cite="HTML#event-handler-contentattributes">event handler content attributes</a> in HTML.
            </p>
            <p>
              All event handler content attributes
              <a data-cite="HTML#event-handlers-on-elements,-document-objects,-and-window-objects">noted by HTML as being supported by all HTMLElements</a>
              are supported by all MathML elements as well, as defined in the <a href="#dom-and-javascript">MathMLElement IDL</a>.
            </p>
          </section>
        </section>
        <section id="legacy-mathml-style-attributes">
          <h4>Legacy MathML Style Attributes</h4>
          <p>
            The
            <dfn><code>mathcolor</code></dfn>
            and
            <dfn><code>mathbackground</code></dfn>
            attributes, if present, must
            have a value that is a <a>color</a>.
            The <code>mathcolor</code> property describes the foreground fill color of
            an MathML text, bars etc and the background color of an element.
            They are mapped to the
            <a data-cite="CSS-COLOR-3#foreground"><code>color</code></a> and
            <a data-cite="CSS-BACKGROUNDS-3#the-background-color"><code>background-color</code></a> CSS properties.
          </p>
          <p>
            The
            <dfn><code>mathsize</code></dfn>
            attribute, if present, must
            have a value that is a valid <a>length-percentage</a>.
            The <code>mathsize</code> property indicates indicates the desired height
            of glyphs in math formulas but also scale other parts (spacing, shifts,
            line thickness of bars etc) accordingly.
            It is mapped to the CSS property
            <a><code>font-size</code></a>
            and the <code>mathsize</code> values are interpreted according to the
            definition in [[CSS-FONTS-4]].
          </p>
          <div class="note">
		    The above attributes are implemented for compatibility with full MathML. Authors whose only target is MathML Core are encouraged to use CSS for styling.
          </div>
        </section>
        <section id="the-mathvariant-attribute">
          <h4>The <code>mathvariant</code> attribute</h4>
          <p>
            The
            <dfn><code>mathvariant</code></dfn>
            attribute,
            if present, must be an
            <a data-cite="INFRA#ascii-case-insensitive">ASCII case-insensitive</a>
            match to one of:
            <code>normal</code>,
            <code>bold</code>,
            <code>italic</code>,
            <code>bold-italic</code>,
            <code>double-struck</code>,
            <code>bold-fraktur</code>,
            <code>script</code>,
            <code>bold-script</code>,
            <code>fraktur</code>,
            <code>sans-serif</code>,
            <code>bold-sans-serif</code>,
            <code>sans-serif-italic</code>,
            <code>sans-serif-bold-italic</code>,
            <code>monospace</code>,
            <code>initial</code>,
            <code>tailed</code>,
            <code>looped</code>, or
            <code>stretched</code>.
          </p>
          <p>
            The <code>mathvariant</code> attribute defines logical classes of token
            elements. Each class provides a collection of typographically-related
            symbolic tokens with specific meaning within a given mathematical
            expression.
            For <code>mathvariant</code> values other than <code>normal</code>,
            this is done by using glyphs of
            Unicode's Mathematical Alphanumeric Symbols.
          </p>
          <p>
            Hence, the <code>mathvariant</code> attribute
            is mapped to new values of the CSS property
            <a><code>text-transform</code></a>.
            More precisely, <code>normal</code> is mapped to <code>none</code>
            while all the other values the corresponding CSS value with the extra
            <code>math-</code> prefix.
          </p>
          <div class="note">
		        <code>mathvariant</code> values other than <code>normal</code>
            are implemented for compatibility with full MathML and legacy editors that can't access characters in Plane 1 of Unicode. Authors are encouraged to use the corresponding Unicode characters.
            The <code>normal</code> value is still important to cancel automatic
            italic of the <a><code>&lt;mi&gt;</code></a> element.
          </div>
          <div class="issue" data-number="61">
            Consider a new script style to distinguish Chancery and Spencerian?
          </div>
          <div class="note">
            Unicode does not distinguish between Chancery and Spencerian style
            for the Unicode MATHEMATICAL SCRIPT characters. However, some
            mathematical fonts rely on <code>salt</code> or
            <code>ssXY</code> properties from [[OPEN-FONT-FORMAT]]
            to provide both styles. Page authors may use the
            <a data-cite="CSS-FONTS-4#font-variant-alternates-prop"><code>font-variant-alternates</code></a> property with corresponding OpenType font features
            to access these glyphs.
          </div>
        </section>
        <section id="the-displaystyle-and-scriptlevel-attributes">
          <h4>The <code>displaystyle</code> and <code>scriptlevel</code> attributes</h4>
          <p>
            The
            <dfn><code>displaystyle</code></dfn>
            attribute, if present, must have a value that is a <a>boolean</a>.
            It is mapped to the CSS property <a><code>math-style</code></a>.
            More precisely,  <code>true</code> is mapped to <code>display</code> and
            <code>false</code> to  <code>inline</code>.
            This attribute indicate whether formulas should try to minimize
            the logical height (value is <code>false</code>) or not
            (value is <code>true</code>) e.g. by changing the size of content or
            the layout of scripts.
          </p>
          <p>
            The
            <dfn><code>scriptlevel</code></dfn>
            attribute, if present, must have value
            <code>+&lt;U&gt;</code>, <code>-&lt;U&gt;</code> or <code>&lt;U&gt;</code>
            where <code>&lt;U&gt;</code> is an
            <a>unsigned-integer</a>.
            If the <a>mathsize</a> attribute is absent, it is
            mapped to the <a><code>font-size</code></a> property.
            More precisely,
            <code>+&lt;U&gt;</code>, <code>-&lt;U&gt;</code> and
            <code>&lt;U&gt;</code>
            are respectively mapped to
            <code>scriptlevel(add(&lt;U&gt;))</code>
            <code>scriptlevel(add(&lt;-U&gt;))</code>
            and <code>scriptlevel(&lt;U&gt;)</code>.
          </p>
          <p>
            <a><code>displaystyle</code></a> and <a><code>scriptlevel</code></a> values
            are automatically adjusted within MathML elements.
            To fully implement these attributes, additional CSS properties must be
            specified in the user agent stylesheet
            as described in <a href="#user-agent-stylesheet"></a>.
          </p>
          <div class="note">
            T<sub>E</sub>X's <code>\displaystyle</code>, <code>\textstyle</code>,
            <code>\scriptstyle</code>, and <code>\scriptscriptstyle</code> correspond
            to <a><code>displaystyle</code></a> and <a><code>scriptlevel</code></a> as
            <code>true</code> and <code>0</code>,
            <code>false</code> and <code>0</code>,
            <code>false</code> and <code>1</code>,
            and <code>false</code> and 2, respectively.
          </div>
        </section>
      </section>
      <section id="the-top-level-math-element">
        <h3>The Top-Level <code>&lt;math&gt;</code> Element</h3>
        <p>MathML specifies a single top-level or root
          <dfn><code>&lt;math&gt;</code></dfn> element, which encapsulates each
          instance of MathML markup within a document. All other MathML content
          must be contained in a <code>&lt;math&gt;</code> element.
        </p>
        <p>
          The <code>&lt;math&gt;</code>
          element accepts the attributes described
          in <a href="#global-attributes"></a> as well as the
          following attribute:
        </p>
        <ul>
          <li><a>display</a></li>
        </ul>
        <p>
          The
          <dfn><code>display</code></dfn>
          attribute, if present,
          must be an
          <a data-cite="INFRA#ascii-case-insensitive">ASCII case-insensitive</a>
          match
          to <code>block</code> or <code>inline</code>.
          To fully implement this attribute, additional CSS properties must be
          specified in the user agent stylesheet
          as described in <a href="#user-agent-stylesheet"></a>.
        </p>
        <div class="issue" data-number="56">Improve layout description. Since
          the <code>math</code> element is already <code>inline</code> or
          <code>block</code> display, it should probably generate an anonymous
          mrow-like box container?
        </div>
        <p>
          The layout algorithm of the <code>&lt;math&gt;</code> element
          is the same as the <a><code>&lt;mrow&gt;</code></a> element. User agents must
          ensure correct baseline alignment, centering, sizing etc of the
          <code>&lt;math&gt;</code> element.
        </p>
        <div class="note">
          T<sub>E</sub>X's display mode <code>$...$</code>
          and inline mode <code>$...$</code> correspond to
          <code>display="block"</code> and <code>display="inline"</code>
          respectively.
        </div>
        <p>Because good mathematical rendering requires use of mathematical
          fonts, the
          <a href="#user-agent-stylesheet">user agent stylesheet</a>
          should set the
          <a data-cite="CSS-FONTS-4#font-family-prop"><code>font-family</code></a>
          to the
          <a data-cite="CSS-FONTS-4#valdef-font-family-math"><code>math</code></a>
          value on the <code>&lt;math&gt;</code> element instead of inheriting
          it.
        </p>
      </section>
      <section id="linkable-math-elements">
        <h3><dfn>MathML Hyperlink Elements</dfn></h3>
        <p>All <a href="#token-elements">token elements</a> and the <a href="#horizontally-group-sub-expressions-mrow">mrow</a> grouping element are potentially linkable and may contain an <code>href</code> attribute.  They are the MathML equivalents of HTML's <a data-cite="html#the-a-element">a</a> and must follow all of the same criteria laid out for links there.</p>
      </section>
    </section>
    <section class="normative">
      <h2>Presentation Markup</h2>
      <section>
        <h3>Visual formatting model</h3>
        <section>
          <h4>Box Model</h4>
          <p>
            The default <a><code>display</code> property</a>
            is described in <a href="#user-agent-stylesheet"></a>:
          </p>
          <ul>
            <li>
              For the <code>&lt;math&gt;</code> root,
              <code>inline</code>
              if the

              or <code>block</code> according to the
              value of the <a>display</a> attribute.
            </li>
            <li>
              For <a href="#tabular-math">Tabular MathML elements</a>
              <a><code>&lt;mtable&gt;</code></a>,
              <a><code>&lt;mtr&gt;</code></a>,
              <a><code>&lt;mtd&gt;</code></a> it respectively
              <code>inline-table</code>,
              <code>table-row</code> and
              <code>table-cell</code>.
            </li>
            <li>
              For all the other <a>MathML elements</a> it is <code>math</code>.
            </li>
          </ul>
          </p>
          <div class="issue" data-number="18">vertical writing mode support</div>
          <p>
            In order to specify math layout in different
            <a data-cite="CSS-WRITING-MODES-3#writing-mode">writing modes</a>,
            this specification uses concepts from [[CSS-WRITING-MODES-3]]:
          </p>
          <ul>
            <li>
              <a data-cite="CSS-WRITING-MODES-3#abstract-dimensions">abstract dimensions</a>:
              <a data-cite="CSS-WRITING-MODES-3#block-dimension"><dfn>block dimension</dfn></a>,
              <a data-cite="CSS-WRITING-MODES-3#inline-dimension"><dfn>inline dimension</dfn></a>,
              <a data-cite="CSS-WRITING-MODES-3#block-axis"><dfn>block axis</dfn></a>,
              <a data-cite="CSS-WRITING-MODES-3#inline-axis"><dfn>inline axis</dfn></a>,
              <a data-cite="CSS-WRITING-MODES-3#block-size"><dfn>block size</dfn></a>,
              <a data-cite="CSS-WRITING-MODES-3#inline-size"><dfn>inline size</dfn></a>.
            </li>
            <li>
              <a data-cite="CSS-WRITING-MODES-3#logical-directions">flow-relative directions</a>:
              <a data-cite="CSS-WRITING-MODES-3#inline-start"><dfn>inline-start</dfn></a>,
              <a data-cite="CSS-WRITING-MODES-3#inline-end"><dfn>inline-end</dfn></a>,
              <a data-cite="CSS-WRITING-MODES-3#block-start"><dfn>block-start</dfn></a>,
              <a data-cite="CSS-WRITING-MODES-3#block-end"><dfn>block-end</dfn></a>.
            </li>
            <li>
              <a data-cite="CSS-WRITING-MODES-3#line-relative-direction">line-relative directions</a>:
              <a data-cite="CSS-WRITING-MODES-3#line-left"><dfn>line-left</dfn></a>,
              <a data-cite="CSS-WRITING-MODES-3#line-right"><dfn>line-right</dfn></a>,
              <a data-cite="CSS-WRITING-MODES-3#line-over"><dfn>line-over</dfn></a>,
              <a data-cite="CSS-WRITING-MODES-3#line-under"><dfn>line-under</dfn></a>.
            </li>
          </ul>
          </p>
          <div class="note">
            Unless specified otherwise,
            the figures in this specification use a
            <a data-cite="CSS-WRITING-MODES-3#writing-mode">writing mode</a>
            of <code>horizontal-lr</code> and <code>ltr</code>.
            See <a href="#box-model-horizontal-tb-rtl"></a>,
            <a href="#box-model-vertical-lr"></a> and
            <a href="#box-model-vertical-rl"></a> for examples of other
            writing modes that are sometimes used for math layout.
          </div>
          <div class="issue" data-number="128">ink ascent/descent</div>
          <p>
            MathML boxes have several parameters in order to layout in
            a way that is compatible with CSS but also to take into account
            very accurate positions and spacing within math formulas.
            Each math box has the following parameters:
          </p>
          <ol>
            <li>Inline metrics.
              <a data-cite="CSS-SIZING-3#min-content-inline-size"><dfn>min-content inline size</dfn></a>,
              <a data-cite="CSS-SIZING-3#max-content-inline-size"><dfn>max-content inline size</dfn></a> and
              <a>inline size</a>
              from CSS. See <a href="#box-model-generic"></a>.
              <figure id="box-model-generic">
                <img src="figures/horizontal-tb-ltr.svg"/>
                <figcaption>Generic Box Model for MathML elements</figcaption>
              </figure>
            </li>
            <li>
              <p>
                Block metrics.
                The <a>block size</a>,
                <a data-cite="CSS-ALIGN-3#first-baseline-set"><dfn>first baseline set</dfn></a>
                and
                <a data-cite="CSS-ALIGN-3#last-baseline-set"><dfn>last baseline set</dfn></a>.
                The following <a data-cite="CSS-WRITING-MODES-3#intro-baselines"><dfn>baselines</dfn></a> are defined for MathML boxes:
              </p>
              <ol>
                <li>
                  The <dfn>alphabetic baseline</dfn>
                  which typically aligns with the bottom of uppercase Latin
                  glyphs. The algebric distance from the
                  <a>alphabetic baseline</a> to the <a>line-over</a> edge of the box is the called
                  <dfn>line-ascent</dfn>. The algebric distance from the
                  <a>line-under</a> edge to the <a>alphabetic baseline</a> of the box
                  is the called <dfn>line-descent</dfn>.
                </li>
                <li>
                  The <dfn>mathematical baseline</dfn> also called
                  <dfn>math axis</dfn> which typically aligns with the fraction
                  bar, middle of fences and binary operators. It is shifted away from the <a>alphabetic baseline</a> by <a>AxisHeight</a> towards the <a>line-over</a>.
                </li>
                <li>
                  The <dfn>ink-over baseline</dfn>, indicating the <a>line-over</a>
                  theorical limit of the content drawn, excluding any
                  extra space.
                  If not specified, it is aligned with the <a>line-over</a> edge.
                  The algebric distance from the <a>alphabetic baseline</a> to
                  the <a>ink-over baseline</a> is called the
                  <dfn>ink line-ascent</dfn>.
                </li>
                <li>
                  The <dfn>ink-under baseline</dfn>, indicating the <a>line-under</a>
                  theorical limit of the content drawn, excluding any
                  extra space.
                  If not specified, it is aligned with the <a>line-under</a> edge.
                  The algebric distance from the <a>ink-under baseline</a>
                  to the <a>alphabetic baseline</a> is called the
                  <dfn>ink line-descent</dfn>.
                </li>
              </ol>
              <div class="note">
                For math layout, it is very important to rely on the ink extent
                when positioning text. This is not the case for more complex
                notations (e.g. square root).
                Although ink-ascent and ink-descent are defined for
                all MathML elements they are really only used for the token
                elements. In other cases, they just match normal ascent and
                descent.
              </div>
              <div class="issue" data-number="112">Define MathML line breaking?</div>
              Unless specified otherwise, the <a>last baseline set</a> is equal to the
              <a>first baseline set</a> for MathML boxes.
            </li>
            <li>
              An optional <dfn>italic correction</dfn>
              which provides a measure of how much the text of a box is
              slanted along the <a>inline axis</a>.
              See <a href="#figure-italic-correction"></a>.
              <figure id="figure-italic-correction">
                <img src="figures/italcorr.svg"/>
                <figcaption>Examples of italic correction for italic f and large integral</figcaption>
              </figure>
              If it is requested during calculation of
              <a>min-content inline size</a> and
              <a>max-content inline size</a> or during layout
              then 0 is used as a fallback value.
            </li>
            <li>
              An optional <dfn>top accent attachment</dfn>
              which provides a reference offset on the
              <a>inline axis</a> of a box that should be used when
              positioning that box as an accent.
              See <a href="#figure-top-accent-attachment"></a>.
              <figure id="figure-top-accent-attachment">
                <img src="figures/topaccent.svg"/>
                <figcaption>Example of top accent attachment for a circumflex accent</figcaption>
              </figure>
              If it is requested during calculation of
              <a>min-content inline size</a>
              (respectively <a>max-content inline size</a>) then half the
              <a>min-content inline size</a> (respectively <a>max-content inline size</a>) is used as a
              fallback value.
              If it is requested during layout then half the
              inline size of the box is used as a fallback value.
            </li>
          </ol>
          <p>
            Given a MathML box, the <dfn>inline offset</dfn> of a child box
            is the distance between the
            <a>inline-start</a> edge of
            the parent box and the
            <a>inline-start</a> edge
            of the child box.
            The <dfn>block offset</dfn> of a child box is the offset between
            <a>block-start</a> edge of
            the parent box and the
            <a>block-start</a> edge
            of the child box.
          </p>
          <p>
            The <dfn>line-left offset</dfn>,
             <dfn>line-right offset</dfn>,
             <dfn>line-over offset</dfn> and
             <dfn>line-under offset</dfn> are defined similarly
             as offsets between the corresponding parent and child edges.
          </p>
          <figure id="box-model-horizontal-tb-rtl">
            <img src="figures/horizontal-tb-rtl.svg"/>
            <figcaption>Box model for writing mode <code>horizontal-tb</code> and <code>rtl</code> that may be used in e.g. Arabic math.</figcaption>
          </figure>
          <figure id="box-model-vertical-lr">
            <img src="figures/vertical-lr.svg"/>
            <figcaption>Box model for writing mode <code>vertical-lr</code> and <code>ltr</code> that may be used in e.g. Mongolian math.</figcaption>
          </figure>
          <figure id="box-model-vertical-rl">
            <img src="figures/vertical-rl.svg"/>
            <figcaption>Box model for writing mode <code>vertical-rl</code> and <code>ltr</code> that may be used in e.g. Japanese math.</figcaption>
          </figure>
          <div class="note">
            The position of child boxes and graphical items inside a MathML
            box are expressed using the <a>inline offset</a>
            and <a>block offset</a>.
            For convenience, the layout algorithms may describe offsets using
            flow-relative directions, line-relative directions or
            the <a>alphabetic baseline</a>.
            It is always possible to pass from one description to the other
            because position of child boxes are always performed after the
            metrics of the box and of its child boxes are calculated.
          </div>
          <div class="example">
            <p>Here are examples of offsets obtained from line-relative
              metrics:</p>
            <ul>
              <li>
                The <a>inline offset</a> of a child box is
                the <a>line-left offset</a> if the CSS property
                <a data-cite="CSS-WRITING-MODES-3#direction">direction</a>
                is <code>ltr</code> and
                is the <a>inline size</a> of the box −
                (<a>line-left offset</a> + <a>inline size</a> of
                the child box) otherwise.
              </li>
              <li>
                The <a>block offset</a> of the <a>alphabetic baseline</a> of a box
                is the <a>line-ascent</a>
                if the CSS property
                <a data-cite="CSS-WRITING-MODES-3#propdef-writing-mode">writing-mode</a>
                is <code>horizontal-lr</code>,
                <code>vertical-rl</code> or <code>sideways-rl</code>
                and is the <a>line-descent</a> otherwise.
              </li>
            </ul>
          </div>
        </section>
        <section id="layout-algorithms">
          <h4>Layout Algorithms</h4>
          <div class="issue" data-number="16">Handling of out-of-flow elements</div>
          <div class="issue" data-number="52">Define how children of various mathml elements paint?</div>
          <div class="issue" data-number="49">Define what inline percentages resolve against</div>
          <div class="issue" data-number="50">Define what block percentages resolve against</div>
          <p>
            The layout algorithms described in this chapter for MathML boxes
            have the following structure:
          </p>
          <ol>
            <li>
              Calculation of <a>min-content inline size</a>
              and <a>max-content inline size</a>
              of the content.
            </li>
            <li>
              Box layout:
              <ol>
                <li>
                  Layout of <a data-cite="CSS-POSITION-3#pos-sch"><dfn>in-flow<dfn></a> child boxes.
                </li>
                <li>
                  Calculation of <a>inline size</a>,
                  <a>ink line-ascent</a>,
                  <a>ink line-descent</a>,
                  <a>line-ascent</a> and
                  <a>line-ascent</a> of the content.
                </li>
                <li>
                  Calculation of offsets of child boxes within the content box
                  as
                  well as sizes and offsets of extra graphical elements
                  (bars, radical symbol, etc).
                </li>
                <li>
                  Layout and positioning of <a data-cite="CSS-POSITION-3#pos-sch"><dfn>out-of-flow<df></a> child boxes.
                </li>
              </ol>
            </li>
            <li>
              Painting of extra graphical elements.
            </li>
          </ol>
          <p>
            During box layout, the following extra steps must be performed:
          </p>
          <ul>
            <li>
              After calculating the <a>line-ascent</a> and <a>line-descent</a>
              the <a>block size</a> is set to their sum.
            </li>
            <li>
              <div class="issue" data-number="45">Interpret
                width/height/inline-size/block-size?</div>
              <div class="issue" data-number="112">Define MathML line breaking?</div>
              The box metrics, offsets, <a>baselines</a>, <a>italic correction</a> and
              <a>top accent attachment</a> of the
              <a data-cite="CSS-BOX-3#content-box"><dfn>content box</dfn></a>
              are set to the one calculated for the content.
            </li>
            <li>
              <p>
                The box metrics and offsets of the
                <a data-cite="CSS-BOX-3#padding-box"><dfn>padding box</dfn></a>
                are obtained from the
                <a>content box</a>
                by taking into account the corresponding
                <a data-cite="CSS-BACKGROUNDS-3#padding-physical"><code>padding</code></a>
                properties as described in CSS.
              </p>
              <p>
                The <a>baselines</a>
                of the <a>padding box</a> are the same as the one of the <a>content box</a>.
              </p>
              <p>
                If the <a>content box</a> has a <a>top accent attachment</a>
                or <a>italic correction</a> then the <a>padding box</a> has the same
                properties, increased by the inline-start padding.
              </p>
            </li>
            <li>
              <p>
                The box metrics and offsets of the
                <a data-cite="CSS-BOX-3#border-box"><dfn>border box</dfn></a>
                are obtained from the
                <a>padding box</a>
                by taking into account the corresponding
                <a data-cite="CSS-BOX-3#the-border-width"><code>border-width</code></a>
                property as described in CSS.
              </p>
              <p>
                In general, the <a>baselines</a> of the <a>border box</a> are the same as
                the one of the <a>padding box</a>. However, if the <a>line-over</a> border is
                positive then the <a>ink-over baseline</a> is set to the
                <a>line-over</a> edge of the <a>border box</a> and if
                the <a>line-under</a> border is
                positive then the <a>ink-under baseline</a> is set to the
                <a>line-under</a> edge of the <a>border box</a>.
              </p>
              <p>
                If the <a>padding box</a> has a <a>top accent attachment</a>
                then the <a>border box</a> has the same top accent attachment value
                increased by the border-width of its inline-start edge.
              </p>
              <p>
                If the <a>padding box</a> has an <a>italic correction</a>
                and the border-width of the inline-end edge of the <a>border box</a>
                is zero then the <a>border box</a> has the same <a>italic correction</a> value
                increased by the border-width of its inline-start edge.
              </p>
            </li>
            <li>
              <p>
                The box metrics and offsets of the
                <a data-cite="CSS-BOX-3#margin-box"><dfn>margin box</dfn></a>
                are obtained from the
                <a>border box</a>
                by taking into account the corresponding
                <a data-cite="CSS-BOX-3#margin-physical"><code>margin</code></a>
                properties as described in CSS.
              </p>
              <p>
                The <a>baselines</a>
                of the <a>margin box</a> are the same as the one of the <a>border box</a>.
              </p>
              <p>
                If the <a>border box</a> has a <a>top accent attachment</a>
                or <a>italic correction</a> then the <a>margin box</a> has the same
                properties, increased by the inline-start margin.
              </p>
            </li>
          </ul>
          <div class="note">
            Per the description above, <a data-cite="CSS2#margin-collapsing">margin-collapsing</a> does not apply to MathML elements.
          </div>
          <div class="issue" data-number="132">Expose layout constraint to
            the CSS Layout API?</div>
          <p>
            During box layout, optional
            <dfn>inline stretch size constraint</dfn> and
            <dfn>block stretch size constraint</dfn> parameters may be used on
            <a>embellished operators</a>. The former indicates
            a target size that a <a>core operator</a> stretched along
            the <a>inline axis</a> should cover.
            The latter indicates an <a>ink line-ascent</a> and <a>ink line-descent</a>
            that a <a>core operator</a> stretched along the <a>block axis</a>
            should cover.
            Unless specified otherwise, these parameters are ignored during
            box layout and child boxes are laid out without
            any stretch size constraint.
          </p>
        </section>
      </section>
      <section id="token-elements">
        <h3>Token Elements</h3>
        <p>
          Token elements in presentation markup are broadly intended to
          represent the smallest units of mathematical notation which carry
          meaning. Tokens are roughly analogous to words in text. However,
          because of the precise, symbolic nature of mathematical notation, the
          various categories and properties of token elements figure
          prominently in MathML markup. By contrast, in textual data,
          individual words rarely need to be marked up or styled specially.
        </p>
        <div class="note">
          In practice, most MathML token elements just contain simple text
          for variables, numbers, operators etc and don't need sophisticated
          layout. However, it can contain contain text with line breaks or
          arbitrary HTML5 phrasing elements.
        </div>
        <section id="text-mtext">
          <h4>Text <code>&lt;mtext&gt;</code></h4>
          <p>
            The
            <dfn><code>&lt;mtext&gt;</code></dfn>
            element is used to represent arbitrary text
            that should be rendered as itself. In general, the
            <code>&lt;mtext&gt;</code> element is intended to denote
            commentary text.
          </p>
          <p>
            The <code>&lt;mtext&gt;</code> element accepts the attributes described
            in <a href="#global-attributes"></a>.
          </p>
          <section>
            <h4>Layout of <code>&lt;mtext&gt;</code></h4>
            <div class="issue" data-number="18">Handle orthogonal flow when CSS writing-mode changes?</div>
            <div class="issue" data-number="28">whitespace trimming from MathML3?</div>
            <p>
              If the element does not have its computed
              <a><code>display</code> property</a> equal to <code>math</code>
              then it is laid out according to the CSS specification where
              the corresponding value is described.
              Otherwise, the layout below is performed.
            </p>
            <p>
              The <code>mtext</code> element is laid out as a
              <a data-cite="CSS-DISPLAY-3#block-box">block box</a>
              and the <a>min-content inline size</a>,
              <a>max-content inline size</a>,
              <a>inline size</a>, <a>block size</a>,
              <a>first baseline set</a> and <a>last baseline set</a> are determined
              accordingly.
            </p>
            <p>
              If the <code>&lt;mtext&gt;</code> element contains only text
              content without
              <a data-cite="CSS-TEXT-3#forced-line-break">forced line break</a>
              or
              <a data-cite="CSS-TEXT-3#soft-wrap-opportunity">soft wrap opportunity</a>
              then in addition:
            </p>
            <ul>
              <li>
                The <a>ink-over baseline</a> (respectively and
                <a>ink-under baseline</a>) is set to align with
                the <a>line-over</a> edge
                (respectively and <a>ink-under baseline</a>) of the
                ink bounding box of the text.
              </li>
              <li>
                If the text content is made of a single glyph and this glyph
                has an entry an entry in the
                <a>MathItalicsCorrectionInfo</a> table then the specified
                value is used as the <a>italic correction</a>.
              </li>
              <li>
                If the text content is made of a single glyph and this glyph
                has an entry in the <a>MathTopAccentAttachment</a> table
                then the specified value is used as the top accent attachment of
                the <code>&lt;mtext&gt;</code> element.
              <li>
                OpenType features are enabled as described in
                <a href="#opentype-features"></a>.
              </li>
            </ul>
          </section>
          <section>
            <h5>OpenType features</h5>
            <p>
              Good mathematical rendering requires use of non-Unicode glyphs.
              Mathematical fonts may only provide these glyphs when the
              <code>math</code> script tag is enabled [[OPEN-FONT-FORMAT]],
              so user agents must
              ensure that it is the case when rendering text inside the
              <code>&lt;mtext&gt;</code> element.
            </p>
            <p>
              If on the <code>&lt;mtext&gt;</code> element
              the CSS property
              <a data-cite="CSS-WRITING-MODES-3#direction"><code>direction</code></a>
              is <code>rtl</code>,
              then user agents must enable the <code>rtlm</code>
              OpenType feature on text nodes [[OPEN-FONT-FORMAT]]
              unless it contradicts what the
              page author has specified with the
              <code>font-feature-settings</code> CSS property.
            </p>
            <div class="issue" data-number="19">Add detailed rules for the ssty OpenType feature</div>
            <p>
              Some characters like primes already have script size by default
              and
              hence would be too small when used in a script position.
              To render such “prescripted” characters with the appropriate size,
              If a <code>&lt;mtext&gt;</code> has a positive
              <a><code>internal scriptlevel</code></a> value then user agents
              must enable
              the <code>ssty</code> (Script Style) OpenType feature
              on its text nodes [[OPEN-FONT-FORMAT]]
              unless it contradicts what the page author has
              specified with the
              <a data-cite="CSS-FONTS-4#font-rend-desc"><code>font-feature-settings</code></a>
              CSS property.
          </p>
          </section>
        </section>
        <section>
          <h4>Identifier <code>&lt;mi&gt;</code></h4>
          <p>
            The
            <dfn><code>&lt;mi&gt;</code></dfn>
            element represents a symbolic name or
            arbitrary text
            that should be rendered as an identifier. Identifiers can include
            variables, function names, and symbolic constants.
          </p>
          <p>
            The <code>&lt;mi&gt;</code> element accepts the attributes described
            in <a href="#global-attributes"></a>. Its layout algorithm is
            the same as the <a>&lt;mtext&gt;</a> element.
            The
            <a href="#user-agent-stylesheet">user agent stylesheet</a>
            must contain the following property in order to implement automatic
            italic:
          </p>
          <pre class="css" data-include="user-agent-stylesheet/mi.css"></pre>
        </section>
        <section>
          <h4>Number <code>&lt;mn&gt;</code></h4>
          <p>
            The
            <dfn><code>&lt;mn&gt;</code></dfn>
            element represents a "numeric literal" or
            other data that should be rendered as a numeric literal. Generally
            speaking, a numeric literal is a sequence of digits, perhaps including a
            decimal point, representing an unsigned integer or real number.
          </p>
          <p>
            The <code>&lt;mn&gt;</code> element accepts the attributes described
            in <a href="#global-attributes"></a>. Its layout algorithm is
            the same as the
            <a><code>&lt;mtext&gt;</code></a> element.
          </p>
        </section>
        <section id="operator-fence-separator-or-accent-mo">
          <h4>Operator, Fence, Separator or Accent <code>&lt;mo&gt;</code></h4>
          <p>
            The
            <dfn><code>&lt;mo&gt;</code></dfn>
            element represents an
            operator or anything that should be rendered as an operator.
            In general, the notational conventions for mathematical operators
            are quite complicated, and therefore MathML provides a relatively
            sophisticated mechanism for specifying the rendering behavior of an
            <code>&lt;mo&gt;</code> element.</p>
          <p>
            As a consequence, in MathML the
            list of things that should "render as an operator" includes a
            number of notations that are not mathematical operators in the
            ordinary sense. Besides ordinary operators with infix, prefix, or
            postfix forms, these include fence characters such as braces,
            parentheses, and "absolute value" bars; separators such as comma
            and semicolon; and mathematical accents such as a bar or tilde over
            a symbol. This chapter uses the term "operator" to refer to
            operators in this broad sense.
          </p>
          <div class="issue" data-number="209">Remove fence/separator?</div>
          <p>
            The <code>&lt;mo&gt;</code> element accepts the attributes described
            in <a href="#global-attributes"></a> as well as the following
            attributes:
          </p>
          <ul>
            <li><a><code>form</code></a></li>
            <li><a><code>fence</code></a></li>
            <li><a><code>separator</code></a></li>
            <li><a><code>lspace</code></a></li>
            <li><a><code>rspace</code></a></li>
            <li><a><code>stretchy</code></a></li>
            <li><a><code>symmetric</code></a></li>
            <li><a><code>maxsize</code></a></li>
            <li><a><code>minsize</code></a></li>
            <li><a><code>largeop</code></a></li>
            <li><a><code>movablelimits</code></a></li>
            <li><a><code>accent</code></a></li>
          </ul>
          <section id="embellished-operators">
            <h5>Embellished operators</h5>
            <div class="issue" data-number="115">Simplify embellished operator?</div>
            <p>
              A <a>MathML Core element</a> is an
              <dfn>embellished operator</dfn>
              if is is:
            </p>
            <ol>
              <li>An <a><code>&lt;mo&gt;</code></a> element;</li>
              <li>
                A <a>scripted element</a> or an
                <a><code>&lt;mfrac&gt;</code></a>,
                whose first <a>in-flow</a> child exists and is an
                <a>embellished operator</a>;
              </li>
              <li>
                An <a>mrow-like element</a> or <a>&lt;mpadded&gt;</a>,
                whose <a>in-flow</a> children consist (in any order) of one
                <a>embellished operator</a> and zero or more
                <a>space-like</a> elements.
              </li>
            </ol>
            <p>
              The <dfn>core operator</dfn> of an <a>embellished operator</a>
              is the <code>&lt;mo&gt;</code> element defined recursively as
              follows:
            </p>
            <ol>
              <li>The core operator of an <a><code>&lt;mo&gt;</code></a>
                element; is the element itself.</li>
              <li>
                The core operator of an embellished
                <a>scripted element</a> or
                <a><code>&lt;mfrac&gt;</code></a>
                element is the core operator of its first <a>in-flow</a> child.
              </li>
              <li>
                The core operator of an embellished
                <a>mrow-like element</a> or <a>&lt;mpadded&gt;</a>
                is the core operator of its unique <a>embellished operator</a>
                <a>in-flow</a> child.
              </li>
            </ol>
            <p>
              The <dfn>stretch axis</dfn> of an <a>embellished operator</a>
                is <em>inline</em> if its
              <a>core operator</a> contains only text content
              made of a unique character <code>c</code> and that
              character has stretch axis <em>inline</em> per
              <a href="#stretchy-operator-axis"></a>.
              Otherwise, stretch axis of the <a>embellished operator</a>
              is <em>block</em>.
            </p>
          </section>
          <section id="dictionary-based-attributes">
            <h4>Dictionary-based attributes</h4>
            <p>
              The <dfn><code>form</code></dfn>
              property of an <a>embellished operator</a> is either
              <code>infix</code>, <code>prefix</code> or
              <code>postfix</code>.
              The corresponding <code>form</code> attribute on the
              <a><code>&lt;mo&gt;</code></a> element, if present, must
              must be an
              <a data-cite="INFRA#ascii-case-insensitive">ASCII case-insensitive</a>
              match to one of these values.
            </p>
            <p>
              The <code>form</code> of an <a>embellished operator</a> is determined as follows:
            </p>
            <ol>
              <li>If the <code>form</code> attribute is present and valid
                on the <a>core operator</a>, then its value is used;
              </li>
              <li>If the embellished operator is the first <a>in-flow</a> child of an
                <a>mrow-like element</a>,
                <a>&lt;menclose&gt;</a>,
                <a>&lt;mpadded&gt;</a> or
                <a>&lt;msqrt&gt;</a> with more than one <a>in-flow</a> child
                (ignoring all <a>space-like</a> children) then it has
                form <code>prefix</code>;
              </li>
              <li>Or, if the embellished operator is the last <a>in-flow</a> child of
                an
                <a>mrow-like element</a>,
                <a><code>&lt;menclose&gt;</code></a>,
                <a><code>&lt;mpadded&gt;</code></a> or
                <a><code>&lt;msqrt&gt;</code></a>
                with more than one <a>in-flow</a> child
                (ignoring all <a>space-like</a> children) then it has
                form <code>postfix</code>;
              <li>Or, if the embellished operator is an <a>in-flow</a> child of a
                <a>scripted element</a>, other than the first <a>in-flow</a>
                child, then it has form <code>postfix</code>;
              </li>
              <li>
                Otherwise, the embellished operator has form
                <code>infix</code>.
              </li>
            </ol>
            <div class="issue" data-number="209">Remove fence/separator?</div>
            <p>
              The
              <dfn><code>fence</code></dfn>,
              <dfn><code>separator</code></dfn>,
              <dfn><code>stretchy</code></dfn>,
              <dfn><code>symmetric</code></dfn>,
              <dfn><code>largeop</code></dfn>,
              <dfn><code>movablelimits</code></dfn>,
              <dfn><code>accent</code></dfn>
              properties of an <a>embellished operator</a> are
              either <code>false</code> or <code>true</code>. In the latter
              case, it
              is said that the <a>embellished operator</a> <em>has</em> the
              property.
              The corresponding attributes on the
              <a><code>&lt;mo&gt;</code></a> element, if present, must be a
              <a>boolean</a>.
            </p>
            <p>
              The
              <dfn><code>lspace</code></dfn>,
              <dfn><code>rspace</code></dfn>,
              <dfn><code>minsize</code></dfn>
              properties of an <a>embellished operator</a> are
              <a>length-percentage</a>.
              The <dfn><code>maxsize</code></dfn> property
              of an <a>embellished operator</a> is either a
              <a>length-percentage</a> or ∞.
              The
              <code>lspace</code>,
              <code>rspace</code>,
              <code>minsize</code> and
              <code>maxsize</code> attributes on the
              <a><code>&lt;mo&gt;</code></a> element, if present,
              must be a <a>length-percentage</a>.
            </p>
            <p>
              The
              <code>fence</code>,
              <code>separator</code>,
              <code>stretchy</code>,
              <code>symmetric</code>,
              <code>largeop</code>,
              <code>movablelimits</code>,
              <code>accent</code>,
              <code>lspace</code>,
              <code>rspace</code>,
              <code>maxsize</code>,
              <code>minsize</code> properties of
              an <a>embellished operator</a> are determined as follows:
            </p>
            <ol>
              <li>If the corresponding attribute is present and valid
                on the <a>core operator</a>, then this property is used;</li>
              <li>
                Otherwise, if the <a>core operator</a> contains only text
                content T, the corresponding property from the
                <a href="#operator-dictionary-compact">Operator Dictionary</a>
                is retrieved by looking for <code>Content=T,Form=F</code>
                where <code>F</code> is the <a><code>form</code></a> of the
                <a>embellished operator</a>;
              </li>
              <li>
                If no entry is found and the <a><code>form</code></a>
                of <a>embellished operator</a> was not explicitly specified
                as an attribute on its <a>core operator</a>, then
                user agents must try other dictionary entries for different
                values of <code>F</code> in the following order:
                <code>infix</code>, <code>prefix</code>, <code>postfix</code>;
              </li>
              <li>
                Otherwise, use the value <code>false</code> for
                <code>fence</code>,
                <code>separator</code>,
                <code>stretchy</code>,
                <code>symmetric</code>,
                <code>largeop</code>,
                <code>movablelimits</code> and
                <code>accent</code> properties ;
                <code>0.2777777777777778em</code> for
                <code>lspace</code> and
                <code>rspace</code> properties ;
                <code>100%</code> for the <code>minsize</code> property and
                ∞ for the <code>maxsize</code> property.
              </li>
            </ol>
            <p>
              Percentage values for <code>lspace</code>,
              <code>rspace</code>
              properties of an <a>embellished operator</a>
              are interpreted relative to the value read from the dictionary
              or to the fallback value above.
            </p>
            <p>
              Percentages value for <code>minsize</code>
              and
              <code>maxsize</code>
              properties of an <a>embellished operator</a>
              are interpreted relative to
              the target stretch size before application of
              size constraints, as described in
              <a href="#algorithm-for-stretching-operators-along-the-block-axis"></a>.
            </p>
            <p>
              Font-relative lengths for
              <code>lspace</code>, <code>rspace</code>,
              <code>minsize</code> and <code>maxsize</code> rely on the
              font style of the <a>core operator</a>, not the one of the
              <a>embellished operator</a>.
            </p>
          <div class="note">
            The <code>fence</code> and <code>separator</code> properties do not
            have any visible effect on the layout described in this
            specification. However, they can still be useful e.g. to provide
            extra semantic information to assistive technlologies via the
            accessible tree.
          </div>
          </section>
          <section>
            <h4>Layout of operators</h4>
            <p>
              If the <code>&lt;mo&gt;</code> element does not have its computed
              <a><code>display</code> property</a> equal to <code>math</code>
              then it is laid out according to the CSS specification where
              the corresponding value is described.
              Otherwise, the layout below is performed.
            </p>
            <p>
              The text of the operator must only be painted if the
              <a data-cite="CSS2#visibility"><code>visibility</code></a> of
              the <code>&lt;mo&gt;</code> element is <code>visible</code>.
              In that case, it must be painted with the
              <a data-cite="CSS-COLOR-3#foreground"><code>color</code></a>
              of the <code>&lt;mo&gt;</code> element.
            </p>
            <p>Operators are laid out as follows:</p>
            <ol>
              <li>
                If the content of the <code>&lt;mo&gt;</code> element is not
                made
                of a single character <code>c</code> then fallback to the
                layout algorithm of <a href="#layout-of-mtext"></a>.
              </li>
              <li>
                If the operator has the <a>stretchy</a> property:
                <ul>
                  <li>
                    If the <a>stretch axis</a> of the operator is inline
                    then
                    <ol>
                      <li>
                        Try and get a
                        <code>MathVariants.horizGlyphConstructionOffsets</code>
                        table from the glyph corresponding to
                        <code>c</code> in the current font, or otherwise
                        from the entry
                        <a href="#unicode-based-glyph-assemblies"></a>
                        with base character <code>c</code>.
                        If that's not possible then
                        fallback to the
                        layout algorithm of <a href="#layout-of-mtext"></a>.
                      </li>
                      <li>
                        The <a>min-content inline size</a> and
                        <a>max-content inline size</a> of the content
                        are set to the one obtained by the layout algorithm of
                        <a href="#layout-of-mtext"></a>.
                      </li>
                      <li>
                        If there is not any
                        <a>inline stretch size constraint</a>
                        <code>T<sub>inline</sub></code>
                        then
                        fallback to the
                        layout algorithm of <a href="#layout-of-mtext"></a>.
                      </li>
                      <li>
                        The <a>inline size</a> and (ink) block metrics of the content
                        are given by the
                        <a>box metrics of a stretchy glyph</a>
                        stretched to <a>inline dimension</a>
                        <code>T<sub>inline</sub></code>.
                      </li>
                      <li>
                        The painting of the operator is performed by the
                        algorithm
                        to <a>shape a stretchy glyph</a>
                        stretched to <a>inline dimension</a>
                        <code>T</code> and
                        at position determined by the previous box metrics.
                      </li>
                    </ol>
                  </li>
                  <li>
                    Otherwise, the <a>stretch axis</a> of the operator is
                    block. The following steps are performed:
                    <ol>
                      <li>
                        Try and get a
                        <code>MathVariants.vertGlyphConstructionOffsets</code>
                        table from the glyph corresponding to
                        <code>c</code> in the current font, or otherwise
                        from the entry of
                        <a href="#unicode-based-glyph-assemblies"></a>
                        with base character <code>c</code>.
                        If that's not possible then
                        fallback to the
                        layout algorithm of <a href="#layout-of-mtext"></a>.
                      </li>
                      <li>
                        The <a>min-content inline size</a> and
                        <a>max-content inline size</a> of the content
                        are set to the
                        <a>preferred inline size of a glyph stretched
                          along the block axis</a>.
                      </li>
                      <li>
                        If there is not any
                        <a>block stretch size constraint</a>
                        <code>(T<sub>ascent</sub>, T<sub>descent</sub>)</code>
                        then
                        fallback to the
                        layout algorithm of <a href="#layout-of-mtext"></a>.
                      </li>
                      <li>
                        The <a>inline size</a>,
                        <a>ink line-ascent</a>,
                        <a>ink line-descent</a>,
                        <a>line-ascent</a> and
                        <a>line-descent</a>
                        of the content
                        are obtained from the
                        <a>box metrics of a stretchy glyph</a>
                        stretched to <a>block dimension</a>
                        <code>T<sub>ascent</sub></code> +
                        <code>T<sub>descent</sub></code>.
                        The <a>inline size</a> of the content is the width of
                        the stretchy glyph. The stretchy glyph is shifted
                        towards the <a>line-under</a> by a value Δ so that its
                        center aligns with the center of the target:
                        the ink ascent of the content is
                        the ascent of the stretchy glyph − Δ
                        and the ink descent of the content is
                        the descent of the stretchy glyph + Δ.
                        These centers have coordinates "½(ascent − descent)"
                        so Δ = [(ascent of stretchy glyph − descent of stretchy glyph) − (<code>T<sub>ascent</sub></code> − <code>T<sub>descent</sub></code>)] / 2.
                      </li>
                      <li>
                        The painting of the operator is performed by the
                        algorithm
                        to <a>shape a stretchy glyph</a>
                        stretched to <a>block dimension</a> <code>T</code> and
                        at position determined by the previous box metrics
                        shifted by Δ towards the <a>line-over</a>.
                      </li>
                    </ol>
                    <figure id="figure-base-variants-and-assembly">
                      <img src="figures/bracesize.svg"/>
                      <figcaption>Base size, size variants and glyph assembly
                        for
                        the left brace</figcaption>
                    </figure>
                  </li>
                </ul>
              </li>
              <li>
                If the operator has the <a>largeop</a> property and
                if <a><code>math-style</code></a> on
                the <code>&lt;mo&gt;</code> element is <code>display</code>,
                then:
                <ol>
                  <li>
                    <div class="issue" data-number="95">Clarify/improve this?
                      How important is this MATH parameter? "integrals"
                      is not defined</div>
                    <p>
                      Use the
                      <code>MathVariants</code>
                      table to try and find a glyph of height at least
                      <a>DisplayOperatorMinHeight</a>
                      If none is found, fallback to the
                      largest non-base glyph. If none is found, fallback to
                      the layout algorithm of <a href="#layout-of-mtext"></a>.
                    </p>
                    <p>
                      Because this parameter does not always give
                      the best size, user agents may also use the following
                      heuristic: ensure that the large variant height is at
                      least
                      2 times as large as the base height for integrals and √2
                      times as large as the base height for other operators.
                    </p>
                  </li>
                  <li>
                    The <a>min-content inline size</a>,
                    <a>max-content inline size</a>,
                    <a>inline size</a> and block metrics of the content
                    are given by the
                    glyph found.
                  </li>
                  <li>
                    Paint the glyph.
                  </li>
                </ol>
                <figure id="figure-sum-base-and-displastyle-sizes">
                  <img src="figures/sumsize.svg"/>
                  <figcaption>Base and displaystyle sizes of the summation symbol</figcaption>
                </figure>
              </li>
              <li>
                Other fallback to the
                layout algorithm of <a href="#layout-of-mtext"></a>.
              </li>
            </ol>
          </section>
        </section>
        <section id="space-mspace">
          <h4>Space <code>&lt;mspace&gt;</code></h4>
          <p>
            The
            <dfn><code>&lt;mspace&gt;</code></dfn>
            empty element represents a blank space of any
            desired size, as set by its attributes.
          </p>
          <p>
            The <code>&lt;mspace&gt;</code> element accepts the attributes described
            in <a href="#global-attributes"></a> as well as the following
            attributes:
          </p>
          <ul>
            <li><a href="#attribute-mspace-width" class="internalDFN" data-link-type="dfn"><code>width</code></a></li>
            <li><a href="#attribute-mspace-height" class="internalDFN" data-link-type="dfn"><code>height</code></a></li>
            <li><a href="#attribute-mspace-depth" class="internalDFN" data-link-type="dfn"><code>depth</code></a></li>
          </ul>
          <div class="issue" data-number="40">Allow negative width, lspace to
            produce negative spacing?</div>
          <p>The
            <dfn id="attribute-mspace-width"><code>mspace@width</code></dfn>,
            <dfn id="attribute-mspace-height"><code>mspace@height</code></dfn>,
            <dfn id="attribute-mspace-depth"><code>mspace@depth</code></dfn>, if present, must
            have a value that is a valid <a>length-percentage</a>.
            An unspecified attribute, a percentage  value, or an invalid value
            is interpreted as <code>0</code>.
            If one of the requested values calculated is negative then it is
            treated as <code>0</code>.
          </p>
          <p>
            If the <code>&lt;mspace&gt;</code> element does not have its
            computed
            <a><code>display</code> property</a> equal to <code>math</code>
            then it is laid out according to the CSS specification where
            the corresponding value is described.
            Otherwise,
            the <code>&lt;mspace&gt;</code> element is laid out as shown on
            <a href="#figure-box-mspace"></a>.
            The <a>min-content inline size</a> and
            <a>max-content inline size</a> of the content are
            equal to the requested inline size.
            The <a>inline size</a>, <a>line-ascent</a> and <a>line-descent</a> of the content
            are respectively
            the requested inline size, line-ascent and line-descent.
          </p>
          <figure id="figure-box-mspace">
            <img src="figures/mspacebox.svg"/>
            <figcaption>Box model for the <code>&lt;mspace&gt;</code> element</figcaption>
          </figure>
          <div class="note">
            The terminology height/depth comes from [[MATHML3]], itself inspired
            from [[TEXBOOK]].
          </div>
          <section id="definition-of-space-like-elements">
            <h3>Definition of space-like elements</h3>
            <p>
              A number of MathML presentation elements are "space-like" in the
              sense that they typically render as whitespace, and do not affect
              the mathematical meaning of the expressions in which they appear.
              As a consequence, these elements often function in somewhat
              exceptional ways in other MathML expressions.
            </p>
            <p>
              A <a>MathML Core element</a> is a
              <dfn data-lt="space-like">space-like element</dfn>
              if is is:
            </p>
            <ul>
              <li>An
                <a><code>&lt;mtext&gt;</code></a> or
                <a><code>&lt;mspace&gt;</code></a>.
              </li>
              <li>Or an
                <a>mrow-like element</a> or <a>&lt;mpadded&gt;</a>
                all of whose <a>in-flow</a> children are <a>space-like</a>.
              </li>
            </ul>
            <div class="note">
              Note that an <a><code>&lt;mphantom&gt;</code></a> is not
              automatically defined to be space-like, unless its content is
              space-like. This is because operator spacing is affected by
              whether adjacent elements are space-like.
              Since the <code>&lt;mphantom&gt;</code> element is
              primarily intended as an aid in aligning expressions, operators
              adjacent to an <code>&lt;mphantom&gt;</code> should behave
              as if they were adjacent to the contents of the
              <code>&lt;mphantom&gt;</code>, rather than to an equivalently
              sized area of whitespace.
            </div>
          </section>
        </section>
        <section id="string-literal-ms">
          <h4>String Literal <code>&lt;ms&gt;</code></h4>
          <p>
            <dfn><code>&lt;ms&gt;</code></dfn>
            element is used to represent
            "string literals" in expressions meant to be interpreted by computer
            algebra systems or other systems containing "programming languages".
          </p>
          <p>
            The <code>&lt;ms&gt;</code> element accepts the attributes described
            in <a href="#global-attributes"></a>.  Its layout algorithm is
            the same as the <a><code>&lt;mtext&gt;</code></a> element.
          </p>
          <div class="note">
            In MathML3, it was possible to use the <code>lquote</code> and
            <code>rquote</code> attributes to respectively specify the strings
            to use as opening and closing quotes. These are no longer supported
            and the quotes must instead be specified as part of the text of the
            <code>&lt;ms&gt;</code> element. One can add CSS rules to legacy
            documents in order to preserve visual rendering. For example,
            in left-to-right direction:
            <pre class="css" data-include="user-agent-stylesheet/ms-legacy.css"></pre>
          </div>
        </section>
      </section>
      <section>
        <h3>General Layout Schemata</h3>
        <p>Besides tokens there are several families of MathML presentation
          elements. One family of elements deals with various "scripting"
          notations, such as subscript and superscript. Another family is
          concerned with matrices and tables. The remainder of the elements,
          discussed in this section, describe other basic notations such as
          fractions and radicals, or deal with general functions such as
          setting style properties and error handling.
        </p>
        <section id="horizontally-group-sub-expressions-mrow">
          <h4>Group Sub-Expressions <code>&lt;mrow&gt;</code></h4>
          <p>
            The
            <dfn><code>&lt;mrow&gt;</code></dfn>
            element is used to group together any number of sub-expressions, usually
            consisting of one or more <code>&lt;mo&gt;</code> elements acting as
            "operators" on one or more other expressions that are their "operands".
          </p>
          <p>
            The <code>&lt;mrow&gt;</code> element accepts the attributes described
            in <a href="#global-attributes"></a>. An <code>&lt;mrow&gt;</code>
            element with <a>in-flow</a> children
            child<sub>1</sub>, child<sub>2</sub>, … child<sub>N</sub>
            is laid out as show on <a href="#figure-box-mrow"></a>. The child boxes
            are put in a row one after the other with all their
            <a>alphabetic baselines</a>
            aligned.
          </p>
          <figure id="figure-box-mrow">
            <img src="figures/mrowbox.svg"/>
            <figcaption>Box model for the <code>&lt;mrow&gt;</code> element</figcaption>
          </figure>
          <p>
          <div class="note">
            Because the box model ensure alignment of <a>alphabetic baselines</a>,
            fraction bars or symmetric stretchy operators
            will also be aligned along the math axis in the typical case when
            <a>AxisHeight</a> is the same for all <a>in-flow</a> children.
          </div>
          <section>
            <h5>Algorithm for stretching operators along the block axis</h5>
            <div class="issue" data-number="124">Layout of container with only stretchy <a>in-flow</a> children</div>
            <div class="issue" data-number="109">Define what happens when maxsize &lt; minsize</div>
            <div class="issue" data-number="110">Explicit calculation for minsize/maxsize constraints?</div>
            <figure id="symmetric-and-non-symmetric-vertical-stretching">
              <img src="figures/vstretch.svg"/>
              <figcaption>Symmetric and non-symmetric stretching of
                operators along the <a>block axis</a></figcaption>
            </figure>
            <p>
              The <dfn>Algorithm for stretching operators along the block axis</dfn>
              consists in the following steps:
            </p>
            <ol>
              <li>
                If there is a <a>block stretch size constraint</a>
                or an <a>inline stretch size constraint</a>
                then the element being laid out is an
                <a>embellished operator</a>. Layout the one <a>in-flow</a> child that
                is an <a>embellished operator</a>
                with the same stretch size constraint and
                all the other <a>in-flow</a> children
                without any stretch size constraint
                and stop.
              </li>
              <li>
                Layout all the <a>in-flow</a> children of the
                <code>&lt;mrow&gt;</code> except the
                <a>embellished operators</a> that have
                the <a>stretchy</a> property and block <a>stretch axis</a>.
                If this step results in all the <a>in-flow</a> children
                being laid out, then
                stop.
              </li>
              <li>
                Calculate the unconstrained target sizes
                <code>U<sub>ascent</sub></code>
                and <code>U<sub>descent</sub></code> as respectively the maximum
                ink ascent and maximum ink descent of the <a>margin boxes</a> of
                <a>in-flow</a> children that
                have been laid out in the previous step.
              </li>
              <li>
                Calculate the symmetric target sizes:
                <ul>
                  <li>
                    <code>S<sub>ascent</sub></code> =
                    max(
                    <code>U<sub>ascent</sub></code> − <a>AxisHeight</a>,
                    <code>U<sub>descent</sub></code> + <a>AxisHeight</a>
                    ) + <a>AxisHeight</a>
                  </li>
                  <li>
                    <code>S<sub>descent</sub></code> =
                    max(
                    <code>U<sub>ascent</sub></code> − <a>AxisHeight</a>,
                    <code>U<sub>descent</sub></code> + <a>AxisHeight</a>
                    ) − <a>AxisHeight</a>
                  </li>
                </ul>
              </li>
              <li>
                For each <a>in-flow</a> child of <code>&lt;mrow&gt;</code>
                that is an <a>embellished operator</a>
                with the <a>stretchy</a> property and block <a>stretch axis</a>:
                <ol>
                  <li>
                    If the child has the <a>symmetric</a> property
                    then set the target sizes
                    <code>T<sub>ascent</sub></code> and
                    <code>T<sub>descent</sub></code> to
                    <code>S<sub>ascent</sub></code> and
                    <code>S<sub>descent</sub></code> respectively.
                    Otherwise set them to
                    <code>U<sub>ascent</sub></code> and
                    <code>U<sub>descent</sub></code> respectively.
                  </li>
                  <li>
                    Let <code>minsize</code> and <code>maxsize</code>
                    be the <a>minsize</a> and <a>maxsize</a> properties on the
                    child. Percentage values are intepreted relative
                    to <code>T</code> =
                    <code>T<sub>ascent</sub></code> +
                    <code>T<sub>descent</sub></code>.
                    If 0 ≤ <code>minsize</code> ≤ <code>maxsize</code> then:
                    <ul>
                      <li>
                        If <code>T</code> = 0 then set
                        <code>T<sub>ascent</sub></code> and
                        <code>T<sub>descent</sub></code>
                        to <code>minsize</code>/2.
                      </li>
                      <li>
                        Otherwise, if
                        0 &lt; <code>T</code> &lt; <code>minsize</code>
                        then
                        multiply
                        <code>T<sub>ascent</sub></code>,
                        <code>T<sub>descent</sub></code>
                        by <code>minsize</code> / <code>T</code>.
                      </li>
                      <li>
                        Otherwise, if <code>maxsize</code> &lt; <code>T</code>
                        then multiply
                        <code>T<sub>ascent</sub></code>,
                        <code>T<sub>descent</sub></code>
                        by <code>maxsize</code> / <code>T</code>.
                      </li>
                    </ul>
                  </li>
                  <li>
                    Layout the child with
                    <a>block stretch size constraint</a>
                    <code>(T<sub>ascent</sub>, T<sub>descent</sub>)</code>.
                  </li>
                </ol>
              </li>
            </ol>
          <div class="note">
            If <code>maxsize</code> is equal to its default value ∞
            then <code>minsize ≤ maxsize</code> is satisfied but
            <code>maxsize &lt; T</code> is not.
          </div>
          </section>
          <section id="layout-of-mrow">
            <h5>Layout of <code>&lt;mrow&gt;</code></h5>
            <p>
              If the element does not have its computed
              <a><code>display</code> property</a> equal to <code>math</code>
              then it is laid out according to the CSS specification where
              the corresponding value is described.
              Otherwise, the layout below is performed.
            </p>
            <div class="issue" data-number="112">Define MathML line breaking?</div>
            <div class="issue" data-number="38">TeX-like spacing rules?</div>
            <p>
              A child box is <dfn>slanted</dfn> if it is not an
              <a>embellished operator</a>
              and has nonzero <a>italic correction</a>.
            </p>
            <div class="note">
              Large operators may have nonzero <a>italic correction</a> but that one
              is used when attaching scripts.
              More generally, all <a>embellished operator</a>
              are treated as non-slanted since the spacing is designed to
              around them as specifed by <a><code>lspace</code></a> and
              <a><code>rspace</code></a>.
            </div>
            <p>
              The <a>min-content inline size</a>
              (respectively <a>max-content inline size</a>) are
              calculated using the following algorithm:
            </p>
            <ol>
              <li>
                Set <code>add-space</code> to true if
                the element is a <a>&lt;math&gt;</a> or is not an
                <a>embellished operator</a>; and to false otherwise.
              </li>
              <li>Set <code>inline-offset</code> to 0.</li>
              <li>Set <code>previous-italic-correction</code> to 0.</li>
              <li>
                For each <a>in-flow</a> child:
                <ol>
                  <li>
                    If the child is not <a>slanted</a>, then increment
                    <code>inline-offset</code> by
                    <code>previous-italic-correction</code>.
                  </li>
                  <li>
                    If the child is an <a>embellished operators</a>
                    and <code>add-space</code> is true then
                    increment <code>inline-offset</code> by
                    its <a><code>lspace</code></a> property.
                  </li>
                  <li>
                    Increment <code>inline-offset</code> by
                    the <a>min-content inline size</a>
                    (respectively <a>max-content inline size</a>) of
                    the child's <a>margin box</a>.
                  </li>
                  <li>
                    If the child is <a>slanted</a> then
                    set <code>previous-italic-correction</code> to
                    its <a>italic correction</a>. Otherwise set it to 0.
                  </li>
                  <li>
                    If the child is an <a>embellished operators</a>
                    and <code>add-space</code> is true then
                    increment <code>inline-offset</code> by
                    its <a><code>rspace</code></a> property.
                  </li>
                </ol>
              </li>
              <li>
                Increment <code>inline-offset</code> by
                <code>previous-italic-correction</code>.
              </li>
              <li>
                Return <code>inline-offset</code>.
              </li>
            </ol>
            <p>
              The <a>in-flow</a> children are laid out using the
              <a>algorithm for stretching operators along the block axis</a>.
            </p>
            <p>
              The <a>inline size</a> of the content is calculated like
              the <a>min-content inline size</a> and
              <a>max-content inline size</a> of the content,
              using the <a>inline size</a> of the
              <a>in-flow</a> children's <a>margin boxes</a> instead.
            </p>
            <p>
              The <a>ink line-ascent</a> (respectively <a>line-ascent</a>)
              of the content
              is the maximum of the
              <a>ink line-ascents</a> (respectively <a>line-ascents</a>)
              of all the <a>in-flow</a> children's <a>margin boxes</a>. Similarly,
              the <a>ink line-descent</a> (respectively <a>line-descent</a>)
              of the content is the maximum of the <a>ink line-descents</a>
              (respectively <a>ink line-ascents</a>)
              of all the <a>in-flow</a> children's <a>margin boxes</a>.
            </p>
            <p>
              Finally, the <a>in-flow</a> children are positioned using the following
              algorithm:
            </p>
            <ol>
              <li>
                Set <code>add-space</code> to true if
                the element is a <a>&lt;math&gt;</a> or is not an
                <a>embellished operator</a>; and to false otherwise.
              </li>
              <li>Set <code>inline-offset</code> to 0.</li>
              <li>Set <code>previous-italic-correction</code> to 0.</li>
              <li>For each <a>in-flow</a> child:
                <ol>
                  <li>
                    If the child is not <a>slanted</a>, then increment
                    <code>inline-offset</code> by
                    <code>previous-italic-correction</code>.
                  </li>
                  <li>
                    If the child is an <a>embellished operators</a>
                    and <code>add-space</code> is true then
                    increment <code>inline-offset</code> by
                    its <a><code>lspace</code></a> property.
                  </li>
                  <li>
                    Set the <a>inline offset</a> of the child
                    to <code>inline-offset</code> and its <a>block offset</a> such
                    that the <a>alphabetic baseline</a> of the child is aligned with the <a>alphabetic baseline</a>.
                  </li>
                  <li>
                    Increment <code>inline-offset</code> by
                    the <a>inline size</a> of the child's <a>margin box</a>.
                  </li>
                  <li>
                    If the child is <a>slanted</a> then
                    set <code>previous-italic-correction</code> to
                    its <a>italic correction</a>. Otherwise set it to 0.
                  </li>
                  <li>
                    If the child is an <a>embellished operators</a>
                    and <code>add-space</code> is true then
                    increment <code>inline-offset</code> by
                    its <a><code>rspace</code></a> property.
                  </li>
                </ol>
              </li>
            </ol>
          </section>
        </section>
        <section id="fractions-mfrac">
          <h4>Fractions <code>&lt;mfrac&gt;</code></h4>
          <p>
            The
            <dfn><code>&lt;mfrac&gt;</code></dfn>
            element is used for fractions. It can also be used to mark up
            fraction-like objects such as binomial coefficients and Legendre symbols.
          </p>
          <p>
            If the <code>&lt;mfrac&gt;</code> element does not have its computed
            <a><code>display</code> property</a> equal to <code>math</code>
            then it is laid out according to the CSS specification where
            the corresponding value is described.
            Otherwise, the layout below is performed.
          </p>
          <p>
            The <code>&lt;mfrac&gt;</code> element accepts the attributes described
            in <a href="#global-attributes"></a> as well as the
            following attribute:
          </p>
          <div class="issue" data-number="29">mfrac@bevelled?</div>
          <ul>
            <li><a>linethickness</a></li>
          </ul>
          <p>
            The
            <dfn><code>linethickness</code></dfn>
            attribute indicates the <dfn>fraction line thickness</dfn>
            to use for the fraction bar.
            If present, it must
            have a value that is a valid <a>length-percentage</a>.
            If the attribute is absent or has an invalid value,
            <a>FractionRuleThickness</a> is used as the default
            value. A percentage is interpreted relative to that default value.
            A negative value is interpreted as 0.
          </p>
          <p>
            The <code>&lt;mfrac&gt;</code> element sets
            <a><code>displaystyle</code></a> to <code>false</code>,
            or if it was already <code>false</code> increments
            <a><code>scriptlevel</code></a> by 1, within its children.
            It sets <a>math-superscript-shift-style</a> to
            <code>inline</code> within its second child.
            To avoid visual confusion between the fraction bar and another
            adjacent items (e.g. minus sign or another fraction's bar),
            a default 1-pixel space is added around the element.
            The <a href="#user-agent-stylesheet">user agent stylesheet</a>
            must contain the following rules:
          </p>
          <pre class="css" data-include="user-agent-stylesheet/mfrac.css"></pre>
          <div class="issue" data-number="15">Decide how to handle invalid
            markup.</div>
          <p>
            If the <code>&lt;mfrac&gt;</code> element
            has less or more than two <a>in-flow</a> children, its layout algorithm
            is the same as the <a><code>&lt;mrow&gt;</code></a> element.
            Otherwise, the first <a>in-flow</a> child is called
            <dfn>numerator</dfn>, the second <a>in-flow</a> child is called
            <dfn>denominator</dfn> and the layout algorithm is explained below.
          </p>
          <div class="note" id="fraction-css-rules-on-children">
            In practice, an <code>&lt;mfrac&gt;</code> element has two children
            that are <a>in-flow</a>. Hence the CSS rules basically performs
            <a><code>scriptlevel</code></a>, <a><code>displaystyle</code></a>
            and <a>math-superscript-shift-style</a>
            changes for the <a>numerator</a> and
            <a>denominator</a>.
          </div>
          <section id="fraction-with-nonzero-line-thickness">
            <h5>Fraction with nonzero line thickness</h5>
            <p>
              If the <a>fraction line thickness</a> is nonzero, the
              <code>&lt;mfrac&gt;</code>
              element is laid out as shown on <a href="#figure-box-mfrac"></a>.
              The fraction bar must only be painted if the
              <a data-cite="CSS2#visibility"><code>visibility</code></a> of
              the <code>&lt;mfrac&gt;</code> element is <code>visible</code>.
              In that case, the fraction bar must be painted with the
              <a data-cite="CSS-COLOR-3#foreground"><code>color</code></a>
              of the <code>&lt;mfrac&gt;</code> element.
            </p>
            <figure id="figure-box-mfrac">
              <img src="figures/mfracbox.svg"/>
              <figcaption>Box model for the <code>&lt;mfrac&gt;</code> element</figcaption>
            </figure>
            <p>The <a>min-content inline size</a>
              (respectively <a>max-content inline size</a>)
              of content is the maximum between the
              <a>min-content inline size</a>
              (respectively <a>max-content inline size</a>) of the <a>numerator</a>'s
              <a>margin box</a> and the <a>min-content inline size</a>
              (respectively <a>max-content inline size</a>) of the <a>denominator</a>'s
              <a>margin box</a>.
            </p>
            <p>
              If there is an <a>inline stretch size constraint</a>
              or a <a>block stretch size constraint</a> then
              the <a>numerator</a> is also laid out with the same stretch size
              constraint
              otherwise it is laid out without any stretch
              size constraint. The <a>denominator</a> is always laid out without
              any stretch size constraint.
            </p>
            <p>
              The <a>inline size</a> of the content
              is the maximum between the <a>inline size</a> of the
              <a>numerator</a>'s <a>margin box</a> and the <a>inline size</a> of the
              <a>denominator</a>'s <a>margin box</a>.
            </p>
            <p><code>NumeratorShift</code> is the maximum between:</p>
            <ul>
              <li>
                <a>FractionNumeratorShiftUp</a> (respectively
                <a>FractionNumeratorDisplayStyleShiftUp</a>) if
                the <a>math-style</a> is <code>inline</code>
                (respectively <code>display</code>).
              </li>
              <li>
                The <a>AxisHeight</a> + half the
                <a>fraction line thickness</a> +
                <a>FractionNumeratorGapMin</a>
                (respectively <a>FractionNumDisplayStyleGapMin</a>)
                if the <a>math-style</a> is <code>inline</code>
                (respectively <code>display</code>) +
                the <a>ink line-descent</a> of the <a>numerator</a>'s <a>margin box</a>.
              </li>
            </ul>
            <p><code>DenominatorShift</code> is the maximum between:</p>
            <ul>
              <li>
                <a>FractionDenominatorShiftDown</a> (respectively
                <a>FractionDenominatorDisplayStyleShiftDown</a>) if
                the <a>math-style</a> is <code>inline</code>
                (respectively <code>display</code>).
              </li>
              <li>
                Half the <a>fraction line thickness</a> +
                <a>FractionDenominatorGapMin</a>
                (respectively <a>FractionDenomDisplayStyleGapMin</a>)
                if the <a>math-style</a> is <code>inline</code>
                (respectively <code>display</code>) +
                the <a>ink line-ascent</a> of the <a>denominator</a>'s <a>margin box</a> −
                the <a>AxisHeight</a>.
              </li>
            </ul>
            <p>
              The <a>line-ascent</a> of the content is the maximum between:
            </p>
            <ul>
              <li>
                 <code>Numerator Shift</code> +
                 the <a>line-ascent</a> of the <a>numerator</a>'s <a>margin box</a>.
              </li>
              <li>
                −<code>Denominator Shift</code> +
                the <a>line-ascent</a> of the <a>denominator</a>'s <a>margin box</a>
              </li>
              <li>
                <a>AxisHeight</a> plus half the
                <a>fraction line thickness</a>.
              </li>
            </ul>
            <p>
              The <a>line-descent</a> of the content is the maximum between:
            </p>
            <ul>
              <li>
                −<code>Numerator Shift</code>
                + the <a>line-descent</a> of the <a>numerator</a>'s <a>margin box</a>.
              </li>
              <li>
                <code>Denominator Shift</code>
                + the <a>line-descent</a> of the <a>denominator</a>'s <a>margin box</a>.
              </li>
              <li>
                −<a>AxisHeight</a> plus half the
                <a>fraction line thickness</a>.
              </li>
              <li>0</li>
            </ul>
            <p>
              The <a>inline offset</a> of the <a>numerator</a> (respectively <a>denominator</a>)
              is the half the <a>inline size</a> of the content −
              half the <a>inline size</a> of
              the <a>numerator</a>'s <a>margin box</a>
              (respectively <a>denominator</a>'s <a>margin box</a>).
            </p>
            <p>
              The <a>alphabetic baseline</a> of the <a>numerator</a> (respectively <a>denominator</a>)
              is shifted away from the <a>alphabetic baseline</a> by a distance of
              <code>NumeratorShift</code> (respectively
              <code>DenominatorShift</code> )
              towards the <a>line-over</a> (respectively <a>line-under</a>).
            </p>
            <p>
              The <a>inline size</a> of the fraction bar is the
              <a>inline size</a> of the
              content and its
              <a>inline offset</a> is 0.
              The center of the fraction bar is shifted away from the <a>alphabetic baseline</a>
              by a distance of <a>AxisHeight</a> towards the <a>line-over</a>.
              Its <a>block size</a> is the
              <a>fraction line thickness</a>.
            </p>
          </section>
          <section id="fraction-with-zero-line-thickness">
            <h5>Fraction with zero line thickness</h5>
            <p>
              If the <a>fraction line thickness</a> is zero,
              the <code>&lt;mfrac&gt;</code> element is instead laid out as
              shown on <a href="#figure-box-mfrac-without-bar"></a>.
            </p>
            <figure id="figure-box-mfrac-without-bar">
              <img src="figures/mfracnobarbox.svg"/>
              <figcaption>Box model for the <code>&lt;mfrac&gt;</code> element without bar</figcaption>
            </figure>
            <p>
              The <a>min-content inline size</a>, <a>max-content inline size</a>
              and <a>inline size</a> of the content are calculated the same
              as in <a href="#fraction-with-nonzero-line-thickness"></a>.
            </p>
            <p>
              If there is an <a>inline stretch size constraint</a> or
              a <a>block stretch size constraint</a> then
              the <a>numerator</a> is also laid out with the same stretch size
              constraint
              and otherwise it is laid out without any stretch
              size constraint. The <a>denominator</a> is always laid out without
              any stretch size constraint.
            </p>
            <p>
              If the <a>math-style</a> is <code>inline</code> then
              <code>TopShift</code> and
              <code>BottomShift</code> are respectively
              set to <a>StackTopShiftUp</a> and <a>StackBottomShiftDown</a>.
              Otherwise <a>math-style</a> is <code>display</code>) and
              they are respectively set to <a>StackTopDisplayStyleShiftUp</a>
              and <a>StackBottomDisplayStyleShiftDown</a>).
            </p>
            <p>
              The <code>Gap</code> is defined to be
              (<code>BottomShift</code> −
              the <a>ink line-ascent</a> of the <a>denominator</a>'s <a>margin box</a>) +
              (<code>TopShift</code> −
              the <a>ink line-descent</a> of the <a>numerator</a>'s <a>margin box</a>).
              If <a>math-style</a> is <code>inline</code>
              then <code>GapMin</code>
              is <a>StackGapMin</a>
              otherwise <a>math-style</a> is <code>display</code>
              and it is <a>StackDisplayStyleGapMin</a>.
              If Δ = <code>GapMin</code> − <code>Gap</code> is positive then
              <code>TopShift</code> and <code>BottomShift</code>
              are respectively increased by Δ/2 and Δ − Δ/2.
            </p>
            <p>
              The <a>line-ascent</a> of the content is the maximum between:
            </p>
            <ul>
              <li>
                 <code>TopShift</code> +
                 the <a>line-ascent</a> of the <a>numerator</a>'s <a>margin box</a>.
              </li>
              <li>
                −<code>BottomShift</code>
                + the <a>line-ascent</a> of the <a>denominator</a>'s <a>margin box</a>.
              </li>
            </ul>
            <p>
              The <a>line-descent</a> of the content is the maximum between:
            </p>
            <ul>
              <li>
                −<code>TopShift</code>
                + the <a>line-descent</a> of the <a>numerator</a>'s <a>margin box</a>.
              </li>
              <li>
                <code>BottomShift</code>
                + the <a>line-descent</a> of the <a>denominator</a>'s <a>margin box</a>.
              </li>
              <li>0</li>
            </ul>
            <p>
              The <a>inline offsets</a> of the <a>numerator</a> and <a>denominator</a> are
              calculated the same as in
              <a href="#fraction-with-nonzero-line-thickness"></a>.
            </p>
            <p>
              The <a>alphabetic baseline</a> of the <a>numerator</a> (respectively <a>denominator</a>) is
              shifted away from the <a>alphabetic baseline</a> by a distance of
              <code>TopShift</code> (respectively −
              <code>BottomShift</code>) towards the
              <a>line-over</a> (respectively <a>line-under</a>).
            </p>
          </section>
        </section>
        <section id="radicals-msqrt-mroot">
          <h4>Radicals <code>&lt;msqrt&gt;</code>, <code>&lt;mroot&gt;</code></h4>
          <p>
            The
            <dfn><code>&lt;msqrt&gt;</code></dfn>
            and
            <dfn><code>&lt;mroot&gt;</code></dfn>
            elements construct radicals. The <code>&lt;msqrt&gt;</code> element is
            used for square roots, while the <code>&lt;mroot&gt;</code> element is
            used to draw radicals with indices, e.g. a cube root.
          </p>
          <p>
            The <code>&lt;msqrt&gt;</code> and <code>&lt;mroot&gt;</code>
            elements accept the attributes described
            in <a href="#global-attributes"></a>.
          </p>
          <p>
            The <code>&lt;msqrt&gt;</code> and <code>&lt;mroot&gt;</code>
            elements sets <a>math-superscript-shift-style</a> to
            <code>inline</code>.
            The <code>&lt;mroot&gt;</code> element sets
            increments <a><code>scriptlevel</code></a> by 2, and sets <a><code>displaystyle</code></a> to "false" in all
            but its first child.
            The <a href="#user-agent-stylesheet">user agent stylesheet</a>
            must contain the following rule in order to implement that behavior:
          </p>
          <pre class="css" data-include="user-agent-stylesheet/radicals.css"></pre>
          <p>
            If the <code>&lt;msqrt&gt;</code> or <code>&lt;mroot&gt;</code>
            element do not have their computed
            <a><code>display</code> property</a> equal to <code>math</code>
            then they are laid out according to the CSS specification where
            the corresponding value is described.
            Otherwise, the layout below is performed.
          </p>
          <div class="issue" data-number="15">Decide how to handle invalid
            mroot.</div>
          <p>
            If the <code>&lt;mroot&gt;</code> has less or more than two
            <a>in-flow</a> children,
            its layout algorithm
            is the same as the <a><code>&lt;mrow&gt;</code></a> element.
            Otherwise, the first <a>in-flow</a> child is called
            <dfn>mroot base</dfn> and
            the second <a>in-flow</a> child is called
            <dfn>mroot index</dfn>
            and its layout algorithm is explained below.
          </p>
          <div class="note" id="mroot-css-rules-on-children">
            In practice, an <code>&lt;mroot&gt;</code> element has two children
            that are <a>in-flow</a>. Hence the CSS rules basically performs
            <a><code>scriptlevel</code></a> and <a><code>displaystyle</code></a> changes for the index.
          </div>
          <p>
            The children of the
            <code>&lt;msqrt&gt;</code> element are laid out
            using the algorithm of the <a><code>&lt;mrow&gt;</code></a> element
            to produce a box that is also called the <dfn>msqrt base</dfn>.
            In particular, the
            <a>algorithm for stretching operators along the block axis</a> is used.
          </p>
          <section id="radical-symbol">
            <h5>Radical symbol</h5>
            <p>
              The radical symbol must only be painted if the
              <a data-cite="CSS2#visibility"><code>visibility</code></a> of
              the <code>&lt;msqrt&gt;</code> or <code>&lt;mroot&gt;</code>
              element is <code>visible</code>.
              In that case, the radical symbol must be painted with the
              <a data-cite="CSS-COLOR-3#foreground"><code>color</code></a>
              of that element.
            </p>
            <p>
              The <dfn>radical glyph</dfn> is the glyph obtained for the
              character U+221A SQUARE ROOT,
              applying the <code>rtlm</code> OpenType feature
              if the CSS property
              <a data-cite="CSS-WRITING-MODES-3#direction"><code>direction</code></a>
              is <code>rtl</code> [[OPEN-FONT-FORMAT]].
            </p>
            <p>
              The <dfn>radical gap</dfn> is given by
              <a>RadicalVerticalGap</a>
              if the <a>math-style</a> is <code>inline</code> and
              <a>RadicalDisplayStyleVerticalGap</a>
              if the <a>math-style</a> is <code>display</code>.
            </p>
            <p>
              The radical target size for the stretchy radical glyph is
              the sum of <a>RadicalRuleThickness</a>,
              <a>radical gap</a> and the ink height of the base.
            </p>
            <p>
              The <dfn>box metrics of the radical glyph</dfn> is the
              <a>box metrics of a stretchy glyph</a> stretched to
              <a>block dimension</a> the target size for the radical glyph.
            </p>
            <p>
              The <dfn>shaping of the surd</dfn>
              is performed by the algorithm to
              <a>shape a stretchy glyph</a> to <a>block dimension</a> the
              target size for the radical glyph.
            </p>
          </section>
          <section>
            <h5>Square root</h5>
            <p>
              The <code>&lt;msqrt&gt;</code> element is laid out as shown on
              <a href="#figure-box-msqrt"></a>.
            </p>
            <figure id="figure-box-msqrt">
              <img src="figures/msqrtbox.svg"/>
              <figcaption>Box model for the <code>&lt;msqrt&gt;</code> element</figcaption>
            </figure>
            <p>
              The <a>min-content inline size</a>
               (respectively <a>max-content inline size</a>)
              of the
              content is
              the sum of the
              <a>preferred inline size of a glyph stretched along the
                block axis</a>
              for the <a>radical glyph</a>
              and of the
              <a>min-content inline size</a> (respectively <a>max-content inline size</a>)
              of the base's <a>margin box</a>.
            </p>
            <p>
              The <a>inline size</a> of the content is the sum of the advance width
              of the <a>box metrics of the radical glyph</a> and
              of the <a>inline size</a> of the base's margin's box.
            </p>
            <p>
              The <a>line-ascent</a> of the content is the maximum between:
            </p>
            <ul>
              <li>The <a>line-ascent</a> of the base's <a>margin box</a>.</li>
              <li>The sum of the <a>ink line-ascent</a> of the base,
                the <a>radical gap</a>, the <a>RadicalRuleThickness</a>
                and <a>RadicalExtraAscender</a>.</li>
            </ul>
            <p>
              The <a>line-descent</a> of the content is the maximum between:
            </p>
            <ul>
              <li>The <a>line-descent</a> of the base's <a>margin box</a>.</li>
              <li>The sum of the <a>line-ascent</a> and <a>line-descent</a> for the
                <a>box metrics of the radical glyph</a> and of the
                <a>RadicalExtraAscender</a>, minus the
                <a>line-ascent</a> of the content.
              </li>
            </ul>
            <p>
              The <a>inline size</a> of the overbar is the <a>inline size</a> of the
              base's margin's box.
              The <a>inline offsets</a> of the base and overbar are also the same
              and equal to the width of the
              <a>box metrics of the radical glyph</a>.
            </p>
            <p>
              The <a>alphabetic baseline</a> of the base is aligned with the <a>alphabetic baseline</a>.
              The <a>block size</a> of the overbar is
              <a>RadicalRuleThickness</a>. Its vertical center is shifted away
              from the <a>alphabetic baseline</a> by a distance towards the <a>line-over</a>
              equal to the <a>line-ascent</a> of the content, minus
              the <a>RadicalExtraAscender</a>,
              minus half the <a>RadicalRuleThickness</a>.
            </p>
            <p>
              Finally, the <a>shaping of the surd</a> is performed:
            </p>
            <ul>
              <li>
                At <a>inline offset</a> 0.
              </li>
              <li>
                At <a>block offset</a> shifted away from the
                <a>line-over</a> edge of the overbar towards the <a>line-under</a>
                by a distance given by the ascent
                of the <a>box metrics of the radical glyph</a>.
              </li>
            </ul>
          </section>
          <section>
            <h5>Root with index</h5>
            <p>
              The <code>&lt;mroot&gt;</code> element is laid out as shown on
              <a href="#figure-box-mroot"></a>.
              The root index is first ignored and the base and
              radical glyph
              are laid out as
              shown on figure <a href="#figure-box-msqrt"></a>
              so that the content is represented by a box B.
            </p>
            <figure id="figure-box-mroot">
              <img src="figures/mrootbox.svg"/>
              <figcaption>Box model for the <code>&lt;mroot&gt;</code> element</figcaption>
            </figure>
            <div class="issue">Handle large negative RadicalKernAfterDegree?</div>
            <p>
              The <a>min-content inline size</a>
              (respectively <a>max-content inline size</a>) of the
              content is the sum
              of <a>RadicalKernBeforeDegree</a>,
              the index's
              <a>min-content inline size</a>
              (respectively <a>max-content inline size</a>)
              of the index's <a>margin box</a>,
              <a>RadicalKernAfterDegree</a>
              and of the
              <a>min-content inline size</a>
              (respectively <a>max-content inline size</a>) of B.
            </p>
            <p>
              The <a>inline size</a> of the content is the sum of
              <a>RadicalKernBeforeDegree</a>,
              the <a>inline size</a> of the index's <a>margin box</a>,
              <a>RadicalKernAfterDegree</a>
              and of the <a>inline size</a> of B.
            </p>
            <p>
              The <a>line-ascent</a> of the content is the maximum between:
            </p>
            <ul>
              <li>−the <a>line-descent</a> of B +
                <a>RadicalDegreeBottomRaisePercent</a> ×
                the <a>block size</a> of B + the <a>line-ascent</a> of the
                index's <a>margin box</a></li>
              <li>The <a>line-ascent</a> of B</li>
            </ul>
            <p>The <a>line-descent</a> of the content is the maximum between:</p>
            <ul>
              <li>the <a>line-descent</a> of B −
                <a>RadicalDegreeBottomRaisePercent</a> ×
                the <a>block size</a> of B + the <a>line-ascent</a> of the
                index's <a>margin box</a></li>
              <li>The <a>line-descent</a> of B</li>
            </ul>
            <p>
              The <a>inline offset</a> of the index is
              <a>RadicalKernBeforeDegree</a>. The inline-offset of the
              base is the same + the
              <a>inline size</a> of the index's <a>margin box</a>.
            </p>
            <p>
              The <a>alphabetic baseline</a> of B is aligned with the <a>alphabetic baseline</a>.
              The <a>alphabetic baseline</a> of the index is shifted away
              from the <a>line-under</a> edge by a distance of
              <a>RadicalDegreeBottomRaisePercent</a> ×
              the <a>block size</a> of B + the <a>line-descent</a> of the
              index's <a>margin box</a>.
            </p>
            <div class="note">
              In general, the kerning before the root index is positive while
              the kerning after it is negative, which means that the root
              element will have some inline-start space and that the root index
              will overlap the surd.
            </div>
          </section>
        </section>
        <section id="style-change-mstyle">
          <h4>Style Change <code>&lt;mstyle&gt;</code></h4>
          <p>
            Historically, the
            <dfn><code>&lt;mstyle&gt;</code></dfn>
            element was introduced to make
            style changes that affect the rendering of its contents.
          </p>
          <p>
            The <code>&lt;mstyle&gt;</code> element accepts the attributes described in
            <a href="#global-attributes"></a>. Its layout algorithm is the
            same as the <a><code>&lt;mrow&gt;</code></a> element.
          </p>
          <div class="note">
            <code>&lt;mstyle&gt;</code> is implemented for compatibility with full MathML. Authors whose only target is MathML Core are encouraged to use CSS for styling.
          </div>
        </section>
        <section id="error-message-merror">
          <h4>Error Message <code>&lt;merror&gt;</code></h4>
          <p>
            The
            <dfn><code>&lt;merror&gt;</code></dfn>
            element displays its contents as an
            ”error message”. The intent of this element is to provide a standard way
            for programs that generate MathML from other input to report syntax errors
            in their input.
          </p>
          <p>
            The <code>&lt;merror&gt;</code> element accepts the attributes described in
            <a href="#global-attributes"></a>. Its layout algorithm is the
            same as the <a><code>&lt;mrow&gt;</code></a> element.
            The <a href="#user-agent-stylesheet">user agent stylesheet</a>
            must contain the following rule in order to visually highlight the error
            message:
          </p>
          <pre class="css" data-include="user-agent-stylesheet/merror.css"></pre>
        </section>
        <section id="adjust-space-around-content-mpadded">
          <h4>Adjust Space Around Content <code>&lt;mpadded&gt;</code></h4>
          <div class="issue" data-number="103">Can this element be simplified?</div>
          <p>
            The
            <dfn><code>&lt;mpadded&gt;</code></dfn>
            element renders the same as its <a>in-flow</a> child content, but with the
            size and relative positioning point of its
            content modified according to <code>&lt;mpadded&gt;</code>’s attributes.
          </p>
          <p>
            The <code>&lt;mpadded&gt;</code> element accepts the attributes described
            in <a href="#global-attributes"></a> as well as the following
            attributes:
          </p>
          <ul>
            <li><a class="internalDFN" data-link-type="dfn" href="#attribute-mpadded-width"><code>width</code></a></li>
            <li><a class="internalDFN" data-link-type="dfn" href="#attribute-mpadded-height"><code>height</code></a></li>
            <li><a class="internalDFN" data-link-type="dfn" href="#attribute-mpadded-depth"><code>depth</code></a></li>
            <li><a class="internalDFN" data-link-type="dfn" href="#attribute-mpadded-lspace"><code>lspace</code></a></li>
            <li><a class="internalDFN" data-link-type="dfn" href="#attribute-mpadded-voffset"><code>voffset</code></a></li>
          </ul>
          <p>
            The
            <dfn id="attribute-mpadded-width"><code>mpadded@width</code></dfn> and
            <dfn id="attribute-mpadded-lspace"><code>mpadded@lspace</code></dfn> attributes, if present, must match the syntax
            <code>( "+" | "-" )? (<a><code>unsigned-length-percentage</code></a> | (<a><code>unsigned-number</code></a> "%"? "width"))</code>.
          </p>
          <p>
            The
            <dfn id="attribute-mpadded-height"><code>mpadded@height</code></dfn>,
            <dfn id="attribute-mpadded-depth"><code>mpadded@depth</code></dfn> and
            <dfn id="attribute-mpadded-voffset"><code>mpadded@voffset</code></dfn>
            attributes, if present, must match the syntax
            <code>( "+" | "-" )? (<a><code>unsigned-length-percentage</code></a> | (<a><code>unsigned-number</code></a> "%"? ("height" | "depth"))</code>.
          </p>
          <section>
            <h5>Inner box and requested parameters</h5>
            <p>
              <a>In-flow</a> children
              of the <code>&lt;mpadded&gt;</code> element are laid out
              using the algorithm of the <a><code>&lt;mrow&gt;</code></a> element
              to produce the
              <em>mpadded inner box</em> for the content with parameters called
              inner inline size, inner <a>line-ascent</a> and inner line-descent.
              The requested <code>&lt;mpadded&gt;</code>
              parameters are determined as follows:
            </p>
            <ul>
              <li>If the <code>width</code> (respectively <code>height</code>,
                <code>depth</code>, <code>lspace</code>, <code>voffset</code>)
                attributes are absent or invalid the requested width
                (respectively height, depth, lspace, voffset)
                is the inner inline size
                (respectively inner <a>line-ascent</a>, inner line-descent,
                <code>0</code>,
                <code>0</code>).
              </li>
              <li>If the <code>width</code> (respectively <code>height</code>,
                <code>depth</code>, <code>lspace</code>, <code>voffset</code>)
                attribute is an
                <a><code>unsigned-length-percentage</code></a>
                then the requested width
                (respectively height, depth, lspace, voffset)
                is the resolved value
                with percentage interpreted relative to
                the inner inline size (respectively
                inner line-ascent, inner line-descent, <code>0</code>,
                <code>0</code>).
              </li>
              <li>If the <code>width</code> (respectively <code>lspace</code>) attribute
                matches <code>"<a><code>unsigned-number</code></a>width"</code>
                then the requested width (respectively lspace) is the number multipled by
                the inner inline size. If instead it matches
                <code>"<a><code>unsigned-number</code></a>%width"</code>
                then it is the same value but divided by 100.
              </li>
              <li>If the <code>height</code> (respectively <code>depth</code>,
                <code>voffset</code>) attribute
                matches <code>"<a><code>unsigned-number</code></a>height"</code>
                then the requested height (respectively depth, voffset) is the number
                multipled by the inner line-ascent. If instead it matches
                <code>"<a><code>unsigned-number</code></a>%heigth"</code>
                then it is the same value but divided by 100.
              </li>
              <li>If the <code>height</code> (respectively <code>depth</code>,
                <code>voffset</code>) attribute
                matches <code>"<a><code>unsigned-number</code></a>depth"</code>
                then the requested height (respectively depth, voffset) is the number
                multipled by the inner line-descent. If instead it matches
                <code>"<a><code>unsigned-number</code></a>%depth"</code>
                then it is the same value but divided by 100.
              </li>
              <li>If the <code>width</code> (respectively <code>height</code>,
                <code>depth</code>, <code>lspace</code>, <code>voffset</code>)
                starts with a U+002B PLUS SIGN or U+002D HYPHEN-MINUS character,
                then choose ε = ±1 to match the sign of that character
                and let V be the requested width
                (respectively height, depth, lspace, voffset)
                obtained for the same attribute value with that character removed.
                Then the requested width (respectively height, depth, lspace, voffset)
                is the inner inline size (respectively inner line-ascent,
                inner line-descent, <code>0</code>,
                <code>0</code>) + εV.
              </li>
            </ul>
            <div class="issue" data-number="40">Allow negative width, lspace to
              produce negative spacing?</div>
            <p>
              If one of the requested width, depth, height or lspace values calculated
              above is negative then it is treated as <code>0</code>.
            </p>
          </section>
          <section>
            <h5>Layout of <code>&lt;mpadded&gt;</code></h5>
            <p>
              If the <code>&lt;mpadded&gt;</code> element does not have its
              computed
              <a><code>display</code> property</a> equal to <code>math</code>
              then it is laid out according to the CSS specification where
              the corresponding value is described.
              Otherwise, it is laid out as shown on
              <a href="#figure-box-mpadded"></a>.
            </p>
            <figure id="figure-box-mpadded">
              <img src="figures/mpaddedbox.svg"/>
              <figcaption>Box model for the <code>&lt;mpadded&gt;</code> element</figcaption>
            </figure>
            <p>
              The <a>min-content inline size</a> (respectively <a>max-content inline size</a>)
              of the content
              is the requested width calculated in
              <a href="#inner-box-and-requested-parameters"></a>
              but using the <a>min-content inline size</a> (respectively <a>max-content inline size</a>) of the
              mpadded inner box instead of the "inner inline size".
            </p>
            <div class="note">
              The calculation of
              <a>min-content inline size</a> and <a>max-content inline size</a>
              are well-defined because the requested width
              does not depend on any block metric.
            </div>
            <p>
              The <a>inline size</a> of the content
              is the requested width calculated in
              <a href="#inner-box-and-requested-parameters"></a>.
            </p>
            <p>
              The <a>line-ascent</a> of the content is the requested height.
              The <a>line-descent</a> of the content is the requested depth.
            </p>
            <p>
              The mpadded inner box is placed so that its <a>alphabetic baseline</a> is
              shifted away from the <a>alphabetic baseline</a> by the requested voffset
              towards the <a>line-over</a>.
            </p>
          </section>
        </section>
        <section id="making-sub-expressions-invisible-mphantom">
          <h4>Making Sub-Expressions Invisible <code>&lt;mphantom&gt;</code></h4>
          <p>
            Historically, the
            <dfn><code>&lt;mphantom&gt;</code></dfn>
            element was introduced to render
            its content invisibly, but with the same metrics size and other dimensions,
            including <a>alphabetic baseline</a> position</a>that its contents would have if they were
            rendered normally.
          </p>
          <p>
            The <code>&lt;mphantom&gt;</code> element accepts the attributes described
            in <a href="#global-attributes"></a>. Its layout algorithm is
            the same as the <a><code>&lt;mrow&gt;</code></a> element.
            The <a href="#user-agent-stylesheet">user agent stylesheet</a>
            must contain the following rule in order to hide the content:
          </p>
          <pre class="css" data-include="user-agent-stylesheet/mphantom.css"></pre>
          <div class="note">
            <code>&lt;mphantom&gt;</code> is implemented for compatibility with full MathML. Authors whose only target is MathML Core are encouraged to use CSS for styling.
          </div>
        </section>
        <section id="enclose-expression-inside-notation-menclose">
          <h4>Enclose Expression Inside Notation <code>&lt;menclose&gt;</code></h4>
          <div class="issue" data-number="105">Can this element be simplified?</div>
          <div class="issue" data-number="97">OpenType MATH values for menclose notations?</div>
          <p>
            The
            <dfn><code>&lt;menclose&gt;</code></dfn>
            element renders its content inside the enclosing notation.
            It accepts the attributes described in
            <a href="#global-attributes"></a> as well as the
            following attribute:
          </p>
          <ul>
            <li><a>notation</a></li>
          </ul>
          <p>
            The
            <dfn><code>notation</code></dfn>
            attribute, if present, must have a value that is a
            <a data-cite="HTML#set-of-space-separated-tokens">set of space-separated tokens</a>.
            A token value that is an
            <a data-cite="INFRA#ascii-case-insensitive">ASCII case-insensitive</a>
            match to one of
            <code>left</code>,
            <code>right</code>,
            <code>top</code>,
            <code>bottom</code>,
            <code>box</code>,
            <code>roundedbox</code>,
            <code>actuarial</code>,
            <code>madruwb</code>,
            <code>horizontalstrike</code>,
            <code>verticalstrike</code>
            <code>updiagonalstrike</code>,
            <code>downdiagonalstrike</code>,
            <code>longdiv</code>,
            <code>circle</code> is handled as described in the following
            subsections. Any other token value is ignored. If the
            <code>notation</code> attribute is absent then it is treated as
            equal to <code>longdiv</code>.
          </p>
          <div class="note">
            If the <code>notation</code> attribute is empty or equal to the
            MathML3 value <code>radical</code> then the <code>notation</code>
            attribute is valid and the
            <code>&lt;menclose&gt;</code> element will be rendered without
            any notation rather than with the default <code>longdiv</code>
            notation.
          </div>
          <p>
            If the <code>&lt;menclose&gt;</code> element does not have its
            computed
            <a><code>display</code> property</a> equal to <code>math</code>
            then it is laid out according to the CSS specification where
            the corresponding value is described.
            Otherwise, the layout below is performed.
          </p>
          <p>
            The notations must only be painted if the
            <a data-cite="CSS2#visibility"><code>visibility</code></a> of
            the <code>&lt;menclose&gt;</code> element is <code>visible</code>.
            In that case, the notations must be painted with the
            <a data-cite="CSS-COLOR-3#foreground"><code>color</code></a>
            of the <code>&lt;menclose&gt;</code> element.
          </p>
          <p>
            <a>In-flow</a>
            children of the <code>&lt;menclose&gt;</code> element are laid out
            using the algorithm of the <a><code>&lt;mrow&gt;</code></a> element
            to produce a box B corresponding to the content.
            In particular, they use the
            <a>algorithm for stretching operators along the block axis</a>.
            ξ<sub>8</sub> is used below to denote the
            default rule thickness and is set to <a>OverbarRuleThickness</a>.
          </p>
          <div class="note">
            ξ<sub>8</sub> is the notation used in [[?TEXBOOK]] for the
            default rule thickness.
          </div>
          <section>
            <h5>Multiple notations</h5>
            <p>
              If the <code>notation</code> attribute contains the
              <code>box</code> value,
              then it is treated as it was replaced with the set of values
              <code>left right top bottom</code>, removing duplicates values
              with the other of the notations, if any.
              Similarly, <code>actuarial</code> and
              <code>madruwb</code> notations are respectively treated as
              equivalent to <code>right top</code> and
              and <code>right bottom</code>.
            </p>
            <div class="issue" data-number="113">Specify in which order the notations are painted?</div>
            <p>
              The layout of other individual notation is explained in the
              following sections. In general when the <code>notation</code>
              attribute contains multiple
              values, each algorithm is applied individually to obtain
              boxes B<sub>1</sub>, B<sub>2</sub>, ... B<sub>n</sub>
              corresponding to their content. The layout
              of the <code>&lt;menclose&gt;</code> element is then performed
              as follows:
            </p>
            <ul>
              <li>
                For each layout B<sub>i</sub>, s<sub>left,i</sub> is the
                <a>line-left offset</a> of
                the B and s<sub>right,i</sub> is
                (<a>inline size</a> of B<sub>i</sub> − line-right offset of B).
                s<sub>left</sub> (respectively s<sub>right</sub>) is the maximum
                of the s<sub>left,i</sub> over
                (respectively s<sub>left,i</sub>) over all the i. Then
                the <a>inline size</a> is s<sub>left</sub> +
                the <a>inline size</a> of B + s<sub>right</sub>.
              </li>
              <li>
                Actually for each layout B<sub>i</sub>, the values
                s<sub>left,i</sub> and
                s<sub>right,i</sub> generally only depends on the <a>inline size</a>
                of B and parameter ξ<sub>8</sub> so it is possible to
                perform the same calculation replacing "inline size of B"
                with "<a>min-content inline size</a> of B" or
                "<a>max-content inline size</a> of B". The only exception is for
                the <code>longdiv</code> notation: In that case,
                s<sub>left,i</sub> is replaced with the
                <a>preferred inline size of a glyph stretched along the block axis</a>
                for U+0029 RIGHT PARENTHESIS.
                Again, it is possible to take the maximum values to calculate
                the
                <a>min-content inline size</a> and <a>max-content inline size</a> of the content.
              </li>
              <li>
                The <a>ink line-ascent</a> (respectively <a>line-ascent</a>)
                of the content
                is the maximum of all the
                <a>ink line-descent</a> (respectively <a>line-descent</a>)
                of the B<sub>i</sub>.
                The
                <a>ink line-descent</a> (respectively <a>line-descent</a>)
                of the content
                is the maximum of all the
                <a>ink line-descent</a> (respectively <a>line-descent</a>)
                of the B<sub>i</sub>.
              </li>
              <li>
                Finally each box at <a>line-left offset</a> and <a>line-over offset</a>
                x, y in the layout of B<sub>i</sub> is moved to
                <a>line-left offset</a> and <a>line-over offset</a>
                offsets x + s<sub>left</sub> − s<sub>left,i</sub>
                and y + <a>line-ascent</a> of the content −
                the <a>line-ascent</a> of B<sub>i</sub>.
              </li>
            </ul>
            <div class="note">
              The above description explains how to take the union of all
              the notations. In the layout of B<sub>i</sub>,
              B is placed at line-left position s<sub>left,i</sub> and
              its <a>alphabetic baseline</a> is at <a>line-over</a> position the <a>line-ascent</a> of
              B<sub>i</sub>. So the final shifts are compatible for
              the box B: It will be at line-left position s<sub>left</sub> and
              its <a>alphabetic baseline</a> aligned with the <a>alphabetic baseline</a>.
            </div>
          </section>
          <section>
            <h5>Border-like notations</h5>
            <ul>
              <li>
                <p>For the <code>left</code> notation, a bar is drawn
                  on the line-left side along the <a>block axis</a>
                  as shown on <a href="#figure-box-menclose-left"></a>.
                </p>
                <figure id="figure-box-menclose-left">
                  <img src="figures/leftbox.svg"/>
                  <figcaption>Box model for the <code>left</code>
                    notation of the <code>&lt;menclose&gt;</code> element</figcaption>
                </figure>
                <p>
                  The
                  <a>min-content inline size</a> (respectively <a>max-content inline size</a>)
                  of the content is
                  the
                  <a>min-content inline size</a> (respectively <a>max-content inline size</a>)
                  of B + 5ξ<sub>8</sub>.
                </p>
                <p>
                  The <a>inline size</a> is the <a>inline size</a> of B +
                  5ξ<sub>8</sub>, the <a>ink line-ascent</a> of the content
                  is the one of B +
                  <a>OverbarVerticalGap</a> + <a>OverbarRuleThickness</a>
                  and the <a>ink line-descent</a> of the content is the one of B +
                  <a>UnderbarVerticalGap</a> + <a>UnderbarRuleThickness</a>.
                  The <a>line-ascent</a> (respectively <a>line-descent</a>) of the content
                  is the maximum
                  of between the <a>ink line-ascent</a> (respectively <a>ink line-descent</a>)
                  of the content
                  and the <a>line-ascent</a> (respectively <a>line-descent</a>) of B.
                </p>
                <p>
                  B is placed so that its <a>alphabetic baseline</a> matches the <a>alphabetic baseline</a> and
                  its line-left offset is 5ξ<sub>8</sub>.
                  The <a>inline size</a> of the bar is ξ<sub>8</sub>,
                  its <a>block size</a> is the <a>block size</a> of the content,
                  its line-left offset
                  is ξ<sub>8</sub> and its <a>line-over offset</a> is 0.
                </p>
              </li>
              <li>
                <p>
                  The <code>right</code> notation is handled the same as the
                  <code>left</code> notation,
                  but with the bar placed on the line-right side. The block
                  metrics,
                  <a>min-content inline size</a>, <a>max-content inline size</a>
                  and <a>inline size</a> of the content are the same.
                </p>
                <p>
                  The <a>inline size</a> of the bar is ξ<sub>8</sub>,
                  its line-left offset is the <a>inline size</a> −
                  2ξ<sub>8</sub> and the line-left offset of B is 0.
                </p>
              </li>
              <li>
                <p>For the <code>top</code> notation, a bar is drawn
                  on the <a>line-over</a> side along the <a>inline axis</a>
                  as shown on <a href="#figure-box-menclose-top"></a>.
                </p>
                <p>
                  <figure id="figure-box-menclose-top">
                    <img src="figures/topbox.svg"/>
                    <figcaption>Box model for the <code>top</code>
                      notation of the <code>&lt;menclose&gt;</code> element</figcaption>
                  </figure>
                <p>
                  The
                  <a>min-content inline size</a> (respectively <a>max-content inline size</a>)
                  of the content is
                  the
                  <a>min-content inline size</a> (respectively <a>max-content inline size</a>)
                  of B + 8ξ<sub>8</sub>.
                </p>
                <p>
                  The <a>inline size</a> of the content is the <a>inline size</a> of B +
                  8ξ<sub>8</sub>, the <a>ink line-ascent</a> of the content
                  is the one of B +
                  <a>OverbarVerticalGap</a> +  <a>OverbarRuleThickness</a>.
                  The <a>line-ascent</a> of the content
                  is the maximum between the <a>line-ascent</a>
                  of B and the <a>ink line-ascent</a> of the content +
                  <a>OverbarExtraAscender</a>.
                  The <a>line-descent</a> of the content
                  is the <a>line-descent</a> of B.
                </p>
                <p>
                  B is placed so that its <a>alphabetic baseline</a> matches the <a>alphabetic baseline</a> and
                  its line-left offset is 4ξ<sub>8</sub>.
                  The <a>inline size</a> of the bar is the <a>inline size</a> of the content,
                  its <a>block size</a> is <a>OverbarRuleThickness</a>,
                  its line-left offset
                  is 0 and its <a>line-over offset</a> is the ascent −
                  the <a>ink line-ascent</a> of B − <a>OverbarVerticalGap</a> −
                  <a>OverbarRuleThickness</a>.
                </p>
              </li>
              <li>
                <p>
                  The <code>bottom</code> notation is drawn the same as the
                  <code>top</code> notation,
                  but with the bar placed on the <a>line-under</a> side of B and using
                  parameters
                  <a>UnderbarRuleThickness</a>,
                  <a>UnderbarVerticalGap</a>
                  and <a>UnderbarExtraDescender</a>.
                  The inline metrics are the same.
                </p>
                <p>
                  The <a>ink line-descent</a> of the content is the one of B +
                  <a>UnderbarVerticalGap</a> +  <a>UnderbarRuleThickness</a>.
                  The <a>line-descent</a> of the content
                  is the maximum between the <a>line-descent</a>
                  of B and the <a>ink line-descent</a> of the content +
                  <a>UnderbarExtraDescender</a>.
                  The <a>line-ascent</a> of the content
                  is the <a>line-ascent</a> of B.
                </p>
                <p>
                  B is placed so that its <a>alphabetic baseline</a> matches the <a>alphabetic baseline</a>.
                  The <a>block size</a> of the bar is <a>UnderbarRuleThickness</a>
                  and its <a>line-over offset</a> is the <a>line-ascent</a> of the content +
                  the <a>ink line-descent</a> of B + <a>UnderbarVerticalGap</a>.
                </p>
              </li>
            </ul>
          </section>
          <section>
            <h5>Strike notations</h5>
            <ul>
              <li>
                <p>
                  For the <code>horizontalstrike</code> notation,
                  the metrics are the same as B.
                  A bar of <a>inline size</a> the <a>inline size</a> of the content and
                  of <a>block size</a> ξ<sub>8</sub> is drawn
                  at <a>line-over</a> position minus half ξ<sub>8</sub>.
                  See <a href="#figure-box-horizontal-strike"></a>.
                </p>
                <figure id="figure-box-horizontal-strike">
                  <img src="figures/horizstrikebox.svg"/>
                  <figcaption>Box model for the <code>horizontalstrike</code>
                    notation of the <code>&lt;menclose&gt;</code> element</figcaption>
                </figure>
              </li>
              <li>
                <p>
                  For the <code>verticalstrike</code> notation,
                  the metrics are the same as B.
                  A bar of <a>inline size</a> ξ<sub>8</sub> and
                  of <a>block size</a> the <a>block size</a> of the content is drawn
                  at line-left position
                  half the <a>inline size</a> of the content minus half ξ<sub>8</sub>.
                </p>
              </li>
              <li>
                <p>
                  For the <code>updiagonalstrike</code> notation,
                  a bar is drawn
                  going from the <a>line-left</a> <a>line-under</a> corner to the
                  <a>line-right</a> <a>line-over</a> corner as shown on
                  <a href="#figure-box-menclose-up-diagonal-strike"></a>.
                </p>
                <p>
                  The
                  <a>min-content inline size</a>, <a>max-content inline size</a> and <a>inline size</a>
                  of the content are the one of B + ξ<sub>8</sub>.
                </p>
                <p>
                  The<a>line-ascent</a> of the content is the
                  <a>line-ascent</a> of B + half
                  ξ<sub>8</sub>.
                  The <a>line-descent</a> of the content
                  is the <a>line-descent</a> of
                  B + half
                  ξ<sub>8</sub>.
                </p>
                <p>
                  B is placed so that its <a>alphabetic baseline</a> is the <a>alphabetic baseline</a> and
                  its line-left offset is half ξ<sub>8</sub>.
                </p>
                <p>
                  Using terminology from [[SVG]],
                  the bar is drawn with a line
                  of thickness ξ<sub>8</sub> going from the
                  <a>line-under</a> <a>line-left</a> corner of B
                  to the <a>line-over</a> line-right corner of B with
                  <code>stroke-linecap</code> set to <code>butt</code>.
                </p>
                <figure id="figure-box-menclose-up-diagonal-strike">
                  <img src="figures/updiagstrikebox.svg"/>
                  <figcaption>Box model for the <code>updiagonalstrike</code>
                    notation of the <code>&lt;menclose&gt;</code> element</figcaption>
                </figure>
              </li>
              <li>
                <p>
                  For the <code>downdiagonalstrike</code> notation,
                  a bar is drawn
                  going from the line-left <a>line-over</a> corner to the
                  <a>line-right</a> <a>line-under</a> corner. The metrics are the same as
                  for the <code>updiagonalstrike</code> notation.
                </p>
              </li>
            </ul>
          </section>
          <section>
            <h5>Enclosing notations</h5>
            <ul>
              <li>
                <p>
                  The <code>roundedbox</code> notation is drawn as
                  shown on <a href="#figure-box-menclose-roundedbox"></a>.
                </p>
                <figure id="figure-box-menclose-roundedbox">
                  <img src="figures/roundedbox.svg"/>
                  <figcaption>Box model for the <code>roundedbox</code>
                    notation of the <code>&lt;menclose&gt;</code> element</figcaption>
                </figure>
                <p>
                  <a>min-content inline size</a>, <a>max-content inline size</a> and <a>inline size</a>
                  of the content are the
                  ones of B plus 10ξ<sub>8</sub>.
                </p>
                <p>
                  The <a>ink line-ascent</a> (respectively <a>line-descent</a>)
                  of the content is the
                  <a>ink line-ascent</a> (respectively <a>ink line-descent</a>) of B + 4ξ<sub>8</sub>.
                  The <a>line-ascent</a> (respectively <a>line-descent</a>) of the content is
                  the maximum between the <a>line-ascent</a> (respectively
                  <a>line-descent</a>) of B
                  and the <a>ink line-ascent</a> (respectively <a>ink line-descent</a>)
                  of the content plus ξ<sub>8</sub>.
                </p>
                <p>
                  B is placed so that its <a>alphabetic baseline</a> is the <a>alphabetic baseline</a> and
                  its line-left offset is 5ξ<sub>8</sub>.
                  If B' is the ink box B expanded on each side by
                  ½7ξ<sub>8</sub> then using terminology from [[SVG]],
                  a rounded rectangle is drawn on B'
                  with parameters <code>rx</code>, <code>ry</code> and
                  <code>stroke-width</code> set to 3ξ<sub>8</sub>.
                </p>
              </li>
              <li>
                <p>
                  The <code>longdiv</code> notation is drawn similarly to the
                  <code>&lt;msqrt&gt;</code> element
                  (<a href="#figure-box-msqrt"></a>)
                  except that the CSS
                  <a data-cite="CSS-WRITING-MODES-3#direction"><code>direction</code></a>
                  is ignored and U+221A SQUARE ROOT is replaced with
                  U+0029 RIGHT PARENTHESIS. The rule thickness is ξ<sub>8</sub>,
                  the gap between content and overbar is 3ξ<sub>8</sub> and the
                  extra ascender is ξ<sub>8</sub>.
                </p>
              </li>
              <li>
                <p>
                  The <code>circle</code> notation is drawn as shown
                  on <a href="#figure-box-menclose-circle"></a>.
                  Given the ink box of width w and height h, an ellipse is drawn using
                  the axes of symmetry of this ink box, the radii
                  w x ½√2, h x ½√2 and thickness ξ<sub>8</sub>.
                  Space of ξ<sub>8</sub> is added each side of the ellipse's ink
                  box.
                </p>
                <p>
                  The <a>min-content inline size</a>, <a>max-content inline size</a>
                  and <a>inline size</a> of the content are the ones of B times √2 plus
                  3ξ<sub>8</sub>.
                </p>
                <p>
                  The <a>ink line-ascent</a> (respectively <a>ink line-descent</a>) of the content
                  is the <a>ink line-ascent</a> (respectively <a>ink line-descent</a>) of B times
                  √2 plus ½ξ<sub>8</sub>. The <a>line-ascent</a>
                  (respectively <a>line-descent</a>) of the content
                  is the maximum between the
                  <a>line-ascent</a> (respectively <a>line-descent</a>) of B and the
                  <a>ink line-ascent</a> (respectively <a>ink line-descent</a>) of the content
                  plus ξ<sub>8</sub>.
                </p>
                <p>
                  Finally, B is placed so that its <a>alphabetic baseline</a> is aligned with
                  the <a>alphabetic baseline</a> and its line-left offset is
                  ½(√2 − 1) times the <a>inline size</a> of B plus 3ξ<sub>8</sub>/2.
                </p>
                <figure id="figure-box-menclose-circle">
                  <img src="figures/circlebox.svg"/>
                  <figcaption>Box model for the <code>circle</code>
                    notation of the <code>&lt;menclose&gt;</code> element</figcaption>
                </figure>
              </li>
            </ul>
          </section>
        </section>
      </section>
      <section id="script-and-limit-schemata">
        <h3>Script and Limit Schemata</h3>
        <p>
          The elements described in this section position one or more scripts
          around a base. Attaching various kinds of scripts and embellishments
          to symbols is a very common notational device in mathematics. For
          purely visual layout, a single general-purpose element could suffice
          for positioning scripts and embellishments in any of the traditional
          script locations around a given base. However, in order to capture
          the abstract structure of common notation better, MathML provides
          several more specialized scripting elements.
        </p>
        <p>
          In addition to sub/superscript elements, MathML has overscript and
          underscript elements that place scripts above and below the base.
          These elements can be used to place limits on large operators, or fo
          placing accents and lines above or below the base.
        </p>
        <section id="subscripts-and-superscripts-msub-msup-msubsup">
          <h4>Subscripts and Superscripts <code>&lt;msub&gt;</code>, <code>&lt;msup&gt;</code>, <code>&lt;msubsup&gt;</code></h4>
          <div class="issue" data-number="22">Use MathKernInfo?</div>
          <div class="issue" data-number="27">subscriptshift/superscriptshift attributes?</div>
          <p>
            The <dfn><code>&lt;msub&gt;</code></dfn>,
            <dfn><code>&lt;msup&gt;</code></dfn> and
            <dfn><code>&lt;msubsup&gt;</code></dfn> elements are used to attach
            subscript and superscript to a MathML expression.
            They accept the attributes described in
            <a href="#global-attributes"></a>.
          </p>
          <p>
            If the
            <code>&lt;msub&gt;</code>,
            <code>&lt;msup&gt;</code> or
            <code>&lt;msubsup&gt;</code> elements do not have their
            computed
            <a><code>display</code> property</a> equal to <code>math</code>
            then they are laid out according to the CSS specification where
            the corresponding value is described.
            Otherwise, the layout below is performed.
          </p>
          <section>
            <h5>Children of <code>&lt;msub&gt;</code>,
            <code>&lt;msup&gt;</code>, <code>&lt;msubsup&gt;</code></h5>
            <div class="issue" data-number="15">Decide how to handle invalid
              markup.</div>
            <p>
              If the <code>&lt;msub&gt;</code> element
              has less or more than two <a>in-flow</a> children, its layout algorithm
              is the same as the <a><code>&lt;mrow&gt;</code></a> element.
              Otherwise, the first <a>in-flow</a> child is called the
              <dfn>msub base</dfn>, the second <a>in-flow</a> child is called the
              <dfn>msub subscript</dfn> and the layout algorithm is explained
              in <a href="#base-with-subscript"></a>.
            </p>
            <p>
              If the <code>&lt;msup&gt;</code> element
              has less or more than two <a>in-flow</a> children, its layout algorithm
              is the same as the <a><code>&lt;mrow&gt;</code></a> element.
              Otherwise, the first <a>in-flow</a> child is called the
              <dfn>msup base</dfn>, the second <a>in-flow</a> child is called the
              <dfn>msup superscript</dfn> and the layout algorithm is explained
              in <a href="#base-with-superscript"></a>.
            </p>
            <p>
              If the <code>&lt;msubsup&gt;</code> element
              has less or more than three <a>in-flow</a> children, its layout algorithm
              is the same as the <a><code>&lt;mrow&gt;</code></a> element.
              Otherwise, the first <a>in-flow</a> child is called the
              <dfn>msubsup base</dfn>, the second <a>in-flow</a> child
              is called the <dfn>msubsup subscript</dfn>,
              its third <a>in-flow</a> child is called
              the <dfn>msupsup superscript</dfn> and the layout algorithm is explained
              in <a href="#base-with-subscript-and-superscript"></a>.
            </p>
          </section>
          <section>
            <h5>Base with subscript</h5>
            <p>
              The <code>&lt;msub&gt;</code> element is laid out as shown on
              <a href="#figure-box-msub"></a>.
              <code>LargeOpItalicCorrection</code>
              is the <a>italic correction</a> of the base
              if it is an <a>embellished operator</a> with
              the <a><code>largeop</code></a> property and 0 otherwise.
            </p>
            <figure id="figure-box-msub">
              <img src="figures/msubbox.svg"/>
              <figcaption>Box model for the <code>&lt;msub&gt;</code> element</figcaption>
            </figure>
            <p>
              The
              <a>min-content inline size</a> (respectively <a>max-content inline size</a>) of the content is the
              <a>min-content inline size</a> (respectively <a>max-content inline size</a>) inline size of the base's <a>margin box</a> −
              <code>LargeOpItalicCorrection</code> +
              <a>min-content inline size</a> (respectively <a>max-content inline size</a>) of
              the subscript's <a>margin box</a> + <a>SpaceAfterScript</a>.
            </p>
            <p>
              If there is an
              <a>inline stretch size constraint</a>
              or a <a>block stretch size constraint</a>
              then the base is also laid out with the same stretch size
              contraint and otherwise it is laid out without any stretch
              size constraint. The scripts are always laid out without
              any stretch size constraint.
            </p>
            <p>
              The <a>inline size</a> of the content
              is the inline size of the base's <a>margin box</a> −
              <code>LargeOpItalicCorrection</code> +
              the <a>inline size</a> of
              the subscript's <a>margin box</a> + <a>SpaceAfterScript</a>.
            </p>
            <p>
              <code>SubShift</code> is the maximum between:
            </p>
            <ul>
              <li><a>SubscriptShiftDown</a></li>
              <li>the <a>ink line-ascent</a> of the
                subscript's <a>margin box</a> − <a>SubscriptTopMax</a></li>
              <li><a>SubscriptBaselineDropMin</a> + the <a>ink line-descent</a> of the
                base's <a>margin box</a></li>
            </ul>
            <p>
              The <a>line-ascent</a> of the content is the maximum between:
            </p>
            <ul>
              <li>The <a>line-ascent</a> of the base's <a>margin box</a>.</li>
              <li>The <a>line-ascent</a> of the subcript's <a>margin box</a> −
                <code>SubShift</code>.</li>
            </ul>
            <p>
              The <a>line-descent</a> of the content is the maximum between:
            </p>
            <ul>
              <li>The <a>line-descent</a> of the base's <a>margin box</a>.</li>
              <li>The <a>line-descent</a> of the subcript's <a>margin box</a> +
                <code>SubShift</code>.</li>
            </ul>
            <p>
              The <a>inline offset</a> of the base is 0 and the <a>inline offset</a> of the
              subscript is the <a>inline size</a> of the base's <a>margin box</a> −
              <code>LargeOpItalicCorrection</code>.
            </p>
            <p>
              The base is placed so that its <a>alphabetic baseline</a>
              matches the <a>alphabetic baseline</a>. The subscript is placed so that its <a>alphabetic baseline</a>
              is shifted away from the <a>alphabetic baseline</a> by <code>SubShift</code>
              towards the <a>line-under</a>.
            </p>
          </section>
          <section>
            <h5>Base with superscript</h5>
            <p>
              The <code>&lt;msup&gt;</code> element is laid out as shown on
              <a href="#figure-box-msup"></a>.
              <code>ItalicCorrection</code>
              is the <a>italic correction</a> of the base
              if it is not an <a>embellished operator</a> with
              the <a><code>largeop</code></a> property and 0 otherwise.
            </p>
            <figure id="figure-box-msup">
              <img src="figures/msupbox.svg"/>
              <figcaption>Box model for the <code>&lt;msup&gt;</code> element</figcaption>
            </figure>
            <p>
              The
              <a>min-content inline size</a> (respectively <a>max-content inline size</a>) of
              the content
              is the
              <a>min-content inline size</a> (respectively <a>max-content inline size</a>) of
              the base's <a>margin box</a> +
              <code>ItalicCorrection</code> +
              the <a>min-content inline size</a> (respectively <a>max-content inline size</a>) of
              the superscript's <a>margin box</a> + <a>SpaceAfterScript</a>.
            </p>
            <p>
              If there is an
              <a>inline stretch size constraint</a>
              or a <a>block stretch size constraint</a>
              then the base is also laid out with the same stretch size
              contraint and otherwise it is laid out without any stretch
              size constraint. The scripts are always laid out without
              any stretch size constraint.
            </p>
            <p>
              The <a>inline size</a> of the content
              is the <a>inline size</a> of the base's <a>margin box</a> +
              <code>ItalicCorrection</code> +
              the <a>inline size</a> of
              the superscript's <a>margin box</a> + <a>SpaceAfterScript</a>.
            </p>
            <p>
              <code>SuperShift</code> is the maximum between:
            </p>
            <ul>
              <li>The value <a>SuperscriptShiftUpCramped</a> if the
                element has a computed
                <a>math-superscript-shift-style</a> property equal to
                <code>inline</code>, or
                <a>SuperscriptShiftUp</a> otherwise.</li>
              <li>
                <a>SuperscriptBottomMin</a> + the <a>ink line-descent</a> of the
                superscript's <a>margin box</a></li>
              <li>The <a>ink line-ascent</a> of the base's <a>margin box</a>
                − <a>SuperscriptBaselineDropMax</a></li>
            </ul>
            <p>
              The <a>line-ascent</a> of the content is the maximum between:
            </p>
            <ul>
              <li>The <a>line-ascent</a> of the base's <a>margin box</a>.</li>
              <li>The <a>line-ascent</a> of the supercript's <a>margin box</a> +
                <code>SuperShift</code>.</li>
            </ul>
            <p>
              The <a>line-descent</a> of the content is the maximum between:
            </p>
            <ul>
              <li>The <a>line-descent</a> of the base's <a>margin box</a>.</li>
              <li>The <a>line-descent</a> of the supercript's <a>margin box</a> −
                <code>SuperShift</code>.</li>
            </ul>
            <p>
              The <a>inline offset</a> of the base is 0 and the <a>inline offset</a> of
              superscript is the <a>inline size</a> of the base's <a>margin box</a> +
              <code>ItalicCorrection</code>.
            </p>
            <p>
              The base is placed so that its <a>alphabetic baseline</a>
              matches the <a>alphabetic baseline</a>. The superscript is placed so that its
              <a>alphabetic baseline</a>
              is shifted away from the <a>alphabetic baseline</a> by <code>SuperShift</code>
              towards the <a>line-over</a>.
            </p>
          </section>
          <section>
            <h5>Base with subscript and superscript</h5>
            <p>
              The <code>&lt;msubsup&gt;</code> element is laid out as shown on
              <a href="#figure-box-msup"></a>.
              <code>LargeOpItalicCorrection</code> and <code>SubShift</code>
              are set as in <a href="#base-with-subscript"></a>.
              <code>ItalicCorrection</code> and <code>SuperShift</code>
              are set as in <a href="#base-with-superscript"></a>.
            </p>
            <figure id="figure-box-msubsup">
              <img src="figures/msubsupbox.svg"/>
              <figcaption>Box model for the <code>&lt;msubsup&gt;</code> element</figcaption>
            </figure>
            <p>
              The
              <a>min-content inline size</a> (respectively <a>max-content inline size</a> and
              <a>inline size</a>) of the content is the maximum between the
              <a>min-content inline size</a> (respectively <a>max-content inline size</a> and
              <a>inline size</a>) of the content calculated in
              <a href="#base-with-subscript"></a> and
              <a href="#base-with-superscript"></a>.
            </p>
            <p>
              If there is an
              <a>inline stretch size constraint</a>
              or a <a>block stretch size constraint</a>
              then the base is also laid out with the same stretch size
              contraint and otherwise it is laid out without any stretch
              size constraint. The scripts are always laid out without
              any stretch size constraint.
            </p>
            <p>
              If there is an
              <a>inline stretch size constraint</a>
              or a <a>block stretch size constraint</a>
              then the base is also laid out with the same stretch size
              contraint and otherwise it is laid out without any stretch
              size constraint. The scripts are always laid out without
              any stretch size constraint.
            </p>
            <p>
              <code>SubSuperGap</code> is the gap between the two scripts
              along the <a>block axis</a> and is defined by
              (<code>SubShift</code> − the <a>ink line-ascent</a> of the subscript's
              <a>margin box</a>) +
              (<code>SuperShift</code> − the <a>ink line-descent</a> of the
              superscript's <a>margin box</a>).
              If <code>SubSuperGap</code> is not at least
              <a>SubSuperscriptGapMin</a> then the following steps are
              performed to ensure that the condition holds:
            </p>
            <ol>
              <li>
                Let Δ be <a>SuperscriptBottomMaxWithSubscript</a>
                − (<code>SuperShift</code> − the <a>ink line-descent</a> of the
                superscript's <a>margin box</a>).
                If Δ &gt; 0 then set Δ to the minimum between Δ set
                <a>SubSuperscriptGapMin</a> − <code>SubSuperGap</code> and
                increase <code>SuperShift</code> (and so
                <code>SubSuperGap</code> too) by Δ.
              </li>
              <li>
                Let Δ be <a>SubSuperscriptGapMin</a> − <code>SubSuperGap</code>.
                If Δ &gt; 0 then
                increase <code>SubscriptShift</code> (and so
                <code>SubSuperGap</code> too) by Δ.
              </li>
            </ol>
            <p>
              The <a>ink line-ascent</a> (respectively <a>line-ascent</a>, <a>ink line-descent</a>,
              <a>line-descent</a>) of the content
              is set to the maximum
              of the
              <a>ink line-ascent</a> (respectively <a>line-ascent</a>, <a>ink line-descent</a>,
              <a>line-descent</a>) of the content
              calculated in
              in <a href="#base-with-subscript"></a> and
              <a href="#base-with-superscript"></a>
              but using the adjusted values <code>SubShift</code> and
              <code>SuperShift</code> above.
            </p>
            <p>
              The <a>inline offset</a> and <a>block offset</a> of the base and scripts are
              performed the
              same as described in
              <a href="#base-with-subscript"></a> and
              <a href="#base-with-superscript"></a>.
            </p>
            <div class="note" id="msubsup-with-empty-scripts">
              <p>
                Even when the subscript (respectively superscript) is an empty
                box, <code>&lt;subsup&gt;</code>
                does not generally render the same as
                <a href="#base-with-superscript"></a>
                (respectively <a href="#base-with-subscript"></a>)
                because of the additional constraint on
                <code>SubSuperGap</code>.
                Moreover, positioning the empty subscript
                (respectively superscript)
                may also change the total size.
              </p>
              <p>
                In order to keep the algorithm simple, no attempt is made to
                handle empty scripts in a special way.
              </p>
             </div>
          </section>
        </section>
        <section id="underscripts-and-overscripts-munder-mover-munderover">
          <h4>Underscripts and Overscripts <code>&lt;munder&gt;</code>, <code>&lt;mover&gt;</code>, <code>&lt;munderover&gt;</code></h4>
          <p>
            The <dfn><code>&lt;munder&gt;</code></dfn>,
            <dfn><code>&lt;mover&gt;</code></dfn> and
            <dfn><code>&lt;munderover&gt;</code></dfn> elements are used to
            attach
            accents or limits placed under or over a MathML expression.
          </p>
          <p>
            The <code>&lt;munderover&gt;</code> element accepts the attribute
            described in <a href="#global-attributes"></a> as well as the
            following attributes:
          </p>
          <ul>
            <li><a href="#attribute-munderover-accent" class="internalDFN" data-link-type="dfn"><code>accent</code></a></li>
            <li><a href="#attribute-munderover-accentunder" class="internalDFN" data-link-type="dfn"><code>accentunder</code></a></li>
          </ul>
          <p>
            Similarly, the <code>&lt;mover&gt;</code> element
            (respectively <code>&lt;munder&gt;</code> element) accepts the
            attribute described in <a href="#global-attributes"></a>
            as well as the <a href="#attribute-munderover-accent"
                              class="internalDFN"
                              data-link-type="dfn"><code>accent</code></a>
            attribute (respectively the
            <a href="#attribute-munderover-accentunder"
               class="internalDFN"
               data-link-type="dfn"><code>accentunder</code></a> attribute).
          </p>
          <p>
            <dfn id="attribute-munderover-accent"><code>munderover@accent</code></dfn>,
            <dfn id="attribute-munderover-accentunder"><code>munderover@accentunder</code></dfn>,
            attributes, if present, must have values that are <a>booleans</a>.
            User agents must implement them as described in
            <a href="#displaystyle-and-scriptlevel-in-scripts"></a>.
          </p>
          <p>
            If the
            <code>&lt;munder&gt;</code>,
            <code>&lt;mover&gt;</code> or
            <code>&lt;munderover&gt;</code> elements do not have their
            computed
            <a><code>display</code> property</a> equal to <code>math</code>
            then they are laid out according to the CSS specification where
            the corresponding value is described.
            Otherwise, the layout below is performed.
          </p>
          <section>
            <h5>Children of <code>&lt;munder&gt;</code>,
            <code>&lt;mover&gt;</code>, <code>&lt;munderover&gt;</code></h5>
            <div class="issue" data-number="15">Decide how to handle invalid
              markup.</div>
            <p>
              If the <code>&lt;munder&gt;</code> element
              has less or more than two <a>in-flow</a> children, its layout algorithm
              is the same as the <a><code>&lt;mrow&gt;</code></a> element.
              Otherwise, the first <a>in-flow</a> child is called the
              <dfn>munder base</dfn> and the second <a>in-flow</a> child is called the
              <dfn>munder underscript</dfn>.
            </p>
            <p>
              If the <code>&lt;mover&gt;</code> element
              has less or more than two <a>in-flow</a> children, its layout algorithm
              is the same as the <a><code>&lt;mrow&gt;</code></a> element.
              Otherwise, the first <a>in-flow</a> child is called the
              <dfn>mover base</dfn> and the second <a>in-flow</a> child is called the
              <dfn>mover overscript</dfn>.
            </p>
            <p>
              If the <code>&lt;munderover&gt;</code> element
              has less or more than three <a>in-flow</a> children, its layout algorithm
              is the same as the <a><code>&lt;mrow&gt;</code></a> element.
              Otherwise, the first <a>in-flow</a> child is called the
              <dfn>munderover base</dfn>, the second <a>in-flow</a> child
              is called the <dfn>munderover underscript</dfn>
              and its third <a>in-flow</a> child is called
              the <dfn>munderover overscript</dfn>.
            </p>
            <p>
              If the
              <code>&lt;munder&gt;</code>, <code>&lt;mover&gt;</code> or
              <code>&lt;munderover&gt;</code> element have a computed
              <a>math-style</a> property equal to <code>inline</code>
              and their base is an <a>embellished operator</a> with the
              <a><code>movablelimits</code></a> property, then
              their layout algorithms are respectively
              the same as the ones described for
              <code>&lt;msub&gt;</code>, <code>&lt;msup&gt;</code> and
              <code>&lt;msubsup&gt;</code> in
              <a href="#base-with-subscript"></a>,
              <a href="#base-with-superscript"></a> and
              <a href="#base-with-subscript-and-superscript"></a>.
            </p>
            <p>
              Otherwise, the
              <code>&lt;mover&gt;</code>, <code>&lt;mover&gt;</code> and
              <code>&lt;munderover&gt;</code> layout algorithms are respectively
              described in
              <a href="#base-with-underscript"></a>,
              <a href="#base-with-overscript"></a> and
              <a href="#base-with-underscript-and-overscript"></a>
            </p>
          </section>
          <section>
            <h4>Algorithm for stretching operators along the inline axis</h4>
            <div class="issue" data-number="130">Avoid underestimation of min/max stretchy horizontal operators</div>
            <div class="issue" data-number="124">Layout of container with only stretchy <a>in-flow</a> children</div>
            <div class="issue" data-number="153">minsize/maxsize?</div>
            <p>
              The <dfn>algorithm for stretching operators along the inline
                axis</dfn>
              is as follows.
            </p>
            <ol>
              <li>
                If there is an
                <a>inline stretch size constraint</a> or
                <a>block stretch size constraint</a>
                then the element being laid out is an
                <a>embellished operator</a>. Layout the base
                with the same stretch size constraint.
              </li>
              <li>
                Split the list remaining <a>in-flow</a> children into a first list
                <code>L<sub>ToStretch</sub></code> containing
                <a>embellished operators</a> with
                a <a>stretchy</a> property and inline <a>stretch axis</a>
                and a second list <code>L<sub>NotToStretch</sub></code>.
              </li>
              <li>
                Perform layout without any stretch size constraint on
                all the items of <code>L<sub>NotToStretch</sub></code>.
                If <code>L<sub>ToStretch</sub></code> is empty then stop.
                If <code>L<sub>NotToStretch</sub></code> is empty, perform
                layout with stretch size constraint 0 on
                all the items of <code>L<sub>ToStretch</sub></code>.
              </li>
              <li>
                Calculate the target size <code>T</code> to
                the maximum <a>inline size</a> of the
                <a>margin boxes</a> of child boxes that have been laid out in the
                previous step.
              </li>
              <li>
                Layout or relayout all the elements of
                <code>L<sub>ToStretch</sub></code>
                with <a>inline stretch size constraint</a> <code>T</code>.
              </li>
            </ol>
          </section>
          <section>
            <h4>Base with underscript</h4>
            <p>
              The <code>&lt;munder&gt;</code> element is laid out as shown on
              <a href="#figure-box-munder"></a>.
              <code>LargeOpItalicCorrection</code>
              is the <a>italic correction</a> of the base
              if it is an <a>embellished operator</a> with
              the <a><code>largeop</code></a> property and 0 otherwise.
            </p>
            <figure id="figure-box-munder">
              <img src="figures/munderbox.svg"/>
              <figcaption>Box model for the <code>&lt;munder&gt;</code> element</figcaption>
            </figure>
            <div class="issue" data-number="130">Avoid underestimation of min/max stretchy horizontal operators</div>
            <p>
              The <a>min-content inline size</a> (respectively <a>max-content inline size</a>)
              of the content are
              calculated like the <a>inline size</a> of the content below
              but replacing the
              <a>inline sizes</a> of the base's <a>margin box</a> and underscript's <a>margin box</a>
              with the
              <a>min-content inline size</a> (respectively <a>max-content inline size</a>)
              of the base's <a>margin box</a> and underscript's <a>margin box</a>.
            </p>
            <p>
              The <a>in-flow</a> children are laid out
              using the <a>algorithm for stretching operators along the inline axis</a>.
            </p>
            <p>
              The <a>inline size</a> of the content is
              calculated by determining the absolute difference between:
            </p>
            <ul>
              <li>The maximum of:
                <ul>
                  <li>Half the <a>inline size</a> of the base's <a>margin box</a>.</li>
                  <li>Half the <a>inline size</a> of the underscript's <a>margin box</a> −
                    half <code>LargeOpItalicCorrection</code>.</li>
                </ul>
              </li>
              <li>The minimum of:
                <ul>
                  <li>−Half the <a>inline size</a> of the base's <a>margin box</a>.</li>
                  <li>−Half the <a>inline size</a> of the underscript's <a>margin box</a> −
                    half <code>LargeOpItalicCorrection</code>.</li>
                </ul>
              </li>
            </ul>
            <p>
              If m is the minimum calculated in the second item above then the
              <a>inline offset</a>
              of the base is −m − half the <a>inline size</a> of the base's <a>margin box</a>.
              The <a>inline offset</a> of the underscript is
              −m − half the <a>inline size</a> of the underscript's <a>margin box</a> −
              half <code>LargeOpItalicCorrection</code>.
            </p>
            <p>
              Parameters
              <code>UnderShift</code> and <code>UnderExtraDescender</code>
              are determined by considering three cases in the following order:
            </p>
            <ol>
              <li>
                <p>
                  The base is an
                  <a>embellished operator</a> with the
                  <a><code>largeop</code></a> property.
                  <code>UnderShift</code> is the maximum of
                </p>
                <ul>
                  <li><a>LowerLimitBaselineDropMin</a></li>
                  <li><a>LowerLimitGapMin</a> + the ascent of the
                    underscript.</li>
                </ul>
                <p>
                  <code>UnderExtraDescender</code> is 0.
                </p>
              </li>
              <li>
                <p>
                  The base is an
                  <a>embellished operator</a> with the
                  <a><code>stretchy</code></a> property
                  and <a>stretch axis</a> inline.
                  <code>UnderShift</code> is the maximum of:
                </p>
                <ul>
                  <li><a>StretchStackBottomShiftDown</a></li>
                  <li><a>StretchStackGapAboveMin</a> + the ascent of the
                    underscript.</li>
                </ul>
                <code>UnderExtraDescender</code> is 0.
              </li>
              <li>
                Otherwise,
                <code>UnderShift</code> is equal to <a>UnderbarVerticalGap</a>
                if the underscript is not an accent and to zero otherwise.
                <code>UnderExtraAscender</code> is
                <a>UnderbarExtraDescender</a>.
              </li>
            </ol>
            <p>
              The <a>line-ascent</a> of the content is the maximum between:
            </p>
            <ul>
              <li>The <a>line-ascent</a> of the base's <a>margin box</a>.</li>
              <li>The <a>line-ascent</a> of the underscript's <a>margin box</a> −
                <code>UnderShift</code>.</li>
            </ul>
            <p>
              The <a>line-descent</a> of the content is the maximum between:
            </p>
            <ul>
              <li>The <a>line-descent</a> of the base's <a>margin box</a>.</li>
              <li>The <a>line-descent</a> of the underscript's <a>margin box</a> +
                <code>UnderShift</code> + <code>UnderExtraAscender</code>.</li>
            </ul>
            <p>
              The <a>alphabetic baseline</a> of the base is aligned with the <a>alphabetic baseline</a>.
              The <a>alphabetic baseline</a> of the underscript is shifted away from the <a>alphabetic baseline</a>
              and towards the <a>line-under</a> by a distance equal to
              the <a>ink line-descent</a> of the base's <a>margin box</a>
              + <code>UnderShift</code>.
            </p>
          </section>
          <section>
            <h4>Base with overscript</h4>
            <p>
              The <code>&lt;mover&gt;</code> element is laid out as shown on
              <a href="#figure-box-mover"></a>.
              <code>LargeOpItalicCorrection</code>
              is the <a>italic correction</a> of the base
              if it is an <a>embellished operator</a> with
              the <a><code>largeop</code></a> property and 0 otherwise.
            </p>
            <figure id="figure-box-mover">
              <img src="figures/moverbox.svg"/>
              <figcaption>Box model for the <code>&lt;mover&gt;</code> element</figcaption>
            </figure>
            <div class="issue" data-number="130">Avoid underestimation of min/max stretchy horizontal operators</div>
            <p>
              The <a>min-content inline size</a> (respectively <a>max-content inline size</a>)
              of the content are
              calculated like the <a>inline size</a> of the content
              below but replacing the
              <a>inline sizes</a> of the base's <a>margin box</a> and underscript's <a>margin box</a> with
              the <a>min-content inline size</a> (respectively <a>max-content inline size</a>) of the base's <a>margin box</a> and underscript's <a>margin box</a>.
            </p>
            <p>
              The <a>in-flow</a> children are laid out
              using the <a>algorithm for stretching operators along the inline axis</a>.
            </p>
            <p>
              The <code>TopAccentAttachment</code> is the
              <a>top accent attachment</a> of the overscript or
              half the <a>inline size</a> of the overscript's <a>margin box</a>
              if it is undefined.
            </p>
            <p>
              The <a>inline size</a> of the content is
              calculated by
              applying the <a>algorithm for stretching operators along the inline axis</a> for
              layout and determining the absolute difference between:
            </p>
            <ul>
              <li>The maximum of:
                <ul>
                  <li>Half the <a>inline size</a> of the base's <a>margin box</a>.</li>
                  <li>The <a>inline size</a> of the overscript's <a>margin box</a>
                    − <code>TopAccentAttachment</code> +
                    half <code>LargeOpItalicCorrection</code>.</li>
                </ul>
              </li>
              <li>The minimum of:
                <ul>
                  <li>−Half the <a>inline size</a> of the base's <a>margin box</a>.</li>
                  <li>−<code>TopAccentAttachment</code> +
                    half <code>LargeOpItalicCorrection</code>.</li>
                </ul>
              </li>
            </ul>
            <p>
              If m is the minimum calculated in the second item above then the
              <a>inline offset</a>
              of the base is −m − half the <a>inline size</a> of the base's margin.
              The <a>inline offset</a> of the overscript is
              −m − half the <a>inline size</a> of the overscript's <a>margin box</a> +
              half <code>LargeOpItalicCorrection</code>.
            </p>
            <p>
              Parameters
              <code>OverShift</code> and <code>OverExtraDescender</code>
              are determined by considering three cases in the following order:
            </p>
            <ol>
              <li>
                <p>
                  The base is an
                  <a>embellished operator</a> with the
                  <a><code>largeop</code></a> property.
                  <code>OverShift</code> is the maximum of
                </p>
                <ul>
                  <li><a>UpperLimitBaselineRiseMin</a></li>
                  <li><a>UpperLimitGapMin</a> + the descent of the
                    overscript.</li>
                </ul>
                <p>
                  <code>OverExtraAscender</code> is 0.
                </p>
              <li>
                <p>
                  The base is an
                  <a>embellished operator</a> with the
                  <a><code>stretchy</code></a> property and
                  <a>stretch axis</a> inline.
                  <code>OverShift</code> is the maximum of:
                </p>
                <ul>
                  <li><a>StretchStackTopShiftUp</a></li>
                  <li><a>StretchStackGapBelowMin</a> + the descent of the
                    overscript.</li>
                </ul>
                <code>OverExtraDescender</code> is 0.
              </li>
              <li>
                <p>
                  Otherwise, <code>OverShift</code> is equal to</p>
                <ol>
                  <li><a>OverbarVerticalGap</a> if the overscript is not an
                    accent.</li>
                  <li>Or <a>AccentBaseHeight</a> minus the <a>line-ascent</a>
                    of the base's <a>margin box</a>
                    if this difference is nonnegative.</li>
                  <li>Or 0 otherwise.</li>
                </ol>
                <p>
                  <code>OverExtraAscender</code> is <a>OverbarExtraAscender</a>.
                </p>
              </li>
            </ol>
            <div class="note">
              For accent overscripts and bases with <a>line-ascents</a> that are at
              most
              <a>AccentBaseHeight</a>, the rule from
              [[OPEN-FONT-FORMAT]] [[?TEXBOOK]] is actually to align the
              <a>alphabetic baselines</a> of the overscripts and of the bases. This assumes that
              accent glyphs are designed in such a way that their ink bottoms
              are
              more or less <a>AccentBaseHeight</a> above their <a>alphabetic baselines</a>. Hence,
              the previous rule will guarantee that all the overscript bottoms
              are aligned while still avoiding collision with the bases.
              However, MathML can have arbitrary accent overscripts
              a more general and simpler rule is provided above: Ensure
              that the bottom of overscript is at least
              <a>AccentBaseHeight</a> above the <a>alphabetic baseline</a> of the base.
            </div>
            <p>
              The <a>line-ascent</a> of the content is the maximum between:
            </p>
            <ul>
              <li>The <a>line-ascent</a> of the base's <a>margin box</a>.</li>
              <li>The <a>line-ascent</a> of the overscript's <a>margin box</a> +
                <code>OverShift</code> + <code>OverExtraAscender</code>.</li>
            </ul>
            <p>
              The <a>line-descent</a> of the content is the maximum between:
            </p>
            <ul>
              <li>The <a>line-descent</a> of the base's <a>margin box</a>.</li>
              <li>The <a>line-descent</a> of the overscript's <a>margin box</a> −
                <code>OverShift</code>.</li>
            </ul>
            <p>
              The <a>alphabetic baseline</a> of the base is aligned with the <a>alphabetic baseline</a>.
              The <a>alphabetic baseline</a> of the overscript is shifted away from the <a>alphabetic baseline</a>
              and towards the <a>line-over</a> by a distance equal to
              the <a>ink line-ascent</a> of the base + <code>OverShift</code>.
            </p>
          </section>
          <section>
            <h4>Base with underscript and overscript</h4>
            <p>
              The general layout of <code>&lt;munderover&gt;</code> is shown on
              <a href="#figure-box-munderover"></a>. The
              <code>LargeOpItalicCorrection</code>,
              <code>UnderShift</code>,
              <code>UnderExtraDescender</code>,
              <code>OverShift</code>,
              <code>OverExtraDescender</code> parameters
              are calculated the same as in
              <a href="#base-with-underscript"></a> and
              <a href="#base-with-overscript"></a>.
            </p>
            <figure id="figure-box-munderover">
            <img src="figures/munderoverbox.svg"/>
            <figcaption>Box model for the <code>&lt;munderover&gt;</code> element</figcaption>
            </figure>
            <div class="issue" data-number="130">Avoid underestimation of min/max stretchy horizontal operators</div>
            <p>
              The <a>min-content inline size</a>, <a>max-content inline size</a>
              and <a>inline size</a> of the content
              are calculated as an absolute difference
              between a maximum <a>inline offset</a> and minimum <a>inline offset</a>.
              These extrema are calculated by taking the extremum value
              of the corresponding extrema calculated in
              <a href="#base-with-underscript"></a> and
              <a href="#base-with-overscript"></a>.
              The <a>inline offsets</a> of the base, underscript and
              overscript are calculated as in these sections but using
              the new minimum m (minimum of the corresponding minima).
            </p>
            <p>
              Like in these sections, the <a>in-flow</a> children are laid out
              using the <a>algorithm for stretching operators along the inline axis</a>.
            </p>
            <p>
              The <a>line-ascent</a> and <a>line-descent</a> of the content
              are also calculated by taking the extremum value
              of the extrema calculated in
              <a href="#base-with-underscript"></a> and
              <a href="#base-with-overscript"></a>.
            </p>
            <p>
              Finally, the <a>alphabetic baselines</a> of the base, undescript and overscript
              are calculated as in sections
              <a href="#base-with-underscript"></a> and
              <a href="#base-with-overscript"></a>.
            </p>
            <div class="note">
              <p>
                When the underscript (respectively overscript) is an empty
                box, the base and overscript (respectively underscript) are laid
                out similarly to
                <a href="#base-with-overscript"></a>
                (respectively <a href="#base-with-underscript"></a>)
                but the position of the empty underscript (respectively
                overscript) may add extra space.
                In order to keep the algorithm simple, no attempt is made to
                handle empty scripts in a special way.
              </p>
            </div>
          </section>
        </section>
        <section id="prescripts-and-tensor-indices-mmultiscripts">
          <h4>Prescripts and Tensor Indices <code>&lt;mmultiscripts&gt;</code></h4>
          <div class="issue" data-number="22">Use MathKernInfo?</div>
          <p>
            Presubscripts and tensor notations are represented
            the <dfn><code>&lt;mmultiscripts&gt;</code></dfn>
            with hints given by the
            <dfn><code>&lt;mprescripts&gt;</code></dfn>
            (to distinguish postscripts and prescripts)
            and
            <dfn><code>&lt;none&gt;</code></dfn> elements
            (to indicate empty scripts).
            These element accept the attributes described in
            <a href="#global-attributes"></a>.
          </p>
          <p>
            If the
            <code>&lt;mmultiscripts&gt;</code>,
            <code>&lt;mprescripts&gt;</code> or
            <code>&lt;none&gt;</code> elements do not have their
            computed
            <a><code>display</code> property</a> equal to <code>math</code>
            then they are laid out according to the CSS specification where
            the corresponding value is described.
            Otherwise, the layout below is performed.
          </p>
          <p>
            The empty
            <code>&lt;mprescripts&gt;</code> and <code>&lt;none&gt;</code>
            elements are laid out as an <a><code>&lt;mrow&gt;</code></a>
            element.
          </p>
          <div class="issue" data-number="15">Decide how to handle invalid
            markup.</div>
          <p>
            A valid <code>&lt;mmultiscripts&gt;</code> element contains the
            following <a>in-flow</a> children:
          </p>
          <ul>
            <li>
              A first <a>in-flow</a> child, called the
              <dfn>multiscripts base</dfn>, that is not a an
              <a><code>&lt;mprescripts&gt;</code></a> element.
            </li>
            <li>
              Followed by an even number of <a>in-flow</a> children called
              <dfn>multiscripts postscripts</dfn>, none of them being a
              <a><code>&lt;mprescripts&gt;</code></a> element.
              These scripts form a (possibly empty) list
              subscript, superscript, subscript, superscript,
              subscript, superscript, etc.
              Each consecutive couple of children subscript, superscript
              is called a
              <dfn>subscript/superscript pair</dfn>.
            </li>
            <li>Optionally followed by
              an <a><code>&lt;mprescripts&gt;</code></a> element and
              an even number of <a>in-flow</a> children called
              <dfn>mmultiscripts prescripts</dfn>, none of them being a
              <a><code>&lt;mprescripts&gt;</code></a> element.
              These scripts form a (possibly empty) list of
              <a>subscript/superscript pair</a>.
            </li>
          </ul>
          <p>
            If an <code>&lt;mmultiscripts&gt;</code> element is not valid then
            it is laid out the same as the
            <a><code>&lt;mrow&gt;</code></a> element.
            Otherwise the layout algorithm is explained below.
          </p>
          <div class="note">
            The <code>&lt;none&gt;</code> element is preserved for backward
            compatibility reasons but is actually not taken into account
            in the layout algorithm.
          </div>
          <section>
            <h5>Base with prescripts and postscripts</h5>
            <p>
              The <code>&lt;mmultiscripts&gt;</code> element is laid out as
              shown on <a href="#figure-box-mmultiscripts"></a>.
              For each postscript pair, the <code>ItalicCorrection</code>
              <code>LargeOpItalicCorrection</code> are defined as
              in <a href="#base-with-subscript"></a>
              and <a href="#base-with-superscript"></a>.
            </p>
            <figure id="figure-box-mmultiscripts">
              <img src="figures/mmultiscriptsbox.svg"/>
              <figcaption>Box model for the <code>&lt;mmultiscripts&gt;</code> element</figcaption>
            </figure>
            <p>
              The
              <a>min-content inline size</a> (respectively <a>max-content inline size</a>) of the
              content is
              calculated the same as the <a>inline size</a> of the content
              below, but replacing
              "<a>inline size</a>" with "<a>min-content inline size</a>"
              (respectively "<a>max-content inline size</a>") for the base's
              <a>margin box</a> and scripts's <a>margin boxes</a>.
            </p>
            <p>
              If there is an <a>inline stretch size constraint</a> or a
              <a>block stretch size constraint</a>
              the base is also laid out with the same stretch size constraint.
              Otherwise it is laid out without any stretch
              size constraint. The other elements are always laid out without
              any stretch size constraint.
            </p>
            <p>
              The <a>inline size</a> of the content
              is calculated with the following algorithm:
            </p>
            <ol>
              <li>Set <code>inline-offset</code> to 0.</li>
              <li>
                <p>
                  For each prescript pair, increment
                  <code>inline-offset</code> by <a>SpaceAfterScript</a> + the
                  maximum of
                </p>
                <ul>
                  <li>The <a>inline size</a> of the subscript's <a>margin box</a>.</li>
                  <li>The inline size of the superscript's <a>margin box</a>.</li>
                </ul>
              </li>
              <li>
                Increment <code>inline-offset</code> by the <a>inline size</a> of the
                base's <a>margin box</a> and
                set <code>inline-size</code> to <code>inline-offset</code>.
              </li>
              <li>
                <p>
                  For each postscript pair, modify
                  <code>inline-size</code> to be at least:
                </p>
                <ul>
                  <li>
                    x + the <a>inline size</a> of the subscript's <a>margin box</a> +
                    <code>LargeOpItalicCorrection</code>.
                  </li>
                  <li>
                    x + the <a>inline size</a> of the superscript's <a>margin box</a> −
                    <code>ItalicCorrection</code>.
                  </li>
                </ul>
                <p>Increment <code>inline-offset</code> to the maximum of:</p>
                <ul>
                  <li>
                    the <a>inline size</a> of the subscript's <a>margin box</a>.
                  </li>
                  <li>
                    the <a>inline size</a> of the superscript's <a>margin box</a>.
                  </li>
                </ul>
                <p>
                  Increment <code>inline-offset</code> by
                  <a>SpaceAfterScript</a>.
                </p>
              </li>
              <li>Return <code>inline-size</code></li>
            </ol>
            <p>
              <code>SubShift</code> (respectively <code>SuperShift</code>)
              is calculated by taking the maximum of all subshifts
              (respectively supershifts) of each
              subscript/superscript pair as described in
              <a href="#base-with-subscript-and-superscript"></a>.
            </p>
            <p>
              The <a>line-ascent</a> of the content is calculated
              by taking the maximum of all the <a>line-ascent</a>
              of each subscript/superscript pair as described in
              <a href="#base-with-subscript-and-superscript"></a>
              but using the <code>SubShift</code> and
              <code>SuperShift</code> values calculated above.
            </p>
            <p>
              The <a>line-descent</a> of the content is calculated
              by taking the maximum of all the <a>line-descent</a>
              of each subscript/superscript pair as described in
              <a href="#base-with-subscript-and-superscript"></a>
              but using the <code>SubShift</code> and
              <code>SuperShift</code> values calculated above.
            </p>
            <p>
              Finally, the placement of the <a>in-flow</a> children is performed using
              the
              following algorithm:
            </p>
            <ol>
              <li>Set <code>inline-offset</code> to 0.</li>
              <li>
                <p>For each prescript pair:</p>
                <ol>
                  <li>
                    Increment <code>inline-offset</code> by
                    <a>SpaceAfterScript</a>.
                  </li>
                  <li>
                    Set <code>pair-inline-size</code> to the maximum of
                    <ul>
                      <li>
                        the <a>inline size</a> of the subscript's <a>margin box</a>.
                      </li>
                      <li>
                        the <a>inline size</a> of the superscript's <a>margin box</a>.
                      </li>
                    </ul>
                  </li>
                  <li>
                    Place the subscript at inline-start position
                    <code>inline-offset</code> + <code>pair-inline-size</code>
                    − the <a>inline size</a> of the subscript's <a>margin box</a>.
                  </li>
                  <li>
                    Place the superscript at inline-start position
                    <code>inline-offset</code> + <code>pair-inline-size</code>
                    − the <a>inline size</a> of the superscript's <a>margin box</a>.
                  </li>
                  <li>
                    Place the subscript (respectively superscript) so its
                    <a>alphabetic baseline</a> is
                    shifted away from the <a>alphabetic baseline</a> by
                    <code>SubShift</code> (respectively <code>SuperShift</code>)
                    towards the <a>line-under</a> (respectively <a>line-over</a>).
                  </li>
                  <li>
                    Increment <code>inline-offset</code> by
                    <code>pair-inline-size</code>.
                  </li>
              </ol>
              <li>
                Place the base and <code>&lt;mprescript&gt;</code> boxes
                at <a>inline offsets</a>
                <code>inline-offset</code> and with their <a>alphabetic baselines</a>
                aligned with the <a>alphabetic baseline</a>.
              </li>
              <li>
                <p>
                  For each postscript pair:
                </p>
                <ol>
                  <li>
                    Set <code>pair-inline-size</code> to the maximum of
                    <ul>
                      <li>
                        the <a>inline size</a> of the subscript's <a>margin box</a>.
                      </li>
                      <li>
                        the <a>inline size</a> of the superscript's <a>margin box</a>.
                      </li>
                    </ul>
                  </li>
                  <li>
                    Place the subscript
                    at inline-start position <code>inline-offset</code>
                    − <code>LargeOpItalicCorrection</code>.
                  </li>
                  <li>
                    Place the superscript
                    at inline-start position <code>inline-offset</code>
                    + <code>ItalicCorrection</code>.
                  </li>
                  <li>
                    Place the subscript (superscript) so its <a>alphabetic baseline</a> is
                    shifted away from the <a>alphabetic baseline</a> by
                    <code>SubShift</code> (respectively <code>SuperShift</code>)
                    towards the <a>line-under</a> (respectively <a>line-over</a>).
                  </li>
                  <li>
                    Increment <code>inline-offset</code> by
                    <code>pair-inline-size</code>
                  </li>
                  <li>
                    Increment <code>inline-offset</code> by
                    <a>SpaceAfterScript</a>.
                  </li>
                </ol>
              </li>
            </ol>
            <div class="note">
              <p>
                An <code>&lt;mmultiscripts&gt;</code> with only one
                postscript pair is laid out the same as a
                <code>&lt;msubsup&gt;</code> with the same <a>in-flow</a> children.
                However, as
                <a href="#msubsup-with-empty-scripts">noticed for
                  <code>&lt;msubsup&gt;</code></a>,
                if additionally the subscript (respectively superscript) is an
                empty box then it is not necessarily laid out the same as an
                <code>&lt;msub&gt;</code>
                (respectively <code>&lt;msup&gt;</code>) element.
                In order to keep the algorithm simple, no attempt is made to
                handle empty or <code>&lt;none&gt;</code> scripts in a special
                way.
              </p>
            </div>
          </section>
        </section>
        <section id="displaystyle-and-scriptlevel-in-scripts">
          <h4>Displaystyle, scriptlevel and math-superscript-shift-style in scripts</h4>
          <p>
            For all <a>scripted elements</a>, the rule of thumb is to set
            <a><code>displaystyle</code></a> to <code>false</code> and
            to increment <a><code>scriptlevel</code></a> in all child
            elements but the first one.
            However, an <a><code>&lt;mover&gt;</code></a> (respectively
            <a><code>&lt;munderover&gt;</code></a>)
            element with an <a href="#attribute-munderover-accent" class="internalDFN" data-link-type="dfn"><code>accent</code></a>
            attribute that is an
            <a data-cite="INFRA#ascii-case-insensitive">ASCII case-insensitive</a>
            match to <code>"true"</code> does not increment scriptlevel within
            its second child (respectively third child). Similarly,
            <a><code>&lt;mover&gt;</code></a> and
            <a><code>&lt;munderover&gt;</code></a> elements
            with an <a href="#attribute-munderover-accent" class="internalDFN" data-link-type="dfn"><code>accentunder</code></a>
            attribute that is an
            <a data-cite="INFRA#ascii-case-insensitive">ASCII case-insensitive</a>
            match to <code>"true"</code> do not increment scriptlevel within
            their second child.
          </p>
          <p><code>&lt;mmultiscripts&gt;</code> sets
            <a><code>math-superscript-shift-style</code></a> to
            <code>inline</code> on its children at even position if they are
            before an <a>&lt;mprescripts&gt;</a>, and on those at odd position
            if they are after
            an <a>&lt;mprescripts&gt;</a>.
            The <code>&lt;msub&lt;</code> and <code>&lt;msubsup&lt;</code>
            elements set <a><code>math-superscript-shift-style</code></a> to
            <code>inline</code> on their second child.
            An <a><code>&lt;mover&gt;</code></a> and
            <a><code>&lt;munderover&gt;</code></a>
            elements with an <a href="#attribute-munderover-accent" class="internalDFN" data-link-type="dfn"><code>accent</code></a>
            attribute that is an
            <a data-cite="INFRA#ascii-case-insensitive">ASCII case-insensitive</a>
            match to <code>"true"</code> also sets <a><code>math-superscript-shift-style</code></a> to
            <code>inline</code> within their first child.
          </p>
          <p>
            The
            <a href="#user-agent-stylesheet"></a> must contain the following
            style in order to implement this behavior:
          </p>
          <pre class="css" data-include="user-agent-stylesheet/scripts.css"></pre>
          <div class="issue" data-number="76">
            In [[MathML3]] specification, the <a><code>scriptlevel</code></a> shouldn't be
            incremented either if the underscript/overscript is an
            <a>embellished operator</a> with the
            <a><code>accent</code></a> property.
          </div>
          <div class="note" id="scripted-elements-css-rules-on-children">
            In practice, all the children of the MathML elements described in
            this section are <a>in-flow</a> and the
            <code>&lt;mprescript&gt;</code> is empty.
            Hence the CSS rules essentially performs automatic <a><code>displaystyle</code></a> and
            <a><code>scriptlevel</code></a> changes for the scripts ; and
            <a><code>math-superscript-shift-style</code></a> changes for
            subscripts and sometimes the base.
          </div>
        </section>
      </section>
      <section id="tabular-math">
        <h3>Tabular Math</h3>
        <div class="issue" data-number="72">mlabeledtr?</div>
        <p>
          Matrices, arrays and other table-like mathematical notation are marked up
          using
          <a><code>&lt;mtable&gt;</code></a>
          <a><code>&lt;mtr&gt;</code></a>
          <a><code>&lt;mtd&gt;</code></a>
          elements.  These  elements are similar to the
          <a data-cite="HTML#the-table-element"><code>&lt;table&gt;</code></a>,
          <a data-cite="HTML#the-tr-element"><code>&lt;tr&gt;</code></a>
          and
          <a data-cite="HTML#the-td-element"><code>&lt;td&gt;</code></a>
          elements of [[HTML]].
        </p>
        <div class="issue" data-number="114">
          This describes a very partial support for [[MathML3]] tables.
          Do we want more? Should CSS be extended to cover math table's use cases?
        </div>
        <section id="table-or-matrix-mtable">
          <h4>Table or Matrix <code>&lt;mtable&gt;</code></h4>
          <p>The <dfn><code>&lt;mtable&gt;</code></dfn> is laid out as an
            <code>inline-table</code> and sets
            <code>displaystyle</code> to <code>false</code>. The
            <a href="#user-agent-stylesheet">user agent stylesheet</a> must contain
            the following rules in order to implement these properties:
          </p>
          <pre data-include="user-agent-stylesheet/mtable.css"></pre>
          <p>
            The <code>&lt;mtable&gt;</code> accepts the attributes described
            in <a href="#global-attributes"></a> as well as the following
            attribute:
            <ul>
              <li><a>frame</a></li>
            </ul>
          <p>
            The <dfn>frame</dfn> attribute, if present, must be an
            <a data-cite="INFRA#ascii-case-insensitive">ASCII case-insensitive</a>
            match
            to one of <code>none</code>, <code>solid</code> or
            <code>dashed</code>. The <a href="#user-agent-stylesheet">user agent
              stylesheet</a> must contain the following rules in order to implement
            that attribute:
          </p>
          <pre data-include="user-agent-stylesheet/mtable-frame.css"></pre>
          <div class="issue">Improve baseline description here.</div>
          <p>
            The <code>mtable</code> element is as a CSS
            <a data-cite="CSS-DISPLAY-3#valdef-display-table">table</a>
            and the
            <a>min-content inline size</a>, <a>max-content inline size</a>,
            <a>inline size</a>, <a>block size</a>,
            <a>first baseline set</a> and <a>last baseline set</a>
            sets are determined
            accordingly.
            The math axis is aligned with the center of the table.
          </p>
        </section>
        <section>
          <h4>Row in Table or Matrix <code>&lt;mtr&gt;</code></h4>
          <p>
            The <dfn><code>&lt;mtr&gt;</code></dfn> is laid out as
            <code>table-row</code>. The
            <a href="#user-agent-stylesheet">user agent stylesheet</a> must contain
            the following rules in order to implement that behavior:
          </p>
          <pre data-include="user-agent-stylesheet/mtr.css"></pre>
          <p>
            The <code>&lt;mtr&gt;</code> accepts the attributes described
            in <a href="#global-attributes"></a>.
          </p>
        </section>
        <section>
          <h4>Entry in Table or Matrix <code>&lt;mtd&gt;</code></h4>
          <p>
            The <dfn><code>&lt;mtd&gt;</code></dfn> is laid out as
            a <code>table-cell</code> with content centered in the cell and
            a default padding. The
            <a href="#user-agent-stylesheet">user agent stylesheet</a> must contain
            the following rules:
          </p>
          <pre data-include="user-agent-stylesheet/mtd.css"></pre>
          <p>
            The <code>&lt;mtr&gt;</code> accepts the attributes described
            in <a href="#global-attributes"></a> as well as the following attributes:
          </p>
          <ul>
            <li><a>columnspan</a></li>
            <li><a>rowspan</a></li>
          </ul>
          <p>
            The <dfn><code>columnspan</code></dfn> (respectively
            <dfn><code>rowspan</code></dfn>) attribute has the same
            syntax and semantic as the
            <a data-cite="HTML#attr-tdth-colspan"><code>&lt;colspan&gt;</code></a>
            (respectively
            <a data-cite="HTML#attr-tdth-rowspan"><code>&lt;rowspan&gt;</code></a>)
            attribute on the <code>&lt;td&gt;</code> element from [[HTML]].
          </p>
          <div class="note">
            The name for the column spanning attribute is
            <code>columnspan</code> as in [[MathML3]] and not
            <code>colspan</code> as in [[HTML]].
          </div>
        </section>
      </section>
      <section id="enlivening-expressions">
        <h3>Enlivening Expressions</h3>
        <p>
          Historically, the
          <dfn><code>&lt;maction&gt;</code></dfn>
          element provides a mechanism
          for binding actions to expressions.
        </p>
        <p>
          The <code>&lt;maction&gt;</code> element accepts the attributes described
          in <a href="#global-attributes"></a> as well as the following
          attributes:
        </p>
        <ul>
          <li><code>actiontype</code></li>
          <li><code>selection</code></li>
        </ul>
        <p>
          The <dfn>actiontype</dfn> and <dfn>selection</dfn> attributes are
          not taken into account in the present specification but may be used
          by authors to implement custom actions on the
          <code>&lt;maction&gt;</code> element.
        </p>
        <p>
          The layout algorithm of the <code>&lt;maction&gt;</code> element
          the same as the <code>&lt;mrow&gt;</code> element.
          The <a href="#user-agent-stylesheet">user agent stylesheet</a>
          must contain the following rules in order to hide all but
          its first child element,
          which is the default behavior for the legacy actiontype
          values:
        </p>
        <pre class="css" data-include="user-agent-stylesheet/maction.css"></pre>
        <div class="note">
		  <code>&lt;maction&gt;</code> is implemented for compatibility with full MathML. Authors whose only target is MathML Core are encouraged to use other HTML, CSS and JavaScript mechanisms.
        </div>
      </section>
      <section id="semantics-and-presentation">
        <h3>Semantics and Presentation</h3>
        <p>
          The
          <dfn><code>&lt;semantics&gt;</code></dfn>
          element is the container element that associates
          annotations with a MathML expression. Typically, the
          <code>&lt;semantics&gt;</code> element has as its first child element
          a MathML expression to be annotated while subsequent child elements
          represent
          text annotations within an <dfn><code>&lt;annotation&gt;</code></dfn>
          element, or more complex markup annotations within
          an <dfn><code>&lt;annotation-xml&gt;</code></dfn> element.
        </p>
        <p>
          The <code>&lt;semantics&gt;</code> element accepts the attributes
          described in <a href="#global-attributes"></a>. Its layout algorithm
          is the same as the <a><code>&lt;mrow&gt;</code></a> element.
          The <a href="#user-agent-stylesheet">user agent stylesheet</a>
          must contain the following rule in order to only render the annotated
          MathML expression:
        </p>
        <pre data-include="user-agent-stylesheet/semantics.css"></pre>
        <p>
          The <code>&lt;annotation-xml&gt;</code> and
          <code>&lt;annotation&gt;</code> element accepts the attributes
          described in <a href="#global-attributes"></a> as well as the
          following attribute:
        </p>
        <ul>
          <li><code>encoding</code></li>
        </ul>
        <p>
          The <dfn>encoding</dfn> attribute is not taken into account in the
          present specification but it is intended to distinguish annotations
          for <a data-cite="HTML#html-integration-point">HTML integration point</a>, clipboard copy, alternative rendering etc
        </p>
        <p>
          The layout algorithm of the <code>&lt;annotation-xml&gt;</code>
          and <code>&lt;annotation&gt;</code>
          element is the same as the <a><code>&lt;mtext&gt;</code></a> element.
        </p>
        <div class="note">
          CSS can be used to render alternative annotations e.g.
          <pre class="css">
            /* Hide the annotated child. */
            semantics > :first-child { display: none; }
             /* Show all text annotations. */
            semantics > annotation { display: inline; }
            /* Show all HTML annotations. */
            semantics > annotation-xml[encoding="text/html" i],
            semantics > annotation-xml[encoding="application/xhtml+xml" i] {
              display: inline-block;
            }
          </pre>
        </div>
      </section>
    </section>
    <section class="normative">
      <h2>CSS Extensions for Math Layout</h2>
      <section id="new-display-math-value">
        <h3>The <code>display: math</code> value</h3>
        <div class="issue" data-number="69">Should the computed value on the
          <a><code>&lt;math&gt;</code></a> depends on the <a>display</a>
          attribute value?
        </div>
        <div class="issue" data-number="56">Should we add more specific values?</div>
        <div class="issue">Use another name? <code>math-auto</code>? <code>mathml?</code>...</div>
        <p>The <dfn><code>display</code> property</dfn>
          from <a data-cite="CSS-DISPLAY-3"></a>
          is extended with a new <code>math</code> value:
        </p>
        <code><a data-cite="CSS-DISPLAY-3#valdef-display-table">&lt;display-old&gt;</a> <a data-cite="CSS-VALUES-3#comb-one">|</a> math</code>
        <p>
          For the <a><code>&lt;math&gt;</code></a>,
          <a><code>&lt;mtable&gt;</code></a>,
          <a><code>&lt;mtr&gt;</code></a> and
          <a><code>&lt;mtd&gt;</code></a> elements, the
          <code>math</code> value respectively computes to
          <code>inline</code>,
          <code>inline-table</code>,
          <code>table-row</code>
          and <code>table-cell</code>.
          <a>MathML Core elements</a> with <code>display: math</code>
          control box generation and layout according to their tag name, as
          described in the relevant sections while
          <a>Unknown MathML elements</a> with <code>display: math</code>
          behave the same as the <a><code>&lt;mrow&gt;</code></a> element.
          For non-MathML elements, the <code>math</code> value computes to
          <code>none</code>.
        </p>
        <div class="note">
          The <code>display: math</code> value provides a default
          layout for MathML elements while at the same time allowing authors
          to override it with either native display values or
          <a data-cite="CSS-LAYOUT-API-1#registering-layout">custom values</a>.
        </div>
      </section>
      <section id="new-text-transform-values">
        <h3>New <code>text-transform</code> values</h3>
        <p>The <dfn><code>text-transform</code></dfn> property
          from <a data-cite="CSS-TEXT-3"></a>
          is extended with new values:
        </p>
        <code><a data-cite="CSS-TEXT-3#text-transform-property">&lt;text-transform-old&gt;</a> <a data-cite="CSS-VALUES-3#comb-one">|</a> math-auto | math-bold | math-italic | math-bold-italic | math-double-struck | math-bold-fraktur | math-script | math-bold-script | math-fraktur | math-sans-serif | math-bold-sans-serif | math-sans-serif-italic | math-sans-serif-bold-italic | math-monospace | math-initial | math-tailed | math-looped | math-stretched</code>
        <p>
          On text nodes containing a unique character, <code>math-auto</code> has
          the same effect as <code>math-italic</code>, otherwise it has no effects.
        </p>
        <p>
          For the
          <code>math-bold</code>,
          <code>math-italic</code>,
          <code>math-bold-italic</code>,
          <code>math-double-struck</code>,
          <code>math-bold-fraktur</code>,
          <code>math-script</code>,
          <code>math-bold-script</code>,
          <code>math-fraktur</code>,
          <code>math-sans-serif</code>,
          <code>math-bold-sans-serif</code>,
          <code>math-sans-serif-italic</code>,
          <code>math-sans-serif-bold-italic</code>,
          <code>math-monospace</code>,
          <code>math-initial</code>,
          <code>math-tailed</code>,
          <code>math-looped</code> and
          <code>math-stretched</code>
          values, the transformed text is
          obtained by performing conversion of each character according to
          the corresponding
          <a href="#bold-mappings">bold</a>,
          <a href="#italic-mappings">italic</a>,
          <a href="#bold-italic-mappings">bold-italic</a>,
          <a href="#double-struck-mappings">double-struck</a>,
          <a href="#bold-fraktur-mappings">bold-fraktur</a>,
          <a href="#script-mappings">script</a>,
          <a href="#bold-script-mappings">bold-script</a>,
          <a href="#fraktur-mappings">fraktur</a>,
          <a href="#sans-serif-mappings">sans-serif</a>,
          <a href="#bold-sans-serif-mappings">bold-sans-serif</a>,
          <a href="#sans-serif-italic-mappings">sans-serif-italic</a>,
          <a href="#sans-serif-bold-italic-mappings">sans-serif-bold-italic</a>,
          <a href="#monospace-mappings">monospace</a>,
          <a href="#initial-mappings">initial</a>,
          <a href="#tailed-mappings">tailed</a>,
          <a href="#looped-mappings">looped</a>,
          <a href="#stretched-mappings">stretched</a> tables.
        </p>
        <p>
          User agents may decide to rely on italic, bold and bold-italic
          font-level properties when available fonts lack the proper glyphs to
          perform <code>math-auto</code>, <code>math-italic</code>,
          <code>math-bold</code>, <code>math-bold-italic</code> character-level
          transforms.
        </p>
      </section>
      <section id="the-math-style-property">
        <h3>The <code>math-style</code> property</h3>
        <table>
          <tbody>
            <tr>
              <th>Name:</th>
              <td>
                <dfn><code>math-style</code></dfn>
              </td>
            </tr>
            <tr><th>Value:</th><td><code>display | inline</code></td></tr>
            <tr><th>Initial:</th><td><code>inline</code></td></tr>
            <tr><th>Applies to:</th><td>All elements</td></tr>
            <tr><th>Inherited:</th><td>yes</td></tr>
            <tr><th>Percentages:</th><td>n/a</td></tr>
            <tr><th>Media:</th><td>visual</td></tr>
            <tr><th>Computed value:</th><td>specified keyword</td></tr>
            <tr><th>Canonical order:</th><td>n/a</td></tr>
            <tr><th>Animation type:</th><td>not animatable</td></tr>
          </tbody>
        </table>
        <p>
          If the value of <code>math-style</code> is <code>inline</code>, the math
          layout on descendants should try to minimize the
          <a data-cite="CSS-WRITING-MODES-3#extent">logical height</a>.
          This includes how
          <a><code>font-size</code></a>
          is changed when its specified value is
          <code>scriptlevel(auto)</code> as well
          miscelleanous layout rules described in details in
          <a href="#presentation-markup"></a>.
          If the value of <code>math-style</code> is <code>display</code>, the math
          layout should not take such constraints into consideration.
        </p>
      </section>
      <section id="the-math-superscript-shift-style">
        <h3>The <code>math-superscript-shift-style</code> property</h3>
        <table>
          <tbody>
            <tr>
              <th>Name:</th>
              <td>
                <dfn><code>math-superscript-shift-style</code></dfn>
              </td>
            </tr>
            <tr><th>Value:</th><td><code>display | inline</code></td></tr>
            <tr><th>Initial:</th><td><code>display</code></td></tr>
            <tr><th>Applies to:</th><td>All elements</td></tr>
            <tr><th>Inherited:</th><td>yes</td></tr>
            <tr><th>Percentages:</th><td>n/a</td></tr>
            <tr><th>Media:</th><td>visual</td></tr>
            <tr><th>Computed value:</th><td>specified keyword</td></tr>
            <tr><th>Canonical order:</th><td>n/a</td></tr>
            <tr><th>Animation type:</th><td>not animatable</td></tr>
          </tbody>
        </table>
        <p>
          If the value of <code>math-superscript-shift-style</code> is <code>inline</code>, the math layout on descendants will use the
          <a>superscriptShiftUpCramped</a> parameter to place superscript.
          If the value of <code>math-superscript-shift-style</code> is <code>display</code>, the math
          will use the <a>superscriptShiftUp</a> parameter instead.
        </p>
        <p>
          This property is used for positioning superscript during the layout
          of MathML <a>scripted elements</a>.
          See § <a href="#subscripts-and-superscripts-msub-msup-msubsup"></a>
          <a href="#prescripts-and-tensor-indices-mmultiscripts"></a> and
          <a href="#underscripts-and-overscripts-munder-mover-munderover"></a>.
        </p>
      </section>
      <section id="the-math-script-level-property">
        <h3>New value <code>scriptlevel()</code> function for font-size</h3>
        <p>The <dfn><code>font-size</code></dfn> property
          from <a data-cite="CSS-FONTS-4"></a>
          is extended with new values:
        </p>
        <code><a data-cite="CSS-FONTS-4#font-size-prop">&lt;font-size-old&gt;</a> <a data-cite="CSS-VALUES-3#comb-one">|</a> scriptlevel(auto) | scriptlevel(add(&lt;integer&gt;)) | scriptlevel(&lt;integer&gt;)</code>
        <p>Each element has an <dfn>internal scriptlevel</dfn> which is
          determined as folows:</p>
        <ul>
          <li>The <a>internal scriptlevel</a> is 0 on the root element.</li>
          <li>If the specified value of <a>font-size</a> is
            <code>scriptlevel(auto)</code> and
            the inherited value of <a>math-style</a>
            is <code>inline</code> then the <a>internal scriptlevel</a> of
            the element is the one of its parent plus one.
          </li>
          <li>If the specified value of <a>font-size</a> is of
            the form <code>scriptlevel(add(&lt;integer&gt;))</code> then the
            <a>internal scriptlevel</a> is the one of its parent plus
            the specified integer.
          </li>
          <li>If the specified value of <a>font-size</a> is of the form
            <code>scriptlevel(&lt;integer&gt;)</code> then the
            <a>internal scriptlevel</a> of the element is the specified
            integer.</li>
          <li>Otherwise, the <a>internal scriptlevel</a>
            of the element is the same as the one of its parent.</li>
        </ul>
        <p>
          If the specified value <a>font-size</a> is of the form
          <code>scriptlevel(...)</code> then the computed value of
          <a>font-size</a> is obtained by multiplying the inherited value of
          <code>font-size</code> by a nonzero scale factor calculated by the
          following procedure:
        </p>
        <ol>
          <li>Let A be the <a>internal scriptlevel</a> of the parent,
            B the <a>internal scriptlevel</a> of the element,
            C be 0.71 and S be 1.0</li>
          <li>
            <ul>
              <li>If A = B then return S.</li>
              <li>If B &lt; A, swap A and B and set <code>InvertScaleFactor</code> to true.</li>
              <li>Otherwise B &gt; A and set <code>InvertScaleFactor</code> to false.</li>
            </ul>
          </li>
          <li>Let E be B - A &gt; 0.</li>
          <li>If the inherited font has an OpenType MATH table:
            <ul>
              <li>If A ≤ 0 and B ≥ 2 then multiply S by <a>scriptScriptPercentScaleDown</a> and
                decrement E by 2.</li>
              <li>Otherwise if A = 1 then multiply S by
                <a>scriptScriptPercentScaleDown</a> / <a>scriptPercentScaleDown</a> and
                decrement E by 1.</li>
              <li>Otherwise if B = 1 then multiply S by <a>scriptPercentScaleDown</a>
                and decrement E by 1.</li>
            </ul>
          </li>
          <li>Multiply S by C<sup>E</sup></li>
          <li>Return S if <code>InvertScaleFactor</code> is false and 1/S otherwise.</li>
        </ol>
      </section>
    </section>
    <section class="normative" id="opentype-math-table">
      <h2>OpenType <code>MATH</code> table</h2>
      <p>
        This chapter describes features provided by <code>MATH</code> table
        of an OpenType font [[OPEN-FONT-FORMAT]]. Throughout this chapter,
        a C-like notation
        <code>Table.Subtable1[index].Subtable2.Parameter</code> is used to
        denote OpenType parameters.
        Such parameters may not be available (e.g. if the font lack one of the
        subtable, has an invalid offset, etc) and so fallback options are
        provided.
      </p>
      <div class="note">
        It is strongly encouraged to render MathML with a math font with
        the proper OpenType features. There is no guarantee that the fallback
        options provided will provide good enough rendering.
      </div>
      <p>
        OpenType values expressed in design units (perhaps indirectly via a
        <code>MathValueRecord</code> entry) are scaled to appropriate values
        for layout purpose, taking into account
        <code>head.unitsPerEm</code>, CSS
        <a><code>font-size</code></a>
        or zoom level.
      </p>
      <section>
        <h3>Layout constants (<code>MathConstants</code>)</h3>
        <div class="issue" data-number="69">Define fallback values</div>
        <p>These are global layout constants for a given mathematical font:</p>
        <dl>
          <dt><dfn>Default rule thickness</dfn></dt>
          <dd>
            ??
          </dd>
          <dt><dfn>scriptPercentScaleDown</dfn></dt>
          <dd>
            <code>MATH.MathConstants.scriptPercentScaleDown / 100</code> or
            0.71 if <code>MATH.MathConstants.scriptPercentScaleDown</code> is
            null or not available.
          </dd>
          <dt><dfn>scriptScriptPercentScaleDown</dfn></dt>
          <dd>
            <code>MATH.MathConstants.scriptScriptPercentScaleDown / 100</code> or
            0.5041 if
            <code>MATH.MathConstants.scriptScriptPercentScaleDown</code> is
            null or not available.
          </dd>
          <dt><dfn>displayOperatorMinHeight</dfn></dt>
          <dd><code>MATH.MathConstants.displayOperatorMinHeight</code> or ?? if the constant is not available.</dd>
          <dt><dfn>axisHeight</dfn></dt>
          <dd><code>MATH.MathConstants.axisHeight</code> or ?? if the constant is not available.</dd>
          <dt><dfn>accentBaseHeight</dfn></dt>
          <dd><code>MATH.MathConstants.accentBaseHeight</code> or <code>OS/2.sxHeight</code> if the constant is not available.</dd>
          <dt><dfn>subscriptShiftDown</dfn></dt>
          <dd><code>MATH.MathConstants.subscriptShiftDown</code> or <code>OS/2.ySubscriptYOffset</code> if the constant is not available.</dd>
          <dt><dfn>subscriptTopMax</dfn></dt>
          <dd><code>MATH.MathConstants.subscriptTopMax</code> or ⅘ × <code>OS/2.sxHeight</code> if the constant is not available.</dd>
          <dt><dfn>subscriptBaselineDropMin</dfn></dt>
          <dd><code>MATH.MathConstants.subscriptBaselineDropMin</code> or ?? if the constant is not available.</dd>
          <dt><dfn>superscriptShiftUp</dfn></dt>
          <dd><code>MATH.MathConstants.superscriptShiftUp</code> or <code>OS/2.ySuperscriptYOffset</code> if the constant is not available.</dd>
          <dt><dfn>superscriptShiftUpCramped</dfn></dt>
          <dd><code>MATH.MathConstants.superscriptShiftUpCramped</code> or ?? if the constant is not available.</dd>
          <dt><dfn>superscriptBottomMin</dfn></dt>
          <dd><code>MATH.MathConstants.superscriptBottomMin</code> or ¼ × <code>OS/2.sxHeight</code> if the constant is not available.</dd>
          <dt><dfn>superscriptBaselineDropMax</dfn></dt>
          <dd><code>MATH.MathConstants.superscriptBaselineDropMax</code> or ?? if the constant is not available.</dd>
          <dt><dfn>subSuperscriptGapMin</dfn></dt>
          <dd><code>MATH.MathConstants.subSuperscriptGapMin</code> or 4 × <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>superscriptBottomMaxWithSubscript</dfn></dt>
          <dd><code>MATH.MathConstants.superscriptBottomMaxWithSubscript</code> or ⅘ × <code>OS/2.sxHeight</code> if the constant is not available.</dd>
          <dt><dfn>spaceAfterScript</dfn></dt>
          <dd><code>MATH.MathConstants.spaceAfterScript</code> or 1/24em if the constant is not available.</dd>
          <dt><dfn>upperLimitGapMin</dfn></dt>
          <dd><code>MATH.MathConstants.upperLimitGapMin</code> or ?? if the constant is not available.</dd>
          <dt><dfn>upperLimitBaselineRiseMin</dfn></dt>
          <dd><code>MATH.MathConstants.upperLimitBaselineRiseMin</code> or ?? if the constant is not available.</dd>
          <dt><dfn>lowerLimitGapMin</dfn></dt>
          <dd><code>MATH.MathConstants.lowerLimitGapMin</code> or ?? if the constant is not available.</dd>
          <dt><dfn>lowerLimitBaselineDropMin</dfn></dt>
          <dd><code>MATH.MathConstants.lowerLimitBaselineDropMin</code> or ?? if the constant is not available.</dd>
          <dt><dfn>stackTopShiftUp</dfn></dt>
          <dd><code>MATH.MathConstants.stackTopShiftUp</code> or ?? if the constant is not available.</dd>
          <dt><dfn>stackTopDisplayStyleShiftUp</dfn></dt>
          <dd><code>MATH.MathConstants.stackTopDisplayStyleShiftUp</code> or ?? if the constant is not available.</dd>
          <dt><dfn>stackBottomShiftDown</dfn></dt>
          <dd><code>MATH.MathConstants.stackBottomShiftDown</code> or ?? if the constant is not available.</dd>
          <dt><dfn>stackBottomDisplayStyleShiftDown</dfn></dt>
          <dd><code>MATH.MathConstants.stackBottomDisplayStyleShiftDown</code> or ?? if the constant is not available.</dd>
          <dt><dfn>stackGapMin</dfn></dt>
          <dd><code>MATH.MathConstants.stackGapMin</code> or 3 × <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>stackDisplayStyleGapMin</dfn></dt>
          <dd><code>MATH.MathConstants.stackDisplayStyleGapMin</code> or 7 × <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>stretchStackTopShiftUp</dfn></dt>
          <dd><code>MATH.MathConstants.stretchStackTopShiftUp</code> or ?? if the constant is not available.</dd>
          <dt><dfn>stretchStackBottomShiftDown</dfn></dt>
          <dd><code>MATH.MathConstants.stretchStackBottomShiftDown</code> or ?? if the constant is not available.</dd>
          <dt><dfn>stretchStackGapAboveMin</dfn></dt>
          <dd><code>MATH.MathConstants.stretchStackGapAboveMin</code> or <a>upperLimitGapMin</a> if the constant is not available.</dd>
          <dt><dfn>stretchStackGapBelowMin</dfn></dt>
          <dd><code>MATH.MathConstants.stretchStackGapBelowMin</code> or <a>lowerLimitGapMin</a> if the constant is not available.</dd>
          <dt><dfn>fractionNumeratorShiftUp</dfn></dt>
          <dd><code>MATH.MathConstants.fractionNumeratorShiftUp</code> or ?? if the constant is not available.</dd>
          <dt><dfn>fractionNumeratorDisplayStyleShiftUp</dfn></dt>
          <dd><code>MATH.MathConstants.fractionNumeratorDisplayStyleShiftUp</code> or <a>stackTopDisplayStyleShiftUp</a> if the constant is not available.</dd>
          <dt><dfn>fractionDenominatorShiftDown</dfn></dt>
          <dd><code>MATH.MathConstants.fractionDenominatorShiftDown</code> or ?? if the constant is not available.</dd>
          <dt><dfn>fractionDenominatorDisplayStyleShiftDown</dfn></dt>
          <dd><code>MATH.MathConstants.fractionDenominatorDisplayStyleShiftDown</code> or <a>stackBottomDisplayStyleShiftDown</a> if the constant is not available.</dd>
          <dt><dfn>fractionNumeratorGapMin</dfn></dt>
          <dd><code>MATH.MathConstants.fractionNumeratorGapMin</code> or <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>fractionNumDisplayStyleGapMin</dfn></dt>
          <dd><code>MATH.MathConstants.fractionNumDisplayStyleGapMin</code> or 3 × <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>fractionRuleThickness</dfn></dt>
          <dd><code>MATH.MathConstants.fractionRuleThickness</code> or <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>fractionDenominatorGapMin</dfn></dt>
          <dd><code>MATH.MathConstants.fractionDenominatorGapMin</code> or <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>fractionDenomDisplayStyleGapMin</dfn></dt>
          <dd><code>MATH.MathConstants.fractionDenomDisplayStyleGapMin</code> or 3 × <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>overbarVerticalGap</dfn></dt>
          <dd><code>MATH.MathConstants.overbarVerticalGap</code> or 3 × <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>overbarRuleThickness</dfn></dt>
          <dd><code>MATH.MathConstants.overbarRuleThickness</code> or <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>overbarExtraAscender</dfn></dt>
          <dd><code>MATH.MathConstants.overbarExtraAscender</code> or <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>underbarVerticalGap</dfn></dt>
          <dd><code>MATH.MathConstants.underbarVerticalGap</code> or 3 × <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>underbarRuleThickness</dfn></dt>
          <dd><code>MATH.MathConstants.underbarRuleThickness</code> or <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>underbarExtraDescender</dfn></dt>
          <dd><code>MATH.MathConstants.underbarExtraDescender</code> or <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>radicalVerticalGap</dfn></dt>
          <dd><code>MATH.MathConstants.radicalVerticalGap</code> or 1¼ × <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>radicalDisplayStyleVerticalGap</dfn></dt>
          <dd><code>MATH.MathConstants.radicalDisplayStyleVerticalGap</code> or <a>default rule thickness</a> + ¼ <code>OS/2.sxHeight</code> if the constant is not available.</dd>
          <dt><dfn>radicalRuleThickness</dfn></dt>
          <dd><code>MATH.MathConstants.radicalRuleThickness</code> or <a>default rule thickness</a> if the constant is not available.</dd>
          <dt><dfn>radicalExtraAscender</dfn></dt>
          <dd><code>MATH.MathConstants.radicalExtraAscender</code> or <a>radicalRuleThickness</a> if the constant is not available.</dd>
          <dt><dfn>radicalKernBeforeDegree</dfn></dt>
          <dd><code>MATH.MathConstants.radicalKernBeforeDegree</code> or 5/18em if the constant is not available.</dd>
          <dt><dfn>radicalKernAfterDegree</dfn></dt>
          <dd><code>MATH.MathConstants.radicalKernAfterDegree</code> or −10/18em if the constant is not available.</dd>
          <dt><dfn>radicalDegreeBottomRaisePercent</dfn></dt>
          <dd><code>MATH.MathConstants.radicalDegreeBottomRaisePercent / 100.0</code> or 0.6 if the constant is not available.</dd>
        </dl>
      </section>
      <section>
        <h3>Glyph information (<code>MathGlyphInfo</code>)</h3>
        <div class="issue" data-number="22">Use MathKernInfo?</div>
        <p>
          These are per-glyph tables for a given mathematical font:
        </p>
        <dl>
          <dt><dfn>MathItalicsCorrectionInfo</dfn></dt>
          <dd>
            The subtable
            <code>MATH.MathGlyphInfo.MathItalicsCorrectionInfo</code>
            of italics correction values. Use the corresponding value in
            <code>MATH.MathGlyphInfo.MathItalicsCorrectionInfo.italicsCorrection</code>
            if there is one for the requested glyph or
            or <code>0</code> otherwise.
          </dd>
          <dt><dfn>MathTopAccentAttachment</dfn></dt>
          <dd>
            The subtable
            <code>MATH.MathGlyphInfo.MathTopAccentAttachment</code>
            of positioning top math accents along the <a>inline axis</a>.
            Use the corresponding value in
            <code>MATH.MathGlyphInfo.MathTopAccentAttachment.topAccentAttachment</code>
            if there is one for the requested glyph or
            or half the advance width of the glyph otherwise.
          </dd>
        </dl>
      </section>
      <section>
        <h3>Size variants for operators (<code>MathVariants</code>)</h3>
        <div class="issue" data-number="135">Variable fonts and stretchy operators</div>
        <p>
          This section describes how to handle stretchy glyphs of arbitrary
          size using the <code>MATH.MathVariants</code> table.
        </p>
        <section>
          <h4>The <code>GlyphAssembly</code> table</h4>
          <p>
            This section is based on [[?OPEN-TYPE-MATH-IN-HARFBUZZ]].
            For convenience, the following definitions are used:
          </p>
          <ul>
            <li>
              <dfn>o<sub>min</sub></dfn> is
              <code>MATH.MathVariant.minConnectorOverlap</code>.
            </li>
            <li>
              A <code>GlyphPartRecord</code> is an <em>extender</em>
              if and only if
              <code>GlyphPartRecord.partFlags</code> has the
              <code>fExtender</code> flag set.
            </li>
            <li>
              A <code>GlyphAssembly</code> is <em>horizontal</em>
              if it is obtained from
              <code>MathVariant.horizGlyphConstructionOffsets</code>.
              Otherwise it is <em>vertical</em> (and obtained from
              <code>MathVariant.vertGlyphConstructionOffsets</code>).
            <li>
              For a given <code>GlyphAssembly</code> table,
              <dfn>N<sub>Ext</sub></dfn> (respectively
              <dfn>N<sub>NonExt</sub></dfn>) is the number of extenders
              (respectively non-extenders) in
              <code>GlyphAssembly.partRecords</code>.
            </li>
            <li>
              For a given <code>GlyphAssembly</code> table,
              <dfn>S<sub>Ext</sub></dfn> (respectively
              <dfn>S<sub>NonExt</sub></dfn>) is the sum of
              <code>GlyphPartRecord.fullAdvance</code>
              for all extenders (respectively non-extenders) in
              <code>GlyphAssembly.partRecords</code>.
            </li>
            <li><dfn>S<sub>Ext,NonOverlapping</sub></dfn> = <a>S<sub>Ext</sub></a></a> − <a>o<sub>min</sub></a> <a>N<sub>Ext</sub></a>
              is the sum of maximum non overlapping parts of extenders.
            </li>
          </ul>
          <p>
            User agents must treat the <code>GlyphAssembly</code> as invalid
            if the following conditions are not satisfied:
          </p>
          <ul>
            <li><a>N<sub>Ext</sub></a> &gt; 0. Otherwise, the assembly cannot
              be grown by repeating extenders.</li>
            <li>
              <a>S<sub>Ext,NonOverlapping</sub></a> &gt; 0.
              Otherwise, the assembly does not grow when joining extenders.
            </li>
            <li>
              For each <code>GlyphPartRecord</code>
              in <code>GlyphAssembly.partRecords</code>,
              the values of
              <code>GlyphPartRecord.startConnectorLength</code> and
              <code>GlyphPartRecord.endConnectorLength</code>
              must be at least <a>o<sub>min</sub></a>.
              Otherwise, it is not possible to satisfy the condition of
              <code>MathVariant.minConnectorOverlap</code>.
            </li>
          </ul>
          <p>
            In this specification, a glyph assembly is built by repeating each
            extender r times and using the same overlap value o between each
            glyph. The number of glyphs in such an assembly is
            <dfn>AssemblyGlyphCount</dfn>(r) = <a>N<sub>NonExt</sub></a> + r <a>N<sub>Ext</sub></a> while
            the stretch size is
            <dfn>AssembySize</dfn>(o, r) =
            <a>S<sub>NonExt</sub></a> + r <a>S<sub>Ext</sub></a>
            − o (<a>AssemblyGlyphCount</a>(r) − 1).
          </p>
          <p>
            <dfn>r<sub>min</sub></dfn> is the minimal number of repetitions
            needed to obtain an assembly of
            size at least T i.e. the minimal r such that
            <a>AssembySize</a>(<a>o<sub>min</sub></a>, r)) ≥ T.
            It is defined as the maximum between 0 and the ceiling of
            ((T − <a>S<sub>NonExt</sub></a> + <a>o<sub>min</sub></a> (<a>N<sub>NonExt</sub></a> − 1)) / <a>S<sub>Ext,NonOverlapping</sub></a>).
          </p>
	  <p>
            <dfn>o<sub>max</sub></dfn> is the
            maximum overlap possible to build an assembly of size at least
            T by repeating each extender <a>r<sub>min</sub></a> times.

            If <a>AssemblyGlyphCount</a>(<a>r<sub>min</sub></a>) ≤ 1, then the actual overlap value is irrelevant.
            Otherwise, o<sub>max</sub> is defined to be the minimum of:
          </p>
          <ul>
            <li><dfn>o<sub>max,theorical</sub></dfn> = (<a>AssembySize</a>(0, <a>r<sub>min</sub></a>) − T) / (<a>AssemblyGlyphCount</a>(<a>r<sub>min</sub></a>) − 1)
              is the theorical overlap obtained by
              splitting evenly the extra size of an assembly built with
              null overlap.
            </li>
            <li>
              <code>GlyphPartRecord.startConnectorLength</code> for all
              the entries in
              <code>GlyphAssembly.partRecords</code>, excluding the
              last one if it is not an extender.
            </li>
            <li>
              <code>GlyphPartRecord.endConnectorLength</code> for all
              the entries in
              <code>GlyphAssembly.partRecords</code>, excluding the
              first one if it is not an extender.
            </li>
            </ul>
	  <p>
            The <dfn>glyph assembly stretch size</dfn>
            for a target size T is
            <a>AssembySize</a>(<a>o<sub>max</sub></a>, <a>r<sub>min</sub></a>).
          </p>
          <p>
            The
            <dfn>glyph assembly width</dfn>,
            <dfn>glyph assembly ascent</dfn>
            and <dfn>glyph assembly descent</dfn>
            are defined as follows:
          </p>
          <ul>
            <li>If <code>GlyphAssembly</code> is vertical,
              the width is the maximum advance width of the glyphs of id
              <code>GlyphPartRecord.glyphID</code> for all the
              <code>GlyphPartRecord</code> in
              <code>GlyphAssembly.partRecords</code>,
              the ascent is the
              <a>glyph assembly stretch size</a>
              for a given target size <code>T</code>
              and the descent is 0.
            </li>
            <li>Otherwise, the <code>GlyphAssembly</code> is horizontal,
              the width is <a>glyph assembly stretch size</a>
              for a given target size <code>T</code> while
              the ascent (respectively descent) is the
              the maximum ascent (respectively descent) of the glyphs of id
              <code>GlyphPartRecord.glyphID</code> for all the
              <code>GlyphPartRecord</code> in
              <code>GlyphAssembly.partRecords</code>.
            </li>
          </ul>
          <p>
            The <dfn>glyph assembly height</dfn> is the sum
            of the <a>glyph assembly ascent</a> and
            <a>glyph assembly descent</a>.
          </p>
          <div class="note">
            The horizontal (respectively vertical) metrics for a vertical
            (respectively horizontal) glyph assembly do not depend
            on the target size <code>T</code>.
          </div>
          <p>The <dfn>shaping of the glyph assembly</dfn>
            at position <code>P</code> is performed with the following
            algorithm:
          </p>
          <ol>
            <li>Calculate <a>r<sub>min</sub></a> and
              <a>o<sub>max</sub></a>.</li>
            <li>
              Set <code>(x, y)</code> to <code>P</code> if
              <code>RepetitionCounter</code> to 0 and
              <code>PartIndex</code> to -1.
            </li>
            <li>
              Repeat the following steps:
              <ol>
                <li>
                  If <code>RepetitionCounter</code> is 0, then
                  <ol>
                    <li>Increment <code>PartIndex</code>.</li>
                    <li>If <code>PartIndex</code> is
                      <code>GlyphAssembly.partCount</code>
                      then stop.</li>
                    <li>Otherwise, set
                      <code>Part</code> to
                      <code>GlyphAssembly.partRecords[PartIndex]</code>.
                      Set <code>RepetitionCounter</code> to
                      <a>r<sub>min</sub></a> if
                      <code>Part</code> is an extender and to 1 otherwise.
                    </li>
                  </ol>
                </li>
                <li>
                  <ul>
                    <li>If the glyph assembly is horizontal then
                      draw the glyph of id
                      <code>Part.glyphID</code>
                      so that its (left, baseline) coordinates
                      are at position <code>(x, y)</code>.
                      Set <code>x</code> to
                      <code>x + Part.fullAdvance −
                        <a>o<sub>max</sub></a></code>
                    </li>
                    <li>Otherwise (if the glyph assembly is vertical),
                      then
                      draw the glyph of id
                      <code>Part.glyphID</code>
                      so that its (left, bottom) coordinates
                      are at position <code>(x, y)</code>.
                      Set <code>y</code> to
                      <code>y − Part.fullAdvance +
                        <a>o<sub>max</sub></a></code>
                    </li>
                  </ul>
                </li>
                <li>Decrement <code>RepetitionCounter</code>.</li>
              </ol>
            </li>
          </ol>
        </section>
        <section>
          <h4>Algorithms for glyph stretching</h4>
          <p>
            The <dfn>preferred inline size of a glyph stretched along the block
            axis</dfn>
            is calculated using the following algorithm:
          </p>
          <ol>
            <li>
              Set <code>S</code> to the glyph's advance width.
            </li>
            <li>
              If there is a <code>MathGlyphConstruction</code> table
              in the <code>MathVariants.vertGlyphConstructionOffsets</code>
              table for the given glyph:
              <ol>
                <li>
                  For each <code>MathGlyphVariantRecord</code> in
                  <code>MathGlyphConstruction.mathGlyphVariantRecord</code>,
                  ensure that <code>S</code> is at least
                  the advance width of the glyph of id
                  <code>MathGlyphVariantRecord.variantGlyph</code>.
                </li>
                <li>
                  If there is valid <code>GlyphAssembly</code> subtable,
                  then ensure
                  that <code>S</code> is at least the
                  <a>glyph assembly width</a>.
                </li>
              </ol>
            </li>
            <li>Return <code>S</code>.</li>
          </ol>
          <div class="note">
            The <a>preferred inline size of a glyph stretched along the block
            axis</a> will return the maximum width of all possible
            vertical constructions for that glyph.
            In practice, math fonts are designed so that
            vertical constructions almost constant width so possible
            over-estimation of the actual width is small.
          </div>
          <p>
            The algorithm to calculate the
            <dfn>box metrics of a stretchy glyph</dfn>
            stretched to inline (respectively block) dimension
            <code>T</code> is the following:
          </p>
          <ol>
            <li>
              Set <code>B</code> to glyph's advanced width, ascent and
              descent.
              If the glyph's advance width
              (respectively height) is at least <code>T</code>
              then return <code>B</code>.
            </li>
            <li>
              If there is a <code>MathGlyphConstruction</code> table
              in the <code>MathVariants.horizGlyphConstructionOffsets</code>
              table  (respectively
              <code>MathVariants.vertGlyphConstructionOffsets</code> table)
              for the given glyph:
              <ol>
                <li>
                  For each <code>MathGlyphVariantRecord</code> in
                  <code>MathGlyphConstruction.mathGlyphVariantRecord</code>:
                  <ol>
                    <li>
                      Set <code>B</code>
                      to the advanced width, ascent and
                      descent of the glyph of id
                      <code>MathGlyphVariantRecord.variantGlyph</code>.
                    </li>
                    <li>
                      If
                      <code>MathGlyphVariantRecord.advanceMeasurement</code>
                      is at least <code>T</code> then return
                      <code>B</code>.
                    </li>
                  </ol>
                <li>
                  If there is valid <code>GlyphAssembly</code> subtable
                  then set <code>B</code> to the
                  <a>glyph assembly width</a>,
                  <a>glyph assembly ascent</a>
                  and <a>glyph assembly descent</a>
                  for the target size <code>T</code>.
                </li>
              </ol>
            </li>
            <li>Return <code>B</code>.</li>
          </ol>
          <div class="issue">Apply a rotation matrix
            in vertical writing mode?</div>
          <p>The algorithm to
            <dfn>shape a stretchy glyph</dfn> to inline
            (respectively block) dimension <code>T</code> at a position
            <code>P</code> is the following:
          </p>
          <ol>
            <li>
              If the glyph's advance width (respectively height)
              is at least <code>T</code>
              then draw the glyph so that its (left, baseline) coordinates
              are at position <code>P</code> and exit.
            </li>
            <li>
              If there is a <code>MathGlyphConstruction</code> table
              in the <code>MathVariants.horizGlyphConstructionOffsets</code>
              table (respectively
              <code>MathVariants.vertGlyphConstructionOffsets</code> table)
              for the given glyph:
              <ol>
                <li>
                  For each <code>MathGlyphVariantRecord</code> in
                  <code>MathGlyphConstruction.mathGlyphVariantRecord</code>,
                  if
                  <code>MathGlyphVariantRecord.advanceMeasurement</code>
                  is at least <code>T</code> then draw the glyph
                  so that its (left, baseline) coordinates
                  are at position <code>P</code> and exit.
                </li>
                <li>
                  If there is valid <code>GlyphAssembly</code> subtable
                  then perform
                  <a>shaping of the glyph assembly</a>
                  at position <code>P</code> and exit.
                </li>
              </ol>
            </li>
            <li>Otherwise, exit with a failure.</li>
          </ol>
        </section>
      </section>
    </section>
    <section class="appendix normative" id="user-agent-stylesheet">
      <h2>User Agent Stylesheet</h2>
      <div class="issue" data-number="34">text-indent, line-height, word-spacing, letter-spacing?</div>
      <div class="issue" data-number="35">CSS writing-mode and direction on the math root?</div>
      <div class="issue" data-number="36">font-style and font-weight on the math root?</div>
      <div class="issue" data-number="94">links and focusable elements?</div>
      <pre class="css">@namespace url(http://www.w3.org/1998/Math/MathML);

/* Default display */
<span data-include-replace="true" data-include="user-agent-stylesheet/display.css"></span>
/* Links */
<span data-include-replace="true" data-include="user-agent-stylesheet/links.css"></span>
/* The &lt;math&gt; element */
<span data-include-replace="true" data-include="user-agent-stylesheet/math.css"></span>
/* &lt;mrow&gt;-like elements */
<span data-include-replace="true" data-include="user-agent-stylesheet/semantics.css"></span><span data-include-replace="true" data-include="user-agent-stylesheet/maction.css"></span><span data-include-replace="true" data-include="user-agent-stylesheet/merror.css"></span><span data-include-replace="true" data-include="user-agent-stylesheet/mphantom.css"></span>
/* Token elements */
<span data-include-replace="true" data-include="user-agent-stylesheet/mi.css"></span>
/* Tables */
<span data-include-replace="true" data-include="user-agent-stylesheet/mtable.css"></span><span data-include-replace="true" data-include="user-agent-stylesheet/mtable-frame.css"></span><span data-include-replace="true" data-include="user-agent-stylesheet/mtr.css"></span><span data-include-replace="true" data-include="user-agent-stylesheet/mtd.css"></span>
/* Fractions */
<span data-include-replace="true" data-include="user-agent-stylesheet/mfrac.css"></span>
/* Other rules for scriptlevel, displaystyle and math-superscript-shift-style */
</span><span data-include-replace="true" data-include="user-agent-stylesheet/radicals.css"></span><span data-include-replace="true" data-include="user-agent-stylesheet/scripts.css"></span>
      </pre>
    </section>
    <section class="normative">
      <h2>Operator Tables</h2>
      <section id="operator-dictionary">
        <h3>Operator Dictionary</h3>
        <div class="issue" data-number="209">Remove fence/separator?</div>
        <div class="issue" data-number="176">TODO: more cleanup of the dictionary</div>
        <p>
          The following dictionary provides a human-readable table
          of values to use for
          <a href="#dictionary-based-attributes"></a> of operators
          when they are not specified via explicit attributes or equal to
          the generic default values. Please refer to
          <a href="#dictionary-based-attributes"></a> for explanation about
          how to use this dictionary and how to
          determine the values <code>Content</code> and <code>Form</code>
          indexing together
          the dictionary.
        </p>
        <div class="warning">
          This dictionary is quite large, with more than 1400 entries.
          However, is also has a lot of redundancy and so
          implementers are urged to rely on the tables from
          <a href="#operator-dictionary-compact"></a> instead.
        </div>
        <p>
          The values for <a>rspace</a> and <a>lspace</a> are indicated
          in the corresponding columns.
          The values of
          <a><code>stretchy</code></a>,
          <a><code>symmetric</code></a>,
          <a><code>largeop</code></a>,
          <a><code>movablelimits</code></a>,
          <a><code>fence</code></a> or
          <a><code>separator</code></a>
          are <code>true</code>
          if they are listed in the "properties" column.
        </p>
        <div id="operator-dictionary-entries"
             data-include="tables/operator-dictionary.html"></div>
      </section>
      <section id="operator-dictionary-compact">
        <h3>Operator Dictionary (Compact)</h3>
        <div class="issue" data-number="209">Remove fence/separator?</div>
        <p>
          The following dictionary provides a compact form for the
          <a href="#operator-dictionary">operator dictionary</a>, suitable for
          computer manipulation. It describes the values to use for
          <a href="#dictionary-based-attributes"></a> of operators
          when they are not specified via explicit attributes or equal to
          the generic default values. Please refer to
          <a href="#dictionary-based-attributes"></a> for explanation about
          how to use this dictionary and how to
          determine the values <code>Content</code> and
          <code>Form</code> indexing together
          the dictionary.
        </p>

        <p>
          This compact form removes about 800 entries from the
          <a href="#operator-dictionary">operator dictionary</a> that actually
          correspond to
          default values. They are not necessary since they are handled by the
          fallback case of
          <a href="#dictionary-based-attributes"></a> anyway. For other
          (<code>Content</code>, <code>Form</code>)
          key, the search is done as follows:
        </p>

        <ol>
          <li>
            Set properties <code>stretchy</code>, <code>symmetric</code>
            <code>largeop</code>, <code>movablelimits</code>,
 	    <code>fence</code>, <code>separator</code> to <code>false</code>.
          </li>
          <li>If <code>Content</code> is a single character in the
            BMP Private Use Area (range U+E000–U+F8FF)
            then exit with <code>NotFound</code> status.</li>
          <li>
            If <code>Content</code> an UTF-16 strings of lengths more than 1
            (including the case of surrogate pairs) and is listed in
            <a href="#operator-dictionary-compact-special-tables"><code>Operators_multichar</code></a> then
            replace <code>Content</code> with the Unicode character
            "U+E000 plus the index of <code>Content</code> in
            <code>Operators_multichar</code>". Otherwise, exit with
            <code>NotFound</code> status.
          </li>
          <li>If (<code>Content</code>, <code>Form</code>)
            corresponds to one category of
            <a href="#operator-dictionary-category-table"></a> then
            set the properties according to
            <a href="#operator-dictionary-categories-values"></a>.
            Otherwise, exit with <code>NotFound</code> status.
          </li>
          <li>If <code>Content</code> is in
            <a href="#operator-dictionary-compact-special-tables"><code>Operators_fence</code></a> then set property <code>fence</code> to true.</li>
          <li>If <code>Content</code> is in
            <a href="#operator-dictionary-compact-special-tables"><code>Operators_separator</code></a> then set property <code>separator</code> to true.</li>
          <li>Return the calculated
            (<code>lspace</code>, <code>rspace</code>,
            <code>stretchy</code>, <code>symmetric</code>
            <code>largeop</code>,
            <code>movablelimits</code>,
 	    <code>fence</code>, <code>separator</code>)
            value.
          </li>
        </ol>

        <div id="operator-dictionary-entries"
             data-include="tables/operator-dictionary-compact.html"></div>

        <div class="note" id="#operator-dictionary-compact-implementations">
          <p>
            After conversion to a single UTF-16 character, determining the
            category of ('Content', 'Form') can be done by binary searches
            on the tables corresponding to the 'Form' value
            of <a href="#operator-dictionary-category-table"></a>.
            For tables of ranges, the binary search can be performed on the
            range start code point. Note that small tables only have a few
            ranges or code points to check and so can be handled by direct
            comparaisons.
          </p>
          <p>
            The possible characters 'Content' values after conversion
            characters are located into the three small ranges
            U+0000–U+03FF, U+2000–U+2BFF and
            U+E000–U+E04F and after simple offset shift can be encoded on
            12 bits. Note that all Unicode ranges from
            and <a href="#operator-dictionary-category-table"></a>
            contain between 1 and 32 characters. By splitting ranges into
            at most two parts, each range can be encoded on 16 bits.
            Due to several contiguous Unicode blocks, the tables would still be
            encoded in significantly less than 16bits/entry but all the
            tables are now encoded and treated the same way.
          </p>
          <p>
            Alternatively, discarding the smallest tables as explained above,
            one can consider only those for categories 0-7.
            Then each of the three 'Form' corresponds to at most three
            categories and so ('Form', 'Category') can be encoded
            on 4 bits. Using the 12-bit encoding of the 'Content' described
            above this means that these tables can be encoded with
            16bits/entry but binary search would now be performed on a single
            table.
          </p>
          <p>
            Continuing on the previous approach, it is possible to
            use a perfect hash function to implement table lookup in constant
            time [[?gperf]] [[?CMPH]]. This would add 16 bits per empty entry
            (for non-minimal perfect hash function) as well as extra data to
            store the hash function parameters. For minimal perfect hash
            function, the theorical lower bound for storing these parameters is
            1.44bits/entry and existing algorithms range from close to that
            limit up to 4bits/entry.
          </p>
        </div>
      </section>
      <section id="stretchy-operator-axis">
        <h3>Stretchy Operator Axis</h3>
        <p>
          The default stretch axis for all characters is
          <em>block</em>. However, the
          stretch axis for the following characters is <em>inline</em>:
        </p>
        <code data-include="tables/inline-axis-operators.txt"></code>
        <div class="note">
          The stretch axis can be included as a boolean property of the
          <a href="#operator-dictionary">operator dictionary</a>. But since it
          does not depend on the form and since very few operators can stretch
          along the <a>inline axis</a>, it might be better implemented as a separate
          sorted array.
        </div>
      </section>
      <section>
        <h3>Combining Character Equivalences</h3>
        <p>
          The following table gives mappings between spacing and non spacing
          characters when used in MathML accent constructs.
        </p>
        <div data-include="tables/combining-operators.html"></div>
      </section>
    </section>
    <section>
      <h2>Unicode-based Glyph Assemblies</h2>
      <p>
        The following table provide fallback that user agents must use for
        stretching a given <em>base character</em> when the font does not
        provide a <code>MATH.MathVariants</code> table.
        The algorithms of
        <a href="#size-variants-for-operators-mathvariants"></a>
        works the same except with some adjustments:
      </p>
      <ul>
        <li>
          Entries are indexed by the base character.
        </li>
        <li>
          All the glyph IDs and metrics have to be deduced from unicode
          code points.
        </li>
        <li>
          If the <em>glyph construction</em> is horizontal then
          the entry corresponds to
          a <code>MathVariants.horizGlyphConstructionOffsets[]</code> item ;
          if it is vertical it corresponds to
          a <code>MathVariants.vertGlyphConstructionOffsets[]</code> item.
        </li>
        <li>
          The <code>MathGlyphConstruction.mathGlyphVariantRecord</code> is
          always empty.
        </li>
        <li>
          The
          <code>MathVariants.minConnectorOverlap</code>,
          <code>GlyphPartRecord.startConnectorLength</code> and
          <code>GlyphPartRecord.endConnectorLength</code>
          are treated as 0.
        </li>
        <li>
          The array of
          <code>MathGlyphConstruction.GlyphAssembly.partRecords</code> is built
          from each table row as follows:
          <ol>
            <li>A (non-extender) <em>bottom/left</em> character</li>
            <li>Followed by an <em>extender</em> character.</li>
            <li>Optionally followed by this:
              <ul>
                <li>Optionally, an (non-extender) <em>middle</em> character
                  and the same extender character previously mentioned.</li>
                <li>A (non-extender) <em>top/right</em> character.
              </ul>
            </li>
          </ol>
        </li>
      </ul>
      <div data-include="tables/unicode-assembly.html"></div>
    </section>
    <section>
      <h3>New <code>text-transform</code> Mappings</h3>
      <section id="bold-script-mappings">
        <h4><code>bold-script</code> mappings</h4>
        <div data-include="tables/mathvariants-bold-script.html"></div>
      </section>
      <section id="bold-italic-mappings">
        <h4><code>bold-italic</code> mappings</h4>
        <div data-include="tables/mathvariants-bold-italic.html"></div>
      </section>
      <section id="tailed-mappings">
        <h4><code>tailed</code> mappings</h4>
        <div data-include="tables/mathvariants-tailed.html"></div>
      </section>
      <section id="bold-mappings">
        <h4><code>bold</code> mappings</h4>
        <div data-include="tables/mathvariants-bold.html"></div>
      </section>
      <section id="fraktur-mappings">
        <h4><code>fraktur</code> mappings</h4>
        <div data-include="tables/mathvariants-fraktur.html"></div>
      </section>
      <section id="script-mappings">
        <h4><code>script</code> mappings</h4>
        <div data-include="tables/mathvariants-script.html"></div>
      </section>
      <section id="monospace-mappings">
        <h4><code>monospace</code> mappings</h4>
        <div data-include="tables/mathvariants-monospace.html"></div>
      </section>
      <section id="initial-mappings">
        <h4><code>initial</code> mappings</h4>
        <div data-include="tables/mathvariants-initial.html"></div>
      </section>
      <section id="sans-serif-mappings">
        <h4><code>sans-serif</code> mappings</h4>
        <div data-include="tables/mathvariants-sans-serif.html"></div>
      </section>
      <section id="double-struck-mappings">
        <h4><code>double-struck</code> mappings</h4>
        <div data-include="tables/mathvariants-double-struck.html"></div>
      </section>
      <section id="looped-mappings">
        <h4><code>looped</code> mappings</h4>
        <div data-include="tables/mathvariants-looped.html"></div>
      </section>
      <section id="stretched-mappings">
        <h4><code>stretched</code> mappings</h4>
        <div data-include="tables/mathvariants-stretched.html"></div>
      </section>
      <section id="italic-mappings">
        <h4><code>italic</code> mappings</h4>
        <div data-include="tables/mathvariants-italic.html"></div>
      </section>
      <section id="bold-fraktur-mappings">
        <h4><code>bold-fraktur</code> mappings</h4>
        <div data-include="tables/mathvariants-bold-fraktur.html"></div>
      </section>
      <section id="sans-serif-bold-italic-mappings">
        <h4><code>sans-serif-bold-italic</code> mappings</h4>
        <div data-include="tables/mathvariants-sans-serif-bold-italic.html"></div>
      </section>
      <section id="sans-serif-italic-mappings">
        <h4><code>sans-serif-italic</code> mappings</h4>
        <div data-include="tables/mathvariants-sans-serif-italic.html"></div>
      </section>
      <section id="bold-sans-serif-mappings">
        <h4><code>bold-sans-serif</code> mappings</h4>
        <div data-include="tables/mathvariants-bold-sans-serif.html"></div>
      </section>
    </section>
    <section class="appendix informative">
      <h2>Acknowledgments</h2>
      <p>MathML Core is based on MathML3. See the
        <a href="https://www.w3.org/TR/MathML3/appendixe.html">appendix E</a>
        of [[MathML3]] for the people that contributed to that specification.
      </p>
      <p>We would like to thank the people who, through their input and
        feedback on public communication channels have helped us with the
        creation of this specification:
        André Greiner-Petter,
        Anne van Kesteren,
        Boris Zbarsky,
        Brian Smith,
        Daniel Marques,
        David Carlisle,
        Deyan Ginev,
        Elika Etemad,
        Emilio Cobos Álvarez,
        ExE Boss,
        Ian Kilpatrick,
        Koji Ishii,
        L. David Baron,
        Michael Kohlhase,
        Michael Smith,
        Moritz Schubotz,
        Murray Sargent,
        Ryosuke Niwa,
        Sergey Malkin,
        Tab Atkins Jr.,
        Viktor Yaffle and
        frankvel.
      </p>
      <p>In addition, we would like to extend special thanks to
        Brian Kardell,
        Neil Soiffer and
        Rob Buis for help with the editing.</p>
      <p>Many thanks also to the following people for their help with the
        test suite:
        Brian Kardell,
        Frédéric Wang,
        Neil Soiffer and
        Rob Buis.
        Several tests are also based on MathML tests from browser
        repositories and we are grateful to the Mozilla and WebKit
        contributors.
      </p>
      <p>Community Group members who have regularly participated to MathML
        Core meetings during the development of this specification:
        Brian Kardell,
        Bruce Miller,
        David Carlisle,
        Murray Sargent,
        Frédéric Wang,
        Neil Soiffer (Chair),
        Patrick Ion,
        Rob Buis,
        David Farmer,
        Steve Noble,
        Daniel Marques,
        Sam Dooley.
      </p>
    </section>
    <section class="appendix informative">
      <h2>Privacy and Security Considerations</h2>
      <div class="issue" data-number="162">Privacy and Security Considerations</div>
      <p>
        As explained in <a href="#html-and-svg"></a>,
        MathML can be embedded into an SVG image via the
        <a data-cite="SVG#ForeignObjectElement"><code>&lt;foreignObject&gt;</code></a>
        element which can thus be used in a
        <a data-cite="HTML#the-canvas-element"><code>&lt;canvas&gt;</code></a>
        element.
        UA may decide to implement any measure to prevent potential
        <a data-cite="HTML#security-with-canvas-elements">information leakage</a>
        such as tainting the canvas and returning a
        <a data-cite="WEBIDL#securityerror"><code>"SecurityError"</code></a>
        <a data-cite="WEBIDL#DOMException"><code>DOMException</code></a>
        when one tries to access the canvas' content via JavaScript APIs.
      </p>
      <div class="issue" data-number="125">Should all MathML elements really be potential hyperlinks / match :visited?</div>
      <p>
        This specification adds an <a><code>href</code></a> attribute that
        can be used to make MathML elements match
        <a data-cite="SELECT#link"><code>:link</code> and
        <code>:visited</code> pseudo-classes</a> and one could rely on
        these features to determine whether a link has been visited.
        UAs may implement suggestions from [[SELECT]] to preserve the
        user's privacy.
      </p>
      <p>
        This specification only adds script execution mechanisms in the
        the MathML event handler attributes described in
        <a href="#global-attributes"></a> and
        in <code>javascript:...</code> links for the <a><code>href</code></a>
        attribute. UAs may decide to apply the same
        security restrictions as HTML and SVG to prevent execution of scripts
        in these attributes.
      </p>
      <p>
        This specification describes layout of a DOM
        <a data-cite="HTML#element">elements</a> which may involve system
        fonts. Like for HTML/CSS layout,
        it is thus possible to use JavaScript APIs
        to measure box sizes and positions and infer data from system fonts
        (e.g. default fonts, available glyphs, font layout
        parameters...). The only font informations that are not exposed by other
        existing Web APIs are the math layout data described in
        <a href="#opentype-math-table"></a>.
      </p>
      <div class="note">
        In MathML3, it was possible to use the
        <a><code>&lt;maction&gt;</code></a> element with
        the <code>actiontype</code> value set to <code>"statusline"</code>
        in order to override the text of the browser statusline. In particular,
        this could be used to hide the URL text of an untrusted
        <code>href</code> link. This has been removed in MathML Core
        and the <a><code>&lt;maction&gt;</code></a> element essentially behaves
        like an <a><code>&lt;mrow&gt;</code></a> container with extra style.
      </div>
    </section>
    <section id="conformance" class="appendix normative">
      <h2>Conformance</h2>
      <section>
        <h3>Document conventions</h3>
        <p>
          Conformance requirements are expressed with a combination of
          descriptive assertions and RFC 2119 terminology. The key words “MUST”,
          “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”,
          “RECOMMENDED”, “MAY”, and “OPTIONAL” in the normative parts of this
          document are to be interpreted as described in RFC 2119.
          However, for readability, these words do not appear in all uppercase
          letters in this specification.
        </p>
        <p>
          All of the text of this specification is normative except sections
          explicitly marked as non-normative, examples, and notes.
          [[RFC2119]].
        </p>
        <p>
          Examples in this specification are introduced with the words
          “for example” or are set apart from the normative text with
          <code>class="example"</code>, like this:
        </p>
        <div class="example">
          <p>
            This is an example of an informative example.
          </p>
        </div>
        <p>
          Informative notes begin with the word “Note” and are set apart from
          the normative text with <code>class="note"</code>, like this:
        </p>
        <p class="note">
          Note, this is an informative note.
        </p>
        <p>
          Advisements are normative sections styled to evoke special attention
          and are set apart from other normative text with
          <code>&lt;strong class="advisement"&gt;</code>, like this:
          <strong class="advisement">UAs MUST provide an accessible alternative. </strong>
        </p>
      </section>
    </section>
  </body>
</html>
